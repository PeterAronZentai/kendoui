function jsonify(n){return JSON.stringify(n,null,"\t")}var EventSubscriber;(function(){typeof window=="undefined"&&(window=this),$data=window.$data||(window.$data=function n(){if(this instanceof n){var t=n.implementation.apply(this,arguments);return new t(arguments[1])}return n.implementation.apply(this,arguments)})})(this),typeof console=="undefined"&&(console={warn:function(){},error:function(){},log:function(){},dir:function(){},time:function(){},timeEnd:function(){}}),console.warn||(console.warn=function(){}),console.error||(console.error=function(){}),function(n){n.__namespace=!0,n.version="JayData 1.2.5",n.versionNumber="1.2.5",n.root={}}($data),Guard={},Guard.requireValue=function(n,t){(typeof t=="undefined"||t===null)&&Guard.raise(n+" requires a value other than undefined or null")},Guard.requireType=function(n,t,i){var r=i instanceof Array?i:[i];return r.some(function(i){switch(typeof i){case"string":return typeof t===i;case"function":return t instanceof i;default:Guard.raise("Unknown type format : "+typeof i+" for: "+n)}})},Guard.raise=function(n){if(typeof intellisense=="undefined"){n instanceof Exception?console.error(n.name+":",n.message+"\n",n):console.error(n);throw n;}},Object.isNullOrUndefined=function(n){return n===undefined||n===null},function(){if(Object.getOwnPropertyNames||(Object.getOwnPropertyNames=function(n){var i=[],t;for(t in n)n.hasOwnProperty(t)&&i.push(t);return i}),Object.create||(Object.create=function(n){function t(){}return arguments.length>1&&Guard.raise(new Error("Object.create implementation only accepts the first parameter.")),t.prototype=n,new t}),!Object.keys){var t=Object.prototype.hasOwnProperty,i=!{toString:null}.propertyIsEnumerable("toString"),n=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],r=n.length;Object.keys=function(u){var e,o,f;(typeof u!="object"&&typeof u!="function"||u===null)&&Guard.raise(new TypeError("Object.keys called on non-object")),e=[];for(o in u)t.call(u,o)&&e.push(o);if(i)for(f=0;f<r;f++)t.call(u,n[f])&&e.push(n[f]);return e}}Object.defineProperty||(Object.defineProperty=function(n,t,i){n[t]=i.value||{}}),Object.defineProperties||(Object.defineProperties=function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i].value||{})}),Array.prototype.forEach||(Array.prototype.forEach=function(n,t){for(var i=0,r=this.length;i<r;i++)t?n.call(t,this[i],i,this):n(this[i],i,this)}),Array.prototype.filter||(Array.prototype.filter=function(n,t){for(var r=[],f,i=0,u=this.length;i<u;i++)f=t?n.call(t,this[i],i,this):n(this[i],i,this),f===!0&&r.push(this[i]);return r}),Array.prototype.map||(Array.prototype.map=function(n,t){for(var r=[],f,i=0,u=this.length;i<u;i++)f=t?n.call(t,this[i],i,this):n(this[i],i,this),r.push(f);return r}),Array.prototype.some||(Array.prototype.some=function(n,t){for(var u,i=0,r=this.length;i<r;i++)if(u=t?n.call(t,this[i],i,this):n(this[i],i,this),u)return!0;return!1}),Array.prototype.indexOf||(Array.prototype.indexOf=function(n){for(var t=0,i=this.length;t<i;t++)if(this[t]===n)return t;return-1}),String.prototype.trimLeft||(String.prototype.trimLeft=function(){return this.replace(/^\s+/,"")}),String.prototype.trimRight||(String.prototype.trimRight=function(){return this.replace(/\s+$/,"")})}(),JAYLINT=function(){"use strict";function wr(){return this}function te(){}function ie(n){return pe[n]||"\\u"+("0000"+n.charCodeAt().toString(16)).slice(-4)}function ei(n){Object.keys(n).forEach(function(t){ct[t]=n[t]})}function re(){r.safe||(r.rhino&&(ei(de),r.rhino=!1),r.devel&&(ei(ye),r.devel=!1),r.browser&&(ei(le),r.browser=!1),r.windows&&(ei(ro),r.windows=!1),r.node&&(ei(we),r.node=!1,fu=!0),r.widget&&(ei(io),r.widget=!1))}function rf(n,t,i){throw{name:"JSLintError",line:t,character:i,message:w.scanned_a_b.supplant({a:n,b:Math.floor(t/tr.length*100)})};}function t(t,i,u,f,e,o){var c,h,s;return i=i||n,h=i.line||0,c=i.from||0,s={id:"(error)",raw:w[t]||t,evidence:tr[h-1]||"",line:h,character:c,a:u||i.value,b:f,c:e,d:o},s.reason=s.raw.supplant(s),JAYLINT.errors.push(s),r.passfail&&rf(w.stopping,h,c),(nf+=1)>=r.maxerr&&rf(w.too_many,h,c),s}function o(n,i,r,u,f,e,o){return t(n,{line:i,from:r},u,f,e,o)}function e(n,i,r,u,f,e){var o=t(n,i,r,u,f,e);rf(w.stopping,o.line,o.character)}function st(n,t,i,r,u,f,o){return e(n,{line:t,from:i},r,u,f,o)}function wi(i){r.white||n.from===i||t("expected_a_at_b_c",n,n.value,i,n.from)}function dt(n,i,r){return n[i]!==r?(t("expected_a_b",n,r,n[i]),!0):!1}function ir(n,i,u){u=u||n.value,f===bt?(r.safe&&t("adsafe_a",n,u),typeof bt[u]!="string"&&(n.writeable=typeof ct[u]=="boolean"?ct[u]:!0,n.funct=f,lr[u]=n),i==="becoming"&&(i="var")):typeof f[u]=="string"?f[u]==="undef"?(r.undef||t("used_before_a",n,u),i="var"):t("already_defined",n,u):(n.funct=f,n.writeable=!0,a[u]=n),f[u]=i}function oi(n){var t,i=0;for(n=n||0;i<=n;)t=yr[i],t||(t=yr[i]=vr.token()),i+=1;return t}function s(n){if(n=n||u,n.comments){for(var t=n.prev;t.comments===null;)t=t.prev;t.comments=t.comments?t.comments.concat(n.comments):n.comments}n.comments=null}function i(i,f){if(c){if(fi&&n.line!==u.line){if((fi!==c||!n.edge)&&n.from===c.at-(n.edge?r.indent:0)){for(var e=c;;){if(e.at-=r.indent,e===fi)break;e=e.was}e.open=!1}fi=null}c.open?n.edge?n.edge==="label"?wi(1):n.edge==="case"?wi(c.at-r.indent):(c.mode!=="array"||n.line!==u.line)&&wi(c.at):n.line!==u.line&&(n.from<c.at+(c.mode==="expression"?0:r.indent)&&wi(c.at+r.indent),c.wrap=!0):n.line!==u.line&&(n.edge?wi(c.at):(c.wrap=!0,c.mode==="statement"||c.mode==="var"?wi(c.at+r.indent):n.from<c.at+(c.mode==="expression"?0:r.indent)&&wi(c.at+r.indent)))}switch(u.id){case"(number)":n.id==="."&&t("trailing_decimal_a");break;case"-":(n.id==="-"||n.id==="--")&&t("confusing_a");break;case"+":(n.id==="+"||n.id==="++")&&t("confusing_a")}(u.id==="(string)"||u.identifier)&&(vu=u.value),i&&n.id!==i&&(f?t("expected_a_b_from_c_d",n,i,f.id,f.line,n.value):n.identifier&&n.value===i||t("expected_a_b",n,i,n.value)),pt=u,u=n,n=yr.shift()||vr.token(),u.id==="(end)"&&s()}function uf(){r.adsafe&&(r.safe=!0),r.safe&&(r.browser=r["continue"]=r.css=r.debug=r.devel=r.evil=r.forin=r.newcap=r.nomen=r.on=r.rhino=r.sloppy=r.sub=r.undef=r.widget=r.windows=!1,delete ct.Array,delete ct.Date,delete ct.Function,delete ct.Object,delete ct.eval,ei({ADSAFE:!1,lib:!1}))}function yo(){for(var t,r;;){if(n.id!=="(string)"&&!n.identifier)return;if(t=n.value,i(),r=!1,n.id===":"){i(":");switch(n.id){case"true":r=ct[t]!==!1,i("true");break;case"false":i("false");break;default:e("unexpected_a")}}if(ct[t]=r,n.id!==",")return;i(",")}}function po(){for(var u,t;n.id==="(string)"||n.identifier;){u=n.value,i(),n.id!==":"&&e("expected_a_b",n,":",n.value),i(":");switch(u){case"indent":t=+n.value,(typeof t!="number"||!isFinite(t)||t<0||Math.floor(t)!==t)&&e("expected_small_a"),r.indent=t;break;case"maxerr":t=+n.value,(typeof t!="number"||!isFinite(t)||t<=0||Math.floor(t)!==t)&&e("expected_small_a",n),r.maxerr=t;break;case"maxlen":t=+n.value,(typeof t!="number"||!isFinite(t)||t<0||Math.floor(t)!==t)&&e("expected_small_a"),r.maxlen=t;break;default:n.id==="true"?r[u]=!0:n.id==="false"?r[u]=!1:e("unexpected_a"),u==="adsafe"?(r.adsafe=r.safe=!0,uf()):u==="safe"&&uf()}i(),n.id===","&&i(",")}re()}function wo(){for(ui||(ui={});;){if(n.id!=="(string)"&&!n.identifier)return;if(ui[n.value]=!0,i(),n.id!==",")return;i(",")}}function bi(){var f=this.id,o=hr;n.line===u.line&&n.from===u.thru&&t("missing_space_a_b",n,u.value,n.value),hr=!0,r.white=!0,(yr.length>0||n.comments)&&t("unexpected_a",this);switch(f){case"/*properties":case"/*property":case"/*members":case"/*member":wo();break;case"/*jslint":r.safe&&t("adsafe_a",this),po();break;case"/*globals":case"/*global":r.safe&&t("adsafe_a",this),yo();break;default:e("unpexpected_a",this)}hr=o,i("*/")}function b(t){n.edge=!c||c.open&&(t||!0)}function ut(t){var f,i;typeof t=="number"?c={at:t,open:!0,was:i}:c?(i=c,f=t==="var"||n.line!==u.line&&t!=="statement",c={at:(f||t==="control"?i.at+r.indent:i.at)+(i.wrap?r.indent:0),mode:t,open:f,was:i},t==="var"&&f&&(fi=c)):c={at:1,mode:"statement",open:!0}}function ft(n,t){n&&(c&&c.open&&(c.at-=r.indent,b()),i(n,t)),c&&(c=c.was)}function p(i,f){i=i||u,f=f||n,f.id==="(end)"||r.white||u.line===f.line&&u.thru+1===f.from||t("expected_space_a_b",f,u.value,f.value)}function rr(i,f){i=i||u,f=f||n,f.id==="(end)"||i.line===f.line&&(r.white||i.thru+1===f.from)||t("expected_space_a_b",f,i.value,f.value)}function y(i,f){i=i||u,f=f||n,r.white&&h!=="styleproperty"&&h!=="style"||i.thru===f.from||i.line!==f.line||t("unexpected_space_a_b",f,i.value,f.value)}function nt(i,f){i=i||u,f=f||n,f.id==="(end)"||i.line===f.line&&(r.white||i.thru===f.from)||t("unexpected_space_a_b",f,i.value,f.value)}function g(i,f){r.white||(i=i||u,f=f||n,i.thru===f.from&&i.line===f.line&&t("missing_space_a_b",f,i.value,f.value))}function tt(){n.id!==","?o("expected_a_b",u.line,u.thru,",",n.value):(r.white||nt(),i(","),s(),g())}function wt(){n.id!==";"?o("expected_a_b",u.line,u.thru,";",n.value):(r.white||nt(),i(";"),s(),ge[n.id]!==!0&&g())}function eu(){return n.value==="use strict"?(pi&&t("unnecessary_use"),b(),i(),wt(),pi=!0,r.newcap=!1,r.undef=!1,!0):!1}function vt(n,t){if(n===t)return!0;if(Array.isArray(n)){if(Array.isArray(t)&&n.length===t.length){for(var i=0;i<n.length;i+=1)if(!vt(n[i],t[i]))return!1;return!0}return!1}if(Array.isArray(t))return!1;if(n.arity===t.arity&&n.value===t.value)switch(n.arity){case"prefix":case"suffix":case undefined:return n.id===t.id&&vt(n.first,t.first);case"infix":return vt(n.first,t.first)&&vt(n.second,t.second);case"ternary":return vt(n.first,t.first)&&vt(n.second,t.second)&&vt(n.third,t.third);case"function":case"regexp":return!1;default:return!0}else{if(n.id==="."&&t.id==="["&&t.arity==="infix")return n.second.value===t.second.value&&t.second.id==="(string)";if(n.id==="["&&n.arity==="infix"&&t.id===".")return n.second.value===t.second.value&&n.second.id==="(string)"}return!1}function l(o,s){var h;if(n.id==="(end)"&&e("unexpected_a",u,n.id),i(),r.safe&&a[u.value]&&a[u.value]===lr[u.value]&&n.id!=="("&&n.id!=="."&&t("adsafe",u),s&&(vu="anonymous",f["(verb)"]=u.value),s===!0&&u.fud)h=u.fud();else{if(u.nud)h=u.nud();else{if(n.id==="(number)"&&u.id===".")return t("leading_decimal_a",u,n.value),i(),u;e("expected_identifier_a",u,u.id)}while(o<n.lbp)i(),u.led?h=u.led(h):e("expected_operator_a",u,u.id)}return h}function br(n,t){var i=kt[n];return i&&typeof i=="object"||(kt[n]=i={id:n,lbp:t,value:n}),i}function et(n){return br(n,0)}function ki(n){return n.postscript=!0,n}function ff(n){var t=br(n,0);return t.from=1,t.thru=1,t.line=0,t.edge=!0,t.value=n,ki(t)}function lt(n,t){var i=et(n);return i.identifier=i.reserved=!0,i.fud=t,i}function ou(n,t){var i=lt(n,t);i.labeled=!0}function su(n,t){var i=lt(n,t);i.disrupt=!0}function ue(n){var t=n.id.charAt(0);return(t>="a"&&t<="z"||t>="A"&&t<="Z")&&(n.identifier=n.reserved=!0),n}function ht(n,i,u){var f=br(n,150);return ue(f),f.nud=typeof i=="function"?i:function(){return n==="typeof"?p():nt(),this.first=l(150),this.arity="prefix",(this.id==="++"||this.id==="--")&&(r.plusplus?(!this.first.identifier||this.first.reserved)&&this.first.id!=="."&&this.first.id!=="["&&t("bad_operand",this):t("unexpected_a",this)),this.type=u,this},f}function si(n,t,i){var r=et(n);return r.arity=r.type=t,i&&(r.nud=i),r}function ef(n){var t=n.identifier&&a[n.value]||n;return t&&t.type}function it(n,i,u){var o="",f,e,s,h;return typeof n=="string"?f=n:(s=n.identifier&&a[n.value]||n,f=s.type),h=i.identifier&&a[i.value]||i,e=h.type,f?e?f===e?o=f:r.type||t("type_inconsistency_a_b",u||i,f,e):h.type=o=f:e&&(s&&(s.type=e),o=e),o}function k(n,t){var i=et(n);return i.identifier=i.reserved=!0,typeof t=="function"&&(i.nud=t),i}function ur(n,t,i){var r=k(n);return r.type=t,r.value=i,r.nud=wr,r}function of(n,t){return k(n,function(){return typeof t=="function"&&t(this),this})}function ot(n,i,f,e,o){var s=br(n,i);return ue(s),s.led=function(n){return this.arity="infix",o||(g(pt,u),g()),!r.bitwise&&this.bitwise&&t("unexpected_a",this),typeof f=="function"?f(n,this):(this.first=n,this.second=l(i),this)},e&&(s.type=e),s}function ti(n,i){return n.assign&&t(i||w.conditional_assignment,n),n}function ii(n,i){switch(n.id){case"[":case"-":n.arity!=="infix"&&t(i||w.weird_condition,n);break;case"false":case"function":case"Infinity":case"NaN":case"null":case"true":case"undefined":case"void":case"(number)":case"(regexp)":case"(string)":case"{":t(i||w.weird_condition,n);break;case"(":n.first.id==="."&&be[n.first.second.value]===!0&&t(i||w.weird_condition,n)}return n}function fe(n){switch(n.arity){case"prefix":switch(n.id){case"{":case"[":t("unexpected_a",n);break;case"!":t("confusing_a",n)}break;case"function":case"regexp":t("unexpected_a",n);break;default:n.id==="NaN"&&t("isnan",n)}return n}function ai(n,i){return ot(n,100,function(n,u){fe(n),i&&!r.eqeq&&t("expected_a_b",u,i,u.id);var f=l(100);return(vt(n,f)||(n.id==="(string)"||n.id==="(number)")&&(f.id==="(string)"||f.id==="(number)"))&&t("weird_relation",u),u.first=n,u.second=fe(f),it(n,u.second,u),u},"boolean")}function gt(n,i){var o=ot(n,20,function(n,i){var o;if(i.first=n,n.identifier)a[n.value]?a[n.value].writeable===!1&&t("read_only",n):e("read_only");else if(r.safe){o=n;do typeof ct[o.value]=="boolean"&&t("adsafe",o),o=o.first;while(o)}return n===kt["function"]&&t("identifier_function",u),n.id==="."||n.id==="["?(n.first&&n.first.value!=="arguments"||t("bad_assignment",i),i.second=l(19),i.id==="="&&vt(i.first,i.second)&&t("weird_assignment",i)):n.identifier&&!n.reserved&&(f[n.value]==="exception"&&t("assign_exception",n),i.second=l(19),i.id==="="&&vt(i.first,i.second)&&t("weird_assignment",i),i.type?(it(n,i),it(i,i.second,i)):it(n,i.second,i)),i});return o.assign=!0,i&&(kt[i].type&&(o.type=kt[i].type),kt[i].bitwise&&(o.bitwise=!0)),o}function fr(n,t){var i=ot(n,t,"number");return i.bitwise=!0,i}function ee(n){var i=br(n,150);return i.led=function(n){return nt(pt,u),r.plusplus?(!n.identifier||n.reserved)&&n.id!=="."&&n.id!=="["&&t("bad_operand",this):t("unexpected_a",this),this.first=n,this.arity="suffix",this},i}function sf(){if(n.identifier)return i(),r.safe&&nu[u.value]?t("adsafe_a",u):u.reserved&&!r.es5&&t("expected_identifier_a_reserved",u),u.value}function kr(){return sf()}function hf(){var o,h=a,r;if(n.id===";"){t("unexpected_a"),wt();return}return n.identifier&&!n.reserved&&oi().id===":"&&(b("label"),o=n,i(),s(),i(":"),s(),a=Object.create(h),ir(o,"label"),n.labeled!==!0?t("label_a_b",n,o.value,n.value):tf.test(o.value+":")?t("url",o):f===bt&&e("unexpected_a",u),n.label=o),b(),ut("statement"),(r=l(0,!0))&&(r.arity==="statement"?r.id==="switch"||r.block&&r.id!=="do"?g():wt():(r.id==="("?r.first.id==="new"&&t("bad_new"):r.assign||r.id==="delete"||r.id==="++"||r.id==="--"||t("assignment_function_expression",u),wt())),ft(),a=h,r}function di(){for(var r=[],u,i;n.postscript!==!0;)n.id===";"?(t("unexpected_a",n),wt()):(n.value==="use strict"&&((!fu||f!==bt||r.length>0)&&t("function_strict"),eu()),u&&(t("unreachable_a_b",n,n.value,u.value),u=null),i=hf(),i&&(r.push(i),i.disrupt&&(u=i,r.disrupt=!0)));return r}function ri(u){var o,c=n,l=ar,v=a,h=pi;return ar=u,a=Object.create(a),g(),n.id==="{"?(i("{"),ut(),u||eu()||h||r.sloppy||f["(context)"]!==bt||t("missing_use_strict"),o=di(),pi=h,ft("}",c),s()):u?(t("expected_a_b",n,"{",n.value),o=[hf()],o.disrupt=o[0].disrupt):e("expected_a_b",n,"{",n.value),f["(verb)"]=null,a=v,ar=l,u&&o.length===0&&t("empty_block"),o}function hu(n){ui&&typeof ui[n]!="boolean"&&t("unexpected_property_a",u,n),typeof vi[n]=="number"?vi[n]+=1:vi[n]=1}function cf(){var u=sf(!0);return u||(n.id==="(string)"?(u=n.value,r.safe&&(nu[u]?t("adsafe_a"):(u.charAt(0)==="_"||u.charAt(u.length-1)==="_")&&t("dangling_a")),i()):n.id==="(number)"&&(u=n.value.toString(),i())),u}function bo(){var e,t=n,f=[];if(i("("),ut(),s(),y(),n.id===")"){y(),ft(")",t),s();return}for(;;)if(b(),e=kr(),f.push(u),ir(u,r.unparam?"parameter":"unparam"),n.id===",")tt();else return y(),ft(")",t),s(),f}function d(n){var t=0;if(n)if(Array.isArray(n))n.forEach(function(n){t+=d(n)});else switch(n.arity){case"statement":switch(n.id){case"if":t+=d(n.first)+d(n.block)+d(n["else"])+1;break;case"while":case"do":n.first.id!=="true"&&n.first.value!==1&&(t+=1),t+=d(n.first)+d(n.block);break;case"for":n.second!==undefined&&n.second.id!=="true"&&n.second.value!==1&&(t+=1),t+=d(n.first)+d(n.second)+d(n.third)+d(n.block);break;case"switch":t+=d(n.first)+d(n.second)+n.second.length,n.second[n.second.length-1].id==="default"&&(t-=1);break;case"try":n.second&&(t+=1),n.third&&(t+=1),t+=d(n.first)+d(n.second)+d(n.third)+d(n.block)}break;case"prefix":t+=d(n.first);break;case"case":case"infix":t+=d(n.first)+d(n.second),(n.id==="&&"||n.id==="||")&&(t+=1);break;case"ternary":t+=d(n.first)+d(n.second)+d(n.third)}return t}function cu(t,i){var e=f,o=r,u=ui,s=a;f={"(name)":i||"'"+(vu||"").replace(gf,ie)+"'","(line)":n.line,"(context)":e,"(breakage)":0,"(loopage)":0,"(scope)":a,"(token)":t},ui=u&&Object.create(u),r=Object.create(o),a=Object.create(s),ru.push(f),t.name=i,i&&ir(t,"function",i),t.writeable=!1,t.first=f["(params)"]=bo(),t.type="function",p(),t.block=ri(!1),f["(complexity)"]=d(t.block)+1,f=e,r=o,ui=u,a=s}function lf(){function r(){var f=n,r={};if(i("{"),n.id!=="}")while(n.id!=="(end)"){while(n.id===",")t("unexpected_a",n),tt();if(n.id!=="(string)"&&t("expected_string_a"),r[n.value]===!0?t("duplicate_a"):n.value==="__proto__"?t("dangling_a"):r[n.value]=!0,i(),i(":"),lf(),n.id!==",")break;if(tt(),n.id==="}"){t("unexpected_a",u);break}}i("}",f)}function f(){var r=n;if(i("["),n.id!=="]")while(n.id!=="(end)"){while(n.id===",")t("unexpected_a",n),tt();if(lf(),n.id!==",")break;if(tt(),n.id==="]"){t("unexpected_a",u);break}}i("]",r)}switch(n.id){case"{":r();break;case"[":f();break;case"true":case"false":case"null":case"(number)":case"(string)":i();break;case"-":i("-"),nt(),i("(number)");break;default:e("unexpected_a")}}function af(){if(n.identifier)return i(),!0}function lu(){return n.id==="-"&&(i("-"),nt()),n.id==="(number)"?(i("(number)"),!0):void 0}function vf(){if(n.id==="(string)")return i(),!0}function hi(){var f,r,o,e;if(n.identifier){if(e=n.value,e==="rgb"||e==="rgba"){for(i(),o=n,i("("),f=0;f<3;f+=1)f&&tt(),r=n.value,n.id!=="(string)"||r<0?(t("expected_positive_a",n),i()):(i(),n.id==="%"?(i("%"),r>100&&t("expected_percent_a",u,r)):r>255&&t("expected_small_a",u,r));return e==="rgba"&&(tt(),r=+n.value,(n.id!=="(string)"||r<0||r>1)&&t("expected_fraction_a",n),i(),n.id==="%"&&(t("unexpected_a"),i("%"))),i(")",o),!0}if(ae[n.value]===!0)return i(),!0}else if(n.id==="(color)")return i(),!0;return!1}function v(){return(n.id==="-"&&(i("-"),nt()),n.id==="(number)")?(i(),n.id!=="(string)"&&wf[n.value]===!0?(nt(),i()):+u.value!=0&&t("expected_linear_a"),!0):!1}function ko(){return(n.id==="-"&&(i("-"),nt()),n.id==="(number)")?(i(),n.id!=="(string)"&&wf[n.value]===!0&&(nt(),i()),!0):!1}function er(){if(n.identifier)switch(n.value){case"thin":case"medium":case"thick":return i(),!0}else return v()}function dr(){if(n.identifier){if(n.value==="auto")return i(),!0}else return v()}function go(){return n.identifier&&n.value==="attr"?(i(),i("("),n.identifier||t("expected_name_a"),i(),i(")"),!0):!1}function ns(){while(n.id!==";"){if(af()||vf()||t("expected_name_a"),n.id!==",")return!0;tt()}}function ts(){return n.identifier&&n.value==="counter"?(i(),i("("),i(),n.id===","&&(tt(),n.id!=="(string)"&&t("expected_string_a"),i()),i(")"),!0):n.identifier&&n.value==="counters"?(i(),i("("),n.identifier||t("expected_name_a"),i(),n.id===","&&(tt(),n.id!=="(string)"&&t("expected_string_a"),i()),n.id===","&&(tt(),n.id!=="(string)"&&t("expected_string_a"),i()),i(")"),!0):!1}function is(){var r;if(n.identifier&&n.value==="rect"){for(i(),i("("),r=0;r<4;r+=1)if(!v()){t("expected_number_a");break}return i(")"),!0}return!1}function gi(){var f,u;return n.identifier&&n.value==="url"?(n=vr.range("(",")"),u=n.value,((f=u.charAt(0))==='"'||f==="'")&&(u.slice(-1)!==f?t("bad_url"):(u=u.slice(1,-1),u.indexOf(f)>=0&&t("bad_url"))),u||t("missing_url"),r.safe&&ne.test(u)&&e("adsafe_a",n,u),pr.push(u),i(),!0):!1}function rs(){for(var u;n.id==="*"||n.id==="#"||n.value==="_";)r.css||t("unexpected_a"),i();return n.id==="-"?(r.css||t("unexpected_a"),i("-"),n.identifier||t("expected_nonstandard_style_attribute"),i(),pu):(n.identifier?Object.prototype.hasOwnProperty.call(tu,n.value)?u=tu[n.value]:(u=pu,r.css||t("unrecognized_style_attribute_a")):t("expected_style_attribute"),i(),u)}function yf(t){var r=0,e,o,f,s,h=0,u;switch(typeof t){case"function":return t();case"string":return n.identifier&&n.value===t?(i(),!0):!1}for(;;){if(r>=t.length)return!1;if(u=t[r],r+=1,typeof u=="boolean")break;else typeof u=="number"?(e=u,u=t[r],r+=1):e=1;for(f=!1;e>0;)if(yf(u))f=!0,e-=1;else break;if(f)return!0}for(h=r,o=[];;){for(s=!1,r=h;r<t.length;r+=1)if(!o[r]&&yf(tu[t[r]])){f=!0,s=!0,o[r]=!0;break}if(!s)return f}}function us(){if(n.id==="(number)"){i(),n.value==="n"&&n.identifier&&(nt(),i(),n.id==="+"&&(nt(),i("+"),nt(),i("(number)")));return}if(n.identifier&&(n.value==="odd"||n.value==="even")){i();return}t("unexpected_a")}function oe(){for(var r;;){if(n.id==="}"||n.id==="(end)"||at&&n.id===at)return;while(n.id===";")t("unexpected_a"),wt();r=rs(),i(":"),n.identifier&&n.value==="inherit"?i():yf(r)||(t("unexpected_a"),i()),n.id==="!"&&(i("!"),nt(),n.identifier&&n.value==="important"?i():t("expected_a_b",n,"important",n.value)),n.id==="}"||n.id===at?t("expected_a_b",n,";",n.value):wt()}}function pf(){if(n.identifier)Object.prototype.hasOwnProperty.call(bu,r.cap?n.value.toLowerCase():n.value)||t("expected_tagname_a"),i();else switch(n.id){case">":case"+":i(),pf();break;case":":i(":");switch(n.value){case"active":case"after":case"before":case"checked":case"disabled":case"empty":case"enabled":case"first-child":case"first-letter":case"first-line":case"first-of-type":case"focus":case"hover":case"last-child":case"last-of-type":case"link":case"only-of-type":case"root":case"target":case"visited":i();break;case"lang":i(),i("("),n.identifier||t("expected_lang_a"),i(")");break;case"nth-child":case"nth-last-child":case"nth-last-of-type":case"nth-of-type":i(),i("("),us(),i(")");break;case"not":i(),i("("),n.id===":"&&oi(0).value==="not"&&t("not"),pf(),i(")");break;default:t("expected_pseudo_a")}break;case"#":i("#"),n.identifier||t("expected_id_a"),i();break;case"*":i("*");break;case".":i("."),n.identifier||t("expected_class_a"),i();break;case"[":i("["),n.identifier||t("expected_attribute_a"),i(),(n.id==="="||n.value==="~="||n.value==="$="||n.value==="|="||n.id==="*="||n.id==="^=")&&(i(),n.id!=="(string)"&&t("expected_string_a"),i()),i("]");break;default:e("expected_selector_a")}}function fs(){for(n.id==="{"&&t("expected_style_pattern");;){if(pf(),n.id==="<\/"||n.id==="{"||n.id==="(end)")return"";n.id===","&&tt()}}function se(){while(n.id!=="<\/"&&n.id!=="(end)")fs(),h="styleproperty",n.id===";"?wt():(i("{"),oe(),h="style",i("}"))}function he(){for(var r;n.id==="@";)if(r=oi(),i("@"),n.identifier)switch(n.value){case"import":i(),gi()||(t("expected_a_b",n,"url",n.value),i()),wt();break;case"media":for(i();;){if(n.identifier&&bf[n.value]!==!0||e("expected_media_a"),i(),n.id!==",")break;tt()}i("{"),se(),i("}");break;default:t("expected_at_a")}else t("expected_at_a");se()}function es(n){n==="html"||r.fragment||(n==="div"&&r.adsafe?e("adsafe_fragment"):e("expected_a_b",u,"html",n)),r.adsafe&&(n==="html"&&e("adsafe_html",u),r.fragment?n!=="div"&&e("adsafe_div",u):e("adsafe_fragment",u)),r.browser=!0}function os(i,f){var s,o;i==="id"?(s=typeof f=="string"?f.toUpperCase():"",uu[s]===!0&&t("duplicate_a",n,f),/^[A-Za-z][A-Za-z0-9._:\-]*$/.test(f)?r.adsafe&&(yt?f.slice(0,yt.length)!==yt?t("adsafe_prefix_a",n,yt):/^[A-Z]+_[A-Z]+$/.test(f)||t("adsafe_bad_id"):(yt=f,/^[A-Z]+_$/.test(f)||t("adsafe_bad_id"))):t("bad_id_a",n,f),o=f.search(so),o>=0&&t("unexpected_char_a_b",u,f.charAt(o),i),uu[s]=!0):i==="class"||i==="type"||i==="name"?(o=f.search(lo),o>=0&&t("unexpected_char_a_b",u,f.charAt(o),i),uu[s]=!0):i==="href"||i==="background"||i==="content"||i==="data"||i.indexOf("src")>=0||i.indexOf("url")>=0?(r.safe&&ne.test(f)&&e("bad_url",n,f),pr.push(f)):i==="for"?r.adsafe&&(yt?f.slice(0,yt.length)!==yt?t("adsafe_prefix_a",n,yt):/^[A-Z]+_[A-Z]+$/.test(f)||t("adsafe_bad_id"):t("adsafe_bad_id")):i==="name"&&r.adsafe&&f.indexOf("_")>=0&&t("adsafe_name_a",n,f)}function ss(f,o){var l,v=bu[f],s,a;if(du=!1,v||e(w.unrecognized_tag_a,n,f===f.toLowerCase()?f:f+" (capitalization error)"),rt.length>0)if(f==="html"&&e("unexpected_a",u,f),a=v.parent,a)a.indexOf(" "+rt[rt.length-1].name+" ")<0&&e("tag_a_in_b",u,f,a);else if(!r.adsafe&&!r.fragment){l=rt.length;do l<=0&&e("tag_a_in_b",u,f,"body"),l-=1;while(rt[l].name!=="body")}switch(f){case"div":r.adsafe&&rt.length===1&&!yt&&t("adsafe_missing_id");break;case"script":if(h="script",i(">"),o.lang&&t("lang",u),r.adsafe&&rt.length!==1&&t("adsafe_placement",u),o.src)!r.adsafe||or&&gr[o.src]||t("adsafe_source",u),o.type&&t("type",u);else{if(ut(n.from),b(),eu(),sr=!0,s=di(),r.adsafe){ci&&e("adsafe_script",u),(s.length!==1||dt(s[0],"id","(")||dt(s[0].first,"id",".")||dt(s[0].first.first,"value","ADSAFE")||dt(s[0].second[0],"value",yt))&&e("adsafe_id_go");switch(s[0].first.second.value){case"id":(or||ci||s[0].second.length!==1)&&e("adsafe_id",n),or=!0;break;case"go":ci&&e("adsafe_go"),(s[0].second.length!==2||dt(s[0].second[1],"id","function")||!s[0].second[1].first||s[0].second[1].first.length!==2||dt(s[0].second[1].first[0],"value","dom")||dt(s[0].second[1].first[1],"value","lib"))&&e("adsafe_go",n),ci=!0;break;default:e("adsafe_id_go")}}c=null}h="html",i("<\/"),n.identifier||n.value==="script"||t("expected_a_b",n,"script",n.value),i(),h="outer";break;case"style":h="style",i(">"),he(),h="html",i("<\/"),n.identifier||n.value==="style"||t("expected_a_b",n,"style",n.value),i(),h="outer";break;case"input":switch(o.type){case"radio":case"checkbox":case"button":case"reset":case"submit":break;case"text":case"file":case"password":case"file":case"hidden":case"image":r.adsafe&&o.autocomplete!=="off"&&t("adsafe_autocomplete");break;default:t("bad_type")}break;case"applet":case"body":case"embed":case"frame":case"frameset":case"head":case"iframe":case"noembed":case"noframes":case"object":case"param":r.adsafe&&t("adsafe_tag",n,f)}}function au(n){return"<\/"+n+">"}function hs(){var s,a,v,f,p=r.white,o,c,l,y;for(h="html",at="",rt=null;;){switch(n.value){case"<":for(h="html",i("<"),a={},c=n,c.identifier||t("bad_name_a",c),f=c.value,r.cap&&(f=f.toLowerCase()),c.name=f,i(),rt||(rt=[],es(f)),l=bu[f],typeof l!="object"&&e("unrecognized_tag_a",c,f),v=l.empty,c.type=f;;){if(n.id==="/"){i("/"),n.id!==">"&&t("expected_a_b",n,">",n.value);break}if(n.id&&n.id.charAt(0)===">")break;n.identifier||((n.id==="(end)"||n.id==="(error)")&&t("expected_a_b",n,">",n.value),t("bad_name_a")),r.white=!1,g(),s=n.value,r.white=p,i(),r.cap||s===s.toLowerCase()||t("attribute_case_a",u),s=s.toLowerCase(),at="",Object.prototype.hasOwnProperty.call(a,s)&&t("duplicate_a",u,s),s.slice(0,2)==="on"?(r.on||t("html_handlers"),h="scriptstring",i("="),o=n.id,o!=='"'&&o!=="'"&&e("expected_a_b",n,'"',n.value),at=o,y=r.white,r.white=!0,i(o),eu(),di(),r.white=y,n.id!==o&&e("expected_a_b",n,o,n.value),h="html",at="",i(o),l=!1):s==="style"?(h="scriptstring",i("="),o=n.id,o!=='"'&&o!=="'"&&e("expected_a_b",n,'"',n.value),h="styleproperty",at=o,i(o),oe(),h="html",at="",i(o),l=!1):n.id==="="?(i("="),l=n.value,n.identifier||n.id==='"'||n.id==="'"||n.id==="(string)"||n.id==="(string)"||n.id==="(color)"||t("expected_attribute_value_a",u,s),i()):l=!0,a[s]=l,os(s,l)}ss(f,a),v||rt.push(c),h="outer",i(">");break;case"<\/":h="html",i("<\/"),n.identifier||t("bad_name_a"),f=n.value,r.cap&&(f=f.toLowerCase()),i(),rt||e("unexpected_a",n,au(f)),c=rt.pop(),c||e("unexpected_a",n,au(f)),c.name!==f&&e("expected_a_b",n,au(c.name),au(f)),n.id!==">"&&e("expected_a_b",n,">",n.value),h="outer",i(">");break;case"<!":for(r.safe&&t("adsafe_a"),h="html";;){if(i(),n.id===">"||n.id==="(end)")break;n.value.indexOf("--")>=0&&e("unexpected_a",n,"--"),n.value.indexOf("<")>=0&&e("unexpected_a",n,"<"),n.value.indexOf(">")>=0&&e("unexpected_a",n,">")}h="outer",i(">");break;case"(end)":return;default:n.id==="(end)"?e("missing_a",n,"<\/"+rt[rt.length-1].value+">"):i()}if(rt&&rt.length===0&&(r.adsafe||!r.fragment||n.id==="(end)"))break}n.id!=="(end)"&&e("unexpected_a")}var yt,or,sr,ci,vu,gr,ce={"<":!0,"<=":!0,"==":!0,"===":!0,"!==":!0,"!=":!0,">":!0,">=":!0,"+":!0,"-":!0,"*":!0,"/":!0,"%":!0},nu={arguments:!0,callee:!0,caller:!0,constructor:!0,eval:!0,prototype:!0,stack:!0,unwatch:!0,valueOf:!0,watch:!0},yu,le={clearInterval:!1,clearTimeout:!1,document:!1,event:!1,frames:!1,history:!1,Image:!1,localStorage:!1,location:!1,name:!1,navigator:!1,Option:!1,parent:!1,screen:!1,sessionStorage:!1,setInterval:!1,setTimeout:!1,Storage:!1,window:!1,XMLHttpRequest:!1},w={a_label:"'{a}' is a statement label.",a_not_allowed:"'{a}' is not allowed.",a_not_defined:"'{a}' is not defined.",a_scope:"'{a}' used out of scope.",adsafe:"ADsafe violation.",adsafe_a:"ADsafe violation: '{a}'.",adsafe_autocomplete:"ADsafe autocomplete violation.",adsafe_bad_id:"ADSAFE violation: bad id.",adsafe_div:"ADsafe violation: Wrap the widget in a div.",adsafe_fragment:"ADSAFE: Use the fragment option.",adsafe_go:"ADsafe violation: Misformed ADSAFE.go.",adsafe_html:"Currently, ADsafe does not operate on whole HTML documents. It operates on <div> fragments and .js files.",adsafe_id:"ADsafe violation: id does not match.",adsafe_id_go:"ADsafe violation: Missing ADSAFE.id or ADSAFE.go.",adsafe_lib:"ADsafe lib violation.",adsafe_lib_second:"ADsafe: The second argument to lib must be a function.",adsafe_missing_id:"ADSAFE violation: missing ID_.",adsafe_name_a:"ADsafe name violation: '{a}'.",adsafe_placement:"ADsafe script placement violation.",adsafe_prefix_a:"ADsafe violation: An id must have a '{a}' prefix",adsafe_script:"ADsafe script violation.",adsafe_source:"ADsafe unapproved script source.",adsafe_subscript_a:"ADsafe subscript '{a}'.",adsafe_tag:"ADsafe violation: Disallowed tag '{a}'.",already_defined:"'{a}' is already defined.",and:"The '&&' subexpression should be wrapped in parens.",assign_exception:"Do not assign to the exception parameter.",assignment_function_expression:"Expected an assignment or function call and instead saw an expression.",attribute_case_a:"Attribute '{a}' not all lower case.",avoid_a:"Avoid '{a}'.",bad_assignment:"Bad assignment.",bad_color_a:"Bad hex color '{a}'.",bad_constructor:"Bad constructor.",bad_entity:"Bad entity.",bad_html:"Bad HTML string",bad_id_a:"Bad id: '{a}'.",bad_in_a:"Bad for in variable '{a}'.",bad_invocation:"Bad invocation.",bad_name_a:"Bad name: '{a}'.",bad_new:"Do not use 'new' for side effects.",bad_number:"Bad number '{a}'.",bad_operand:"Bad operand.",bad_type:"Bad type.",bad_url:"Bad url string.",bad_wrap:"Do not wrap function literals in parens unless they are to be immediately invoked.",combine_var:"Combine this with the previous 'var' statement.",conditional_assignment:"Expected a conditional expression and instead saw an assignment.",confusing_a:"Confusing use of '{a}'.",confusing_regexp:"Confusing regular expression.",constructor_name_a:"A constructor name '{a}' should start with an uppercase letter.",control_a:"Unexpected control character '{a}'.",css:"A css file should begin with @charset 'UTF-8';",dangling_a:"Unexpected dangling '_' in '{a}'.",dangerous_comment:"Dangerous comment.",deleted:"Only properties should be deleted.",duplicate_a:"Duplicate '{a}'.",empty_block:"Empty block.",empty_case:"Empty case.",empty_class:"Empty class.",es5:"This is an ES5 feature.",evil:"eval is evil.",expected_a:"Expected '{a}'.",expected_a_b:"Expected '{a}' and instead saw '{b}'.",expected_a_b_from_c_d:"Expected '{a}' to match '{b}' from line {c} and instead saw '{d}'.",expected_at_a:"Expected an at-rule, and instead saw @{a}.",expected_a_at_b_c:"Expected '{a}' at column {b}, not column {c}.",expected_attribute_a:"Expected an attribute, and instead saw [{a}].",expected_attribute_value_a:"Expected an attribute value and instead saw '{a}'.",expected_class_a:"Expected a class, and instead saw .{a}.",expected_fraction_a:"Expected a number between 0 and 1 and instead saw '{a}'",expected_id_a:"Expected an id, and instead saw #{a}.",expected_identifier_a:"Expected an identifier and instead saw '{a}'.",expected_identifier_a_reserved:"Expected an identifier and instead saw '{a}' (a reserved word).",expected_linear_a:"Expected a linear unit and instead saw '{a}'.",expected_lang_a:"Expected a lang code, and instead saw :{a}.",expected_media_a:"Expected a CSS media type, and instead saw '{a}'.",expected_name_a:"Expected a name and instead saw '{a}'.",expected_nonstandard_style_attribute:"Expected a non-standard style attribute and instead saw '{a}'.",expected_number_a:"Expected a number and instead saw '{a}'.",expected_operator_a:"Expected an operator and instead saw '{a}'.",expected_percent_a:"Expected a percentage and instead saw '{a}'",expected_positive_a:"Expected a positive number and instead saw '{a}'",expected_pseudo_a:"Expected a pseudo, and instead saw :{a}.",expected_selector_a:"Expected a CSS selector, and instead saw {a}.",expected_small_a:"Expected a small number and instead saw '{a}'",expected_space_a_b:"Expected exactly one space between '{a}' and '{b}'.",expected_string_a:"Expected a string and instead saw {a}.",expected_style_attribute:"Excepted a style attribute, and instead saw '{a}'.",expected_style_pattern:"Expected a style pattern, and instead saw '{a}'.",expected_tagname_a:"Expected a tagName, and instead saw {a}.",for_if:"The body of a for in should be wrapped in an if statement to filter unwanted properties from the prototype.",function_block:"Function statements should not be placed in blocks. Use a function expression or move the statement to the top of the outer function.",function_eval:"The Function constructor is eval.",function_loop:"Don't make functions within a loop.",function_statement:"Function statements are not invocable. Wrap the whole function invocation in parens.",function_strict:"Use the function form of 'use strict'.",html_confusion_a:"HTML confusion in regular expression '<{a}'.",html_handlers:"Avoid HTML event handlers.",identifier_function:"Expected an identifier in an assignment and instead saw a function invocation.",implied_evil:"Implied eval is evil. Pass a function instead of a string.",infix_in:"Unexpected 'in'. Compare with undefined, or use the hasOwnProperty method instead.",insecure_a:"Insecure '{a}'.",isNaN:"Use the isNaN function to compare with NaN.",label_a_b:"Label '{a}' on '{b}' statement.",lang:"lang is deprecated.",leading_decimal_a:"A leading decimal point can be confused with a dot: '.{a}'.",missing_a:"Missing '{a}'.",missing_a_after_b:"Missing '{a}' after '{b}'.",missing_option:"Missing option value.",missing_property:"Missing property name.",missing_space_a_b:"Missing space between '{a}' and '{b}'.",missing_url:"Missing url.",missing_use_strict:"Missing 'use strict' statement.",mixed:"Mixed spaces and tabs.",move_invocation:"Move the invocation into the parens that contain the function.",move_var:"Move 'var' declarations to the top of the function.",name_function:"Missing name in function statement.",nested_comment:"Nested comment.",not:"Nested not.",not_a_constructor:"Do not use {a} as a constructor.",not_a_defined:"'{a}' has not been fully defined yet.",not_a_function:"'{a}' is not a function.",not_a_label:"'{a}' is not a label.",not_a_scope:"'{a}' is out of scope.",not_greater:"'{a}' should not be greater than '{b}'.",parameter_a_get_b:"Unexpected parameter '{a}' in get {b} function.",parameter_set_a:"Expected parameter (value) in set {a} function.",radix:"Missing radix parameter.",read_only:"Read only.",redefinition_a:"Redefinition of '{a}'.",reserved_a:"Reserved name '{a}'.",scanned_a_b:"{a} ({b}% scanned).",slash_equal:"A regular expression literal can be confused with '/='.",statement_block:"Expected to see a statement and instead saw a block.",stopping:"Stopping. ",strange_loop:"Strange loop.",strict:"Strict violation.",subscript:"['{a}'] is better written in dot notation.",tag_a_in_b:"A '<{a}>' must be within '<{b}>'.",too_long:"Line too long.",too_many:"Too many errors.",trailing_decimal_a:"A trailing decimal point can be confused with a dot: '.{a}'.",type:"type is unnecessary.",type_inconsistency_a_b:"Type inconsistency: {a} and {b}.",unclosed:"Unclosed string.",unclosed_comment:"Unclosed comment.",unclosed_regexp:"Unclosed regular expression.",unescaped_a:"Unescaped '{a}'.",unexpected_a:"Unexpected '{a}'.",unexpected_char_a_b:"Unexpected character '{a}' in {b}.",unexpected_comment:"Unexpected comment.",unexpected_property_a:"Unexpected /*property*/ '{a}'.",unexpected_space_a_b:"Unexpected space between '{a}' and '{b}'.",unnecessary_initialize:"It is not necessary to initialize '{a}' to 'undefined'.",unnecessary_use:"Unnecessary 'use strict'.",unreachable_a_b:"Unreachable '{a}' after '{b}'.",unrecognized_style_attribute_a:"Unrecognized style attribute '{a}'.",unrecognized_tag_a:"Unrecognized tag '<{a}>'.",unsafe:"Unsafe character.",url:"JavaScript URL.",use_array:"Use the array literal notation [].",use_braces:"Spaces are hard to count. Use {{a}}.",use_charAt:"Use the charAt method.",use_object:"Use the object literal notation {}.",use_or:"Use the || operator.",use_param:"Use a named parameter.",used_before_a:"'{a}' was used before it was defined.",var_a_not:"Variable {a} was not declared correctly.",weird_assignment:"Weird assignment.",weird_condition:"Weird condition.",weird_new:"Weird construction. Delete 'new'.",weird_program:"Weird program.",weird_relation:"Weird relation.",weird_ternary:"Weird ternary.",wrap_immediate:"Wrap an immediate function invocation in parentheses to assist the reader in understanding that the expression is the result of a function, and not the function itself.",wrap_regexp:"Wrap the /regexp/ literal in parens to disambiguate the slash operator.",write_is_wrong:"document.write can be a form of eval."},hr,tu,pu,ae={aliceblue:!0,antiquewhite:!0,aqua:!0,aquamarine:!0,azure:!0,beige:!0,bisque:!0,black:!0,blanchedalmond:!0,blue:!0,blueviolet:!0,brown:!0,burlywood:!0,cadetblue:!0,chartreuse:!0,chocolate:!0,coral:!0,cornflowerblue:!0,cornsilk:!0,crimson:!0,cyan:!0,darkblue:!0,darkcyan:!0,darkgoldenrod:!0,darkgray:!0,darkgreen:!0,darkkhaki:!0,darkmagenta:!0,darkolivegreen:!0,darkorange:!0,darkorchid:!0,darkred:!0,darksalmon:!0,darkseagreen:!0,darkslateblue:!0,darkslategray:!0,darkturquoise:!0,darkviolet:!0,deeppink:!0,deepskyblue:!0,dimgray:!0,dodgerblue:!0,firebrick:!0,floralwhite:!0,forestgreen:!0,fuchsia:!0,gainsboro:!0,ghostwhite:!0,gold:!0,goldenrod:!0,gray:!0,green:!0,greenyellow:!0,honeydew:!0,hotpink:!0,indianred:!0,indigo:!0,ivory:!0,khaki:!0,lavender:!0,lavenderblush:!0,lawngreen:!0,lemonchiffon:!0,lightblue:!0,lightcoral:!0,lightcyan:!0,lightgoldenrodyellow:!0,lightgreen:!0,lightpink:!0,lightsalmon:!0,lightseagreen:!0,lightskyblue:!0,lightslategray:!0,lightsteelblue:!0,lightyellow:!0,lime:!0,limegreen:!0,linen:!0,magenta:!0,maroon:!0,mediumaquamarine:!0,mediumblue:!0,mediumorchid:!0,mediumpurple:!0,mediumseagreen:!0,mediumslateblue:!0,mediumspringgreen:!0,mediumturquoise:!0,mediumvioletred:!0,midnightblue:!0,mintcream:!0,mistyrose:!0,moccasin:!0,navajowhite:!0,navy:!0,oldlace:!0,olive:!0,olivedrab:!0,orange:!0,orangered:!0,orchid:!0,palegoldenrod:!0,palegreen:!0,paleturquoise:!0,palevioletred:!0,papayawhip:!0,peachpuff:!0,peru:!0,pink:!0,plum:!0,powderblue:!0,purple:!0,red:!0,rosybrown:!0,royalblue:!0,saddlebrown:!0,salmon:!0,sandybrown:!0,seagreen:!0,seashell:!0,sienna:!0,silver:!0,skyblue:!0,slateblue:!0,slategray:!0,snow:!0,springgreen:!0,steelblue:!0,tan:!0,teal:!0,thistle:!0,tomato:!0,turquoise:!0,violet:!0,wheat:!0,white:!0,whitesmoke:!0,yellow:!0,yellowgreen:!0,activeborder:!0,activecaption:!0,appworkspace:!0,background:!0,buttonface:!0,buttonhighlight:!0,buttonshadow:!0,buttontext:!0,captiontext:!0,graytext:!0,highlight:!0,highlighttext:!0,inactiveborder:!0,inactivecaption:!0,inactivecaptiontext:!0,infobackground:!0,infotext:!0,menu:!0,menutext:!0,scrollbar:!0,threeddarkshadow:!0,threedface:!0,threedhighlight:!0,threedlightshadow:!0,threedshadow:!0,window:!0,windowframe:!0,windowtext:!0},nr,wu,wf={"%":!0,cm:!0,em:!0,ex:!0,"in":!0,mm:!0,pc:!0,pt:!0,px:!0},bf,iu,ve={b:"\b",t:"\t",n:"\n",f:"\f",r:"\r",'"':'"',"/":"/","\\":"\\"},ye={alert:!1,confirm:!1,console:!1,Debug:!1,opera:!1,prompt:!1},pe={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r","'":"\\'",'"':'\\"',"/":"\\/","\\":"\\\\"},f,cr=["closure","exception","global","label","outer","undef","unused","var"],ru,bt,lr,bu={a:{},abbr:{},acronym:{},address:{},applet:{},area:{empty:!0,parent:" map "},article:{},aside:{},audio:{},b:{},base:{empty:!0,parent:" head "},bdo:{},big:{},blockquote:{},body:{parent:" html noframes "},br:{empty:!0},button:{},canvas:{parent:" body p div th td "},caption:{parent:" table "},center:{},cite:{},code:{},col:{empty:!0,parent:" table colgroup "},colgroup:{parent:" table "},command:{parent:" menu "},datalist:{},dd:{parent:" dl "},del:{},details:{},dialog:{},dfn:{},dir:{},div:{},dl:{},dt:{parent:" dl "},em:{},embed:{},fieldset:{},figure:{},font:{},footer:{},form:{},frame:{empty:!0,parent:" frameset "},frameset:{parent:" html frameset "},h1:{},h2:{},h3:{},h4:{},h5:{},h6:{},head:{parent:" html "},header:{},hgroup:{},hr:{empty:!0},"hta:application":{empty:!0,parent:" head "},html:{parent:"*"},i:{},iframe:{},img:{empty:!0},input:{empty:!0},ins:{},kbd:{},keygen:{},label:{},legend:{parent:" details fieldset figure "},li:{parent:" dir menu ol ul "},link:{empty:!0,parent:" head "},map:{},mark:{},menu:{},meta:{empty:!0,parent:" head noframes noscript "},meter:{},nav:{},noframes:{parent:" html body "},noscript:{parent:" body head noframes "},object:{},ol:{},optgroup:{parent:" select "},option:{parent:" optgroup select "},output:{},p:{},param:{empty:!0,parent:" applet object "},pre:{},progress:{},q:{},rp:{},rt:{},ruby:{},samp:{},script:{empty:!0,parent:" body div frame head iframe p pre span "},section:{},select:{},small:{},span:{},source:{},strong:{},style:{parent:" head ",empty:!0},sub:{},sup:{},table:{},tbody:{parent:" table "},td:{parent:" tr "},textarea:{},tfoot:{parent:" table "},th:{parent:" tr "},thead:{parent:" table "},time:{},title:{parent:" head "},tr:{parent:" table tbody thead tfoot "},tt:{},u:{},ul:{},"var":{},video:{}},uu,ar,c,ni,li,vr,tr,yr,vi,we={Buffer:!1,clearInterval:!1,clearTimeout:!1,console:!1,exports:!1,global:!1,module:!1,process:!1,querystring:!1,require:!1,setInterval:!1,setTimeout:!1,__dirname:!1,__filename:!1},fu,be={indexOf:!0,lastIndexOf:!0,search:!0},n,yi,r,ct,ku,pt,ui,ke={g:!0,i:!0,m:!0},de={defineClass:!1,deserialize:!1,gc:!1,help:!1,load:!1,loadClass:!1,print:!1,quit:!1,readFile:!1,readUrl:!1,runCommand:!1,seal:!1,serialize:!1,spawn:!1,sync:!1,toint32:!1,version:!1},a,ge={";":!0,'"':!0,"'":!0,")":!0},du,rt,no={Array:!1,Boolean:!1,Date:!1,decodeURI:!1,decodeURIComponent:!1,encodeURI:!1,encodeURIComponent:!1,Error:!1,eval:!1,EvalError:!1,Function:!1,isFinite:!1,isNaN:!1,JSON:!1,Math:!1,Number:!1,Object:!1,parseInt:!1,parseFloat:!1,RangeError:!1,ReferenceError:!1,RegExp:!1,String:!1,SyntaxError:!1,TypeError:!1,URIError:!1},to={E:!0,LN2:!0,LN10:!0,LOG2E:!0,LOG10E:!0,MAX_VALUE:!0,MIN_VALUE:!0,NEGATIVE_INFINITY:!0,PI:!0,POSITIVE_INFINITY:!0,SQRT1_2:!0,SQRT2:!0},pi,kt={},gu,u,pr,fi,nf,io={alert:!0,animator:!0,appleScript:!0,beep:!0,bytesToUIString:!0,Canvas:!0,chooseColor:!0,chooseFile:!0,chooseFolder:!0,closeWidget:!0,COM:!0,convertPathToHFS:!0,convertPathToPlatform:!0,CustomAnimation:!0,escape:!0,FadeAnimation:!0,filesystem:!0,Flash:!0,focusWidget:!0,form:!0,FormField:!0,Frame:!0,HotKey:!0,Image:!0,include:!0,isApplicationRunning:!0,iTunes:!0,konfabulatorVersion:!0,log:!0,md5:!0,MenuItem:!0,MoveAnimation:!0,openURL:!0,play:!0,Point:!0,popupMenu:!0,preferenceGroups:!0,preferences:!0,print:!0,prompt:!0,random:!0,Rectangle:!0,reloadWidget:!0,ResizeAnimation:!0,resolvePath:!0,resumeUpdates:!0,RotateAnimation:!0,runCommand:!0,runCommandInBg:!0,saveAs:!0,savePreferences:!0,screen:!0,ScrollBar:!0,showWidgetPreferences:!0,sleep:!0,speak:!0,Style:!0,suppressUpdates:!0,system:!0,tellWidget:!0,Text:!0,TextArea:!0,Timer:!0,unescape:!0,updateNow:!0,URL:!0,Web:!0,widget:!0,Window:!0,XMLDOM:!0,XMLHttpRequest:!0,yahooCheckLogin:!0,yahooLogin:!0,yahooLogout:!0},ro={ActiveXObject:!1,CScript:!1,Debug:!1,Enumerator:!1,System:!1,VBArray:!1,WScript:!1},h,at,uo=/@cc|<\/?|script|\]\s*\]|<\s*!|&lt/i,fo=/\r/g,eo=/\r\n/g,oo=/[\u0000-\u001f\u007f-\u009f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/,so=/[\[\]\/\\"'*<>.&:(){}+=#]/,kf=/^\s*(['"=>\/&#]|<(?:\/|\!(?:--)?)?|[a-zA-Z][a-zA-Z0-9_\-:]*|[0-9]+|--)/,df=/^([a-zA-Z_$][a-zA-Z0-9_$]*)$/,tf=/^(?:javascript|jscript|ecmascript|vbscript|mocha|livescript)\s*:/i,ho=/\*\/|\/\*/,gf=/[\u0000-\u001f'\\\u007f-\u009f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,co=/[>&]|<[\/!]?|--/,lo=/[^a-zA-Z0-9+\-_\/ ]/,ao=/^\s*([(){}\[.,:;'"~\?\]#@]|==?=?|\/(\*(jslint|properties|property|members?|globals?)?|=|\/)?|\*[\/=]?|\+(?:=|\++)?|-(?:=|-+)?|%=?|&[&=]?|\|[|=]?|>>?>?=?|<([\/=!]|\!(\[|--)?|<=?)?|\^=?|\!=?=?|[a-zA-Z_$][a-zA-Z0-9_$]*|[0-9]+([xX][0-9a-fA-F]+|\.[0-9]*)?([eE][+\-]?[0-9]+)?)/,ne=/&|\+|\u00AD|\.\.|\/\*|%[^;]|base64|url|expression|data|mailto/i,vo={outer:kf,html:kf,style:/^\s*([{:#%.=,>+\[\]@()"';]|\*=?|\$=|\|=|\^=|~=|[a-zA-Z_][a-zA-Z0-9_\-]*|[0-9]+|<\/|\/\*)/,styleproperty:/^\s*([@#!"'};:\-%.=,+\[\]()*_]|[a-zA-Z][a-zA-Z0-9._\-]*|\/\*?|\d+(?:\.\d+)?|<\/)/};return typeof Array.prototype.filter!="function"&&(Array.prototype.filter=function(n){for(var u=this.length,r=[],i,t=0;t<u;t+=1)try{i=this[t],n(i)&&r.push(i)}catch(f){}return r}),typeof Array.prototype.forEach!="function"&&(Array.prototype.forEach=function(n){for(var i=this.length,t=0;t<i;t+=1)try{n(this[t])}catch(r){}return[]}),typeof Array.isArray!="function"&&(Array.isArray=function(n){return Object.prototype.toString.apply(n)==="[object Array]"}),Object.prototype.hasOwnProperty.call(Object,"create")||(Object.create=function(n){return te.prototype=n,new te}),typeof Object.keys!="function"&&(Object.keys=function(n){var i=[],t;for(t in n)Object.prototype.hasOwnProperty.call(n,t)&&i.push(t);return i}),typeof String.prototype.entityify!="function"&&(String.prototype.entityify=function(){return this.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}),typeof String.prototype.isAlpha!="function"&&(String.prototype.isAlpha=function(){return this>="a"&&this<="z￿"||this>="A"&&this<="Z￿"}),typeof String.prototype.isDigit!="function"&&(String.prototype.isDigit=function(){return this>="0"&&this<="9"}),typeof String.prototype.supplant!="function"&&(String.prototype.supplant=function(n){return this.replace(/\{([^{}]*)\}/g,function(t,i){var r=n[i];return typeof r=="string"||typeof r=="number"?r:t})}),vr=function(){function v(t,u,f,e){var s={comment:t,quote:u,at:e,line:f};hr||du||h&&h!=="script"&&h!=="style"&&h!=="styleproperty"?o("unexpected_comment",f,i):h==="script"&&/<\//i.test(n)?o("unexpected_a",f,i,"<\/"):r.safe&&uo.test(t)&&o("dangerous_comment",f,e),yi.comments?yi.comments.push(s):yi.comments=[s],JAYLINT.comments.push(s)}function a(){var u;return t>=tr.length?!1:(i=1,n=tr[t],t+=1,(u=n.search(/ \t/))>=0&&o("mixed",t,u+1),n=n.replace(/\t/g,gu),(u=n.search(oo))>=0&&o("unsafe",t,u),r.maxlen&&r.maxlen<n.length&&o("too_long",t,n.length),!0)}function s(n,u,f){var h,s;return(n==="(string)"||n==="(range)")&&tf.test(u)&&o("url",t,e),s=Object.create(kt[n==="(punctuator)"||n==="(identifier)"&&Object.prototype.hasOwnProperty.call(kt,u)?u:n]||kt["(error)"]),n==="(identifier)"&&(s.identifier=!0,u==="__iterator__"||u==="__proto__"?st("reserved_a",t,e,u):r.nomen||u.charAt(0)!=="_"&&u.charAt(u.length-1)!=="_"||o("dangling_a",t,e,u)),u!==undefined&&(s.value=u),f&&(s.quote=f),s.line=t,s.from=e,s.thru=i,s.prev=yi,h=s.id,ku=h&&("(,=:[!&|?{};".indexOf(h.charAt(h.length-1))>=0||h==="return"),yi.next=s,yi=s,s}function y(t){var u=t.exec(n),r;if(u)return c=u[0].length,r=u[1],f=r.charAt(0),n=n.slice(c),e=i+c-r.length,i+=c,r}function p(u){function y(r){var u=parseInt(n.substr(c+1,r),16);c+=r,u>=32&&u<=126&&u!==34&&u!==92&&u!==39&&o("unexpected_a",t,i,"\\"),i+=r,f=String.fromCharCode(u)}var f,c,v="";if(li&&u!=='"'&&o("expected_a",t,i,'"'),at===u||h==="scriptstring"&&!at)return s("(punctuator)",u);for(c=0;;){while(c>=n.length)c=0,h==="html"&&a()||st("unclosed",t,e);if(f=n.charAt(c),f===u)return i+=1,n=n.slice(c+1),s("(string)",v,u);if(f<" "){if(f==="\n"||f==="\r")break;o("control_a",t,i+l,n.slice(0,l))}else if(f===at)o("bad_html",t,i+c);else if(f==="<")r.safe&&h==="html"?o("adsafe_a",t,i+l,f):n.charAt(l+1)==="/"&&(h||r.safe)?o("expected_a_b",t,i,"<\\/","<\/"):n.charAt(l+1)==="!"&&(h||r.safe)&&o("unexpected_a",t,i,"<!");else if(f==="\\")if(h==="html")r.safe&&o("adsafe_a",t,i+l,f);else if(h==="styleproperty")c+=1,i+=1,f=n.charAt(c),f!==u&&o("unexpected_a",t,i,"\\");else{c+=1,i+=1,f=n.charAt(c);switch(f){case"":r.es5||o("es5",t,i),a(),c=-1;break;case at:o("bad_html",t,i+c);break;case"'":li&&o("unexpected_a",t,i,"\\'");break;case"u":y(4);break;case"v":li&&o("unexpected_a",t,i,"\\v"),f='\v';break;case"x":li&&o("unexpected_a",t,i,"\\x"),y(2);break;default:f=ve[f],typeof f!="string"&&o("unexpected_a",t,i,"\\")}}v+=f,i+=1,c+=1}}function b(r){var e;return h!=="style"&&h!=="styleproperty"&&n.charAt(0).isAlpha()&&o("expected_space_a_b",t,i,f,n.charAt(0)),f==="0"&&(e=r.charAt(1),e.isDigit()?u.id!=="."&&h!=="styleproperty"&&o("unexpected_a",t,i,r):li&&(e==="x"||e==="X")&&o("unexpected_a",t,i,"0x")),r.slice(r.length-1)==="."&&o("trailing_decimal_a",t,i,r),h!=="style"&&(e=+r,isFinite(e)||o("bad_number",t,i,r),r=e),s("(number)",r)}function k(){for(var y,c,d=0,p=0,b,a,u=0,v,k;;){y=!0,f=n.charAt(u),u+=1;switch(f){case"":st("unclosed_regexp",t,e);return;case"/":for(p>0&&o("unescaped_a",t,e+u,"/"),f=n.slice(0,u-1),b=Object.create(ke);b[n.charAt(u)]===!0;)b[n.charAt(u)]=!1,u+=1;return n.charAt(u).isAlpha()&&st("unexpected_a",t,e,n.charAt(u)),i+=u,n=n.slice(u),((k=n.charAt(0))==="/"||k==="*")&&st("confusing_regexp",t,e),s("(regexp)",f);case"\\":f=n.charAt(u),f<" "?o("control_a",t,e+u,String(f)):f==="<"&&o(w.unexpected_a,t,e+u,"\\"),u+=1;break;case"(":if(p+=1,y=!1,n.charAt(u)==="?"){u+=1;switch(n.charAt(u)){case":":case"=":case"!":u+=1;break;default:o(w.expected_a_b,t,e+u,":",n.charAt(u))}}else d+=1;break;case"|":y=!1;break;case")":p===0?o("unescaped_a",t,e+u,")"):p-=1;break;case" ":for(l=1;n.charAt(u)===" ";)u+=1,l+=1;l>1&&o("use_braces",t,e+u,l);break;case"[":f=n.charAt(u),f==="^"&&(u+=1,r.regexp?n.charAt(u)==="]"&&st("unescaped_a",t,e+u,"^"):o("insecure_a",t,e+u,f)),c=!1,f==="]"&&(o("empty_class",t,e+u-1),c=!0);n:do{f=n.charAt(u),u+=1;switch(f){case"[":case"^":o("unescaped_a",t,e+u,f),c=!0;break;case"-":c?c=!1:(o("unescaped_a",t,e+u,"-"),c=!0);break;case"]":c||o("unescaped_a",t,e+u-1,"-");break n;case"\\":f=n.charAt(u),f<" "?o(w.control_a,t,e+u,String(f)):f==="<"&&o(w.unexpected_a,t,e+u,"\\"),u+=1,c=!0;break;case"/":o("unescaped_a",t,e+u-1,"/"),c=!0;break;case"<":h==="script"&&(f=n.charAt(u),(f==="!"||f==="/")&&o(w.html_confusion_a,t,e+u,f)),c=!0;break;default:c=!0}}while(f);break;case".":r.regexp||o("insecure_a",t,e+u,f);break;case"]":case"?":case"{":case"}":case"+":case"*":o("unescaped_a",t,e+u,f);break;case"<":h==="script"&&(f=n.charAt(u),(f==="!"||f==="/")&&o(w.html_confusion_a,t,e+u,f))}if(y)switch(n.charAt(u)){case"?":case"+":case"*":u+=1,n.charAt(u)==="?"&&(u+=1);break;case"{":for(u+=1,f=n.charAt(u),(f<"0"||f>"9")&&o(w.expected_number_a,t,e+u,f),u+=1,v=+f;;){if(f=n.charAt(u),f<"0"||f>"9")break;u+=1,v=+f+v*10}if(a=v,f===","&&(u+=1,a=Infinity,f=n.charAt(u),f>="0"&&f<="9"))for(u+=1,a=+f;;){if(f=n.charAt(u),f<"0"||f>"9")break;u+=1,a=+f+a*10}n.charAt(u)!=="}"?o(w.expected_a_b,t,e+u,"}",f):u+=1,n.charAt(u)==="?"&&(u+=1),v>a&&o(w.not_greater,t,e+u,v,a)}}return f=n.slice(0,u-1),i+=u,n=n.slice(u),s("(regexp)",f)}var i,f,e,c,t,l,n;return{init:function(n){tr=typeof n=="string"?n.replace(eo,"\n").replace(fo,"\n").split("\n"):n,t=0,a(),e=1},range:function(r,u){var f,h="";for(e=i,n.charAt(0)!==r&&st("expected_a_b",t,i,r,n.charAt(0));;){n=n.slice(1),i+=1,f=n.charAt(0);switch(f){case"":st("missing_a",t,i,f);break;case u:return n=n.slice(1),i+=1,s("(range)",h);case at:case"\\":o("unexpected_a",t,i,f)}h+=f}},token:function(){for(var r,f,d,l;;){while(!n)if(!a())return s("(end)");while(h==="outer")if(f=n.search(co),f===0)break;else if(f>0){i+=1,n=n.slice(f);break}else if(!a())return s("(end)","");if(l=y(vo[h]||ao),l){if(r=l.charAt(0),r.isAlpha()||r==="_"||r==="$")return s("(identifier)",l);if(r.isDigit())return b(l);switch(l){case'"':case"'":return p(l);case"//":v(n,"//",t,i),n="";break;case"/*":for(d="/*";;){if(f=n.search(ho),f>=0)break;v(n,d,t,i),d="",a()||st("unclosed_comment",t,i)}v(n.slice(0,f),d,i,t),i+=f+2,n.charAt(f)==="/"&&st("nested_comment",t,i),n=n.slice(f+2);break;case"":break;case"/":return u.id==="/="&&st(w.slash_equal,t,e),ku?k():s("(punctuator)",l);case"<!--":for(c=t;;){if(f=n.indexOf("--"),f>=0)break;f=n.indexOf("<!"),f>=0&&st("nested_comment",t,i+f),a()||st("unclosed_comment",c,r)}c=n.indexOf("<!"),c>=0&&c<f&&st("nested_comment",t,i+c),i+=f,n.charAt(f+2)!==">"&&st("expected_a",t,i,"-->"),i+=3,n=n.slice(f+3);break;case"#":if(h==="html"||h==="styleproperty"){for(;;){if(r=n.charAt(0),(r<"0"||r>"9")&&(r<"a"||r>"f")&&(r<"A"||r>"F"))break;i+=1,n=n.slice(1),l+=r}return l.length!==4&&l.length!==7&&o("bad_color_a",t,e+c,l),s("(color)",l)}return s("(punctuator)",l);default:if(h==="outer"&&r==="&"){for(i+=1,n=n.slice(1);;){if(r=n.charAt(0),i+=1,n=n.slice(1),r===";")break;r>="0"&&r<="9"||r>="a"&&r<="z"||r==="#"||st("bad_entity",t,e+c,i)}break}return s("(punctuator)",l)}}else{for(l="",r="";n&&n<"!";)n=n.slice(1);if(n){if(h==="html")return s("(error)",n.charAt(0));st("unexpected_a",t,i,n.charAt(0))}}}}}}(),kt["(identifier)"]={lbp:0,identifier:!0,nud:function(){var n=this.value,e=a[n],i,o;if(typeof e!="object"&&(o=ct[n],typeof o=="boolean"?(lr[n]=e={value:n,writeable:o,funct:bt},bt[n]="var"):(r.undef||t("used_before_a",u),a[n]=e={value:n,writeable:!0,funct:f},f[n]="undef")),i=e.funct,f===i)switch(f[n]){case"becoming":t("unexpected_a",u),f[n]="var";break;case"unused":f[n]="var";break;case"unparam":f[n]="parameter";break;case"unction":f[n]="function";break;case"label":t("a_label",u,n)}else switch(f[n]){case"closure":case"function":case"var":case"unused":t("a_scope",u,n);break;case"label":t("a_label",u,n);break;case"outer":case"global":break;default:switch(i[n]){case"function":case"unction":case"var":case"unused":case"becoming":case"closure":case"parameter":i[n]="closure",f[n]=i===bt?"global":"outer";break;case"unparam":i[n]="parameter",f[n]="outer";break;case"undef":f[n]="undef";break;case"label":t("a_label",u,n)}}return this},led:function(){e("expected_operator_a")}},si("(array)","array"),si("(color)","color"),si("(function)","function"),si("(number)","number",wr),si("(object)","object"),si("(string)","string",wr),si("(boolean)","boolean",wr),si("(range)","range"),si("(regexp)","regexp",wr),ff("(begin)"),ff("(end)"),ff("(error)"),ki(et("<\/")),et("<!"),et("<!--"),et("-->"),ki(et("}")),et(")"),et("]"),ki(et('"')),ki(et("'")),et(";"),et(":"),et(","),et("#"),et("@"),et("*/"),ki(k("case")),k("catch"),ki(k("default")),k("else"),k("finally"),of("arguments",function(n){pi&&f===bt?t("strict",n):r.safe&&t("adsafe",n)}),of("eval",function(n){r.safe&&t("adsafe",n)}),ur("false","boolean",!1),ur("Infinity","number",Infinity),ur("NaN","number",NaN),ur("null","",null),of("this",function(n){pi&&(f["(statement)"]&&f["(name)"].charAt(0)>"Z"||f===bt)?t("strict",n):r.safe&&t("adsafe",n)}),ur("true","boolean",!0),ur("undefined","",undefined),ot("?",30,function(r,u){u.first=ii(ti(r)),u.second=l(0),g();var f=n;return i(":"),s(),g(),u.third=l(10),u.arity="ternary",u.type=it(u.second,u.third),vt(u.second,u.third)?t("weird_ternary",f):vt(u.first,u.second)&&t("use_or",u),u}),ot("||",40,function(n,i){function r(n){return n.id!=="&&"||n.paren||t("and",n),n}return i.first=r(ii(ti(n))),i.second=r(ti(l(40))),vt(i.first,i.second)&&t("weird_condition",i),i}),ot("&&",50,function(n,i){return i.first=ii(ti(n)),i.second=ti(l(50)),vt(i.first,i.second)&&t("weird_condition",i),i}),ht("void",function(){return(this.first=l(0),this.first.id!=="(number)"||this.first.value)?(t("unexpected_a",this),this):(this.type="undefined",this)}),fr("|",70),fr("^",80),fr("&",90),ai("==","==="),ai("==="),ai("!=","!=="),ai("!=="),ai("<"),ai(">"),ai("<="),ai(">="),fr("<<",120),fr(">>",120),fr(">>>",120),ot("in",120,function(n,i){return t("infix_in",i),i.left=n,i.right=l(130),i},"boolean"),ot("instanceof",120,null,"boolean"),ot("+",130,function(n,i){n.value||(n.id==="(number)"?t("unexpected_a",n):n.id==="(string)"&&t("expected_a_b",n,"String","''"));var r=l(130);return(r.value||(r.id==="(number)"?t("unexpected_a",r):r.id==="(string)"&&t("expected_a_b",r,"String","''")),n.id===r.id&&(n.id==="(string)"||n.id==="(number)"))?(n.value+=r.value,n.thru=r.thru,n.id==="(string)"&&tf.test(n.value)&&t("url",n),s(r),s(i),n):(i.first=n,i.second=r,i.type=it(n,r,i),i)}),ht("+","num"),ht("+++",function(){return t("confusing_a",u),this.first=l(150),this.arity="prefix",this}),ot("+++",130,function(n){return t("confusing_a",u),this.first=n,this.second=l(130),this}),ot("-",130,function(n,i){(n.id==="(number)"&&n.value===0||n.id==="(string)")&&t("unexpected_a",n);var r=l(130);return((r.id==="(number)"&&r.value===0||r.id==="(string)")&&t("unexpected_a",n),n.id===r.id&&n.id==="(number)")?(n.value-=r.value,n.thru=r.thru,s(r),s(i),n):(i.first=n,i.second=r,i)},"number"),ht("-"),ht("---",function(){return t("confusing_a",u),this.first=l(150),this.arity="prefix",this}),ot("---",130,function(n){return t("confusing_a",u),this.first=n,this.second=l(130),this}),ot("*",140,function(n,i){(n.id==="(number)"&&(n.value===0||n.value===1)||n.id==="(string)")&&t("unexpected_a",n);var r=l(140);return((r.id==="(number)"&&(r.value===0||r.value===1)||r.id==="(string)")&&t("unexpected_a",r),n.id===r.id&&n.id==="(number)")?(n.value*=r.value,n.thru=r.thru,s(r),s(i),n):(i.first=n,i.second=r,i)},"number"),ot("/",140,function(n,i){(n.id==="(number)"&&n.value===0||n.id==="(string)")&&t("unexpected_a",n);var r=l(140);return((r.id==="(number)"&&(r.value===0||r.value===1)||r.id==="(string)")&&t("unexpected_a",r),n.id===r.id&&n.id==="(number)")?(n.value/=r.value,n.thru=r.thru,s(r),s(i),n):(i.first=n,i.second=r,i)},"number"),ot("%",140,function(n,i){(n.id==="(number)"&&(n.value===0||n.value===1)||n.id==="(string)")&&t("unexpected_a",n);var r=l(140);return((r.id==="(number)"&&r.value===0||r.id==="(string)")&&t("unexpected_a",r),n.id===r.id&&n.id==="(number)")?(n.value%=r.value,n.thru=r.thru,s(r),s(i),n):(i.first=n,i.second=r,i)},"number"),ee("++"),ht("++"),ee("--"),ht("--"),ht("delete",function(){p();var n=l(0);return n&&(n.id==="."||n.id==="[")||t("deleted"),this.first=n,this}),ht("~",function(){return nt(),r.bitwise||t("unexpected_a",this),l(150),this},"number"),ht("!",function(){return nt(),this.first=ii(l(150)),this.arity="prefix",ce[this.first.id]===!0&&t("confusing_a",this),this},"boolean"),ht("typeof",null,"string"),ht("new",function(){p();var f=l(160),o,e,h;if(this.first=f,f.id!=="function")if(f.identifier)switch(f.value){case"Object":t("use_object",u);break;case"Array":if(n.id==="("){if(e=n,e.first=this,i("("),n.id!==")")for(e.second=l(0),e.second.id==="(string)"&&e.second.value?o=!0:(ii(e.second,w.use_array),o=!1);n.id!==")"&&n.id!=="(end)";)o&&(t("use_array",e),o=!1),i();else t("use_array",u);return i(")",e),s(),e}t("use_array",u);break;case"Number":case"String":case"Boolean":case"Math":case"JSON":t("not_a_constructor",f);break;case"Function":r.evil||t("function_eval");break;case"Date":case"RegExp":break;default:f.id!=="function"&&(h=f.value.charAt(0),!r.newcap&&(h<"A"||h>"Z")&&t("constructor_name_a",u))}else f.id!=="."&&f.id!=="["&&f.id!=="("&&t("bad_constructor",u);else t("weird_new",this);return n.id!=="("&&t("missing_a",n,"()"),this}),ot("(",160,function(i,f){c&&c.mode==="expression"?y(pt,u):nt(pt,u),i.immed||i.id!=="function"||t("wrap_immediate");var e=[];if(i&&(it("function",i),i.identifier?i.value.match(/^[A-Z]([A-Z0-9_$]*[a-z][A-Za-z0-9_$]*)?$/)&&i.value!=="Number"&&i.value!=="String"&&i.value!=="Boolean"&&i.value!=="Date"&&(i.value==="Math"||i.value==="JSON"?t("not_a_function",i):i.value==="Object"?t("use_object",u):i.value!=="Array"&&r.newcap||t("missing_a",i,"new")):i.id==="."&&(r.safe&&i.first.value==="Math"&&i.second==="random"?t("adsafe",i):i.second.value==="split"&&i.first.id==="(string)"&&t("use_array",i.second))),ut(),n.id!==")")for(y();;){if(b(),e.push(l(10)),n.id!==",")break;tt()}return y(),ft(")",f),typeof i=="object"&&(i.value==="parseInt"&&e.length===1&&t("radix",i),r.evil||(i.value==="eval"||i.value==="Function"||i.value==="execScript"?t("evil",i):e[0]&&e[0].id==="(string)"&&(i.value==="setTimeout"||i.value==="setInterval")&&t("implied_evil",i)),i.identifier||i.id==="."||i.id==="["||i.id==="("||i.id==="&&"||i.id==="||"||i.id==="?"||t("bad_invocation",i)),f.first=i,f.second=e,r.type||(i.id==="."?i.second.value==="charAt"||i.second.value==="substring"?(it("string",f),it("string",i.first),e.forEach(function(n){it("number",n)})):(i.second.value==="toString"||i.second.value==="stringify")&&it("string",f):i.identifier&&i.value==="String"&&it("string",f)),f},"",!0),ht("(",function(){ut("expression"),s(),y(),b(),n.id==="function"&&(n.immed=!0);var i=l(0);return i.paren=!0,y(),ft(")",this),s(),i.id==="function"&&(n.id==="("?t("move_invocation"):t("bad_wrap",this)),i}),ot(".",170,function(f,o){y(pt,u),y();var s=kr();if(typeof s=="string"&&hu(s),o.first=f,o.second=u,f&&f.value==="arguments"&&(s==="callee"||s==="caller")?t("avoid_a",f,"arguments."+s):!r.evil&&f&&f.value==="document"&&(s==="write"||s==="writeln")?t("write_is_wrong",f):r.adsafe&&(sr||f.value!=="ADSAFE"||(s==="id"||s==="lib"?t("adsafe",o):s==="go"&&(h!=="script"?t("adsafe",o):(ci||n.id!=="("||oi(0).id!=="(string)"||oi(0).value!==yt||oi(1).id!==",")&&e("adsafe_a",o,"go"),ci=!0,or=!1)),sr=!1),r.evil||s!=="eval"&&s!=="execScript"){if(r.safe)for(;;){if(nu[s]===!0&&t("adsafe_a",u,s),typeof ct[f.value]!="boolean"||n.id==="(")break;if(to[s]===!0){n.id==="."&&t("adsafe",o);break}if(n.id!=="."){t("adsafe",o);break}i("."),u.first=o,u.second=s,o=u,s=kr(),typeof s=="string"&&hu(s)}}else t("evil");return s==="length"&&it("number",o),o},"",!0),ot("[",170,function(n,i){var o=ef(n),f,e;nt(pt,u),y(),ut(),b(),f=l(0);switch(ef(f)){case"number":f.id==="(number)"&&n.id==="arguments"&&t("use_param",n),o||it("array",n);break;case"string":f.id==="(string)"?(r.safe&&(nu[f.value]||f.value.charAt(0)==="_"||f.value.slice(-1)==="_")?t("adsafe_subscript_a",f):r.evil||f.value!=="eval"&&f.value!=="execScript"?!r.sub&&df.test(f.value)&&(e=kt[f.value],e&&e.reserved||t("subscript",f)):t("evil",f),hu(f.value)):r.safe&&f.id!=="typeof"&&t("adsafe_subscript_a",f),it("object",n);break;case undefined:switch(ef(n)){case"array":it("number",f);break;case"object":it("string",f);break;case"string":r.type||t("use_charAt",i),i.type="string"}r.safe&&t("adsafe_subscript_a",f);break;default:r.safe?t("adsafe_subscript_a",f):t("bad_type")}return ft("]",i),s(),y(pt,u),i.first=n,i.second=f,i},"",!0),ht("[",function(){for(this.arity="prefix",this.first=[],this.type="array",ut("array");n.id!=="(end)";){while(n.id===",")t("unexpected_a",n),i(","),s();if(n.id==="]")break;if(c.wrap=!1,b(),this.first.push(l(10)),n.id===","){if(tt(),n.id==="]"&&!r.es5){t("unexpected_a",u);break}}else break}return ft("]",this),s(),this},170),gt("="),gt("+=","+"),gt("-=","-"),gt("*=","*"),gt("/=","/").nud=function(){e("slash_equal")},gt("%=","%"),gt("&=","&"),gt("|=","|"),gt("^=","^"),gt("<<=","<<"),gt(">>=",">>"),gt(">>>=",">>>"),ht("{",function(){var a,o,p,y,h,v,w={};for(this.arity="prefix",this.first=[],this.type="object",ut();n.id!=="}";){if(c.wrap=!1,b(),n.value==="get"&&oi().id!==":"?(r.es5||t("es5"),a=n,i("get"),rr(),y=n,o=cf(),o||e("missing_property"),a.value="",cu(a),f["(loopage)"]&&t("function_loop",a),h=a.first,h&&t("parameter_a_get_b",h[0],h[0].value,o),tt(),v=n,v.value="",g(),b(),i("set"),rr(),p=cf(),o!==p&&e("expected_a_b",u,o,p||n.value),cu(v),h=v.first,h&&h.length===1?h[0].value!=="value"&&e("expected_a_b",h[0],"value",h[0].value):e("parameter_set_a",v,"value"),y.first=[a,v]):(y=n,o=cf(),typeof o!="string"&&e("missing_property"),i(":"),s(),g(),y.first=l(10)),this.first.push(y),w[o]===!0&&t("duplicate_a",n,o),w[o]=!0,hu(o),n.id!==",")break;for(;;){if(tt(),n.id!==",")break;t("unexpected_a",n)}n.id!=="}"||r.es5||t("unexpected_a",u)}return ft("}",this),s(),this}),lt("{",function(){return s(),t("statement_block"),this.arity="statement",this.block=di(),this.disrupt=this.block.disrupt,i("}",this),s(),this}),lt("/*global",bi),lt("/*globals",bi),lt("/*jslint",bi),lt("/*member",bi),lt("/*members",bi),lt("/*property",bi),lt("/*properties",bi),lt("var",function(){var o,h,s;for(f["(vars)"]&&!r.vars?t("combine_var"):f!==bt&&(f["(vars)"]=!0),this.arity="statement",this.first=[],ut("var");;){if(s=n,h=kr(),ir(s,"becoming"),n.id==="="?(o=n,o.first=s,g(),i("="),g(),n.id==="undefined"&&t("unnecessary_initialize",u,h),oi(0).id==="="&&n.identifier&&e("var_a_not"),o.second=l(0),o.arity="infix",this.first.push(o),o.second.type&&(s.type=o.second.type)):this.first.push(s),f[h]==="becoming"&&(f[h]="unused"),n.id!==",")break;tt(),c.wrap=!1,fi&&n.line===u.line&&this.first.length===1&&(fi=null,c.open=!1,c.at-=r.indent),g(),b()}return fi=null,ft(),this}),lt("function",function(){p(),ar&&t("function_block",u);var i=n,r=kr();return ir(i,"unction"),y(),cu(this,r),n.id==="("&&n.line===u.line&&e("function_statement"),this.arity="statement",this}),ht("function",function(){p();var n=sf();return n?y():n="",cu(this,n),f["(loopage)"]&&t("function_loop"),this.arity="function",this}),lt("if",function(){var t=n;return p(),i("("),ut("control"),s(),y(),b(),this.arity="statement",this.first=ii(ti(l(0))),y(),ft(")",t),s(),p(),this.block=ri(!0),n.id==="else"&&(p(),i("else"),s(),p(),this["else"]=n.id==="if"||n.id==="switch"?hf(!0):ri(!0),this["else"].disrupt&&this.block.disrupt&&(this.disrupt=!0)),this}),lt("try",function(){var f,u,o;return r.adsafe&&t("adsafe_a",this),p(),this.arity="statement",this.block=ri(!1),n.id==="catch"&&(p(),i("catch"),s(),p(),o=n,i("("),ut("control"),s(),y(),b(),u=a,a=Object.create(u),f=n.value,this.first=f,n.identifier?ir(n,"exception"):t("expected_identifier_a",n),i(),y(),ft(")",o),s(),p(),this.second=ri(!1),a=u),n.id==="finally"?(s(),p(),i("finally"),s(),p(),this.third=ri(!1)):this.second||e("expected_a_b",n,"catch",n.value),this}),ou("while",function(){p();var r=n;return f["(breakage)"]+=1,f["(loopage)"]+=1,i("("),ut("control"),s(),y(),b(),this.arity="statement",this.first=ti(l(0)),this.first.id!=="true"&&ii(this.first,w.unexpected_a),y(),ft(")",r),s(),p(),this.block=ri(!0),this.block.disrupt&&t("strange_loop",pt),f["(breakage)"]-=1,f["(loopage)"]-=1,this}),k("with"),ou("switch",function(){var u,r=n,e=!0;for(f["(breakage)"]+=1,p(),i("("),s(),y(),ut(),this.arity="statement",this.first=ii(ti(l(0))),y(),ft(")",r),s(),p(),i("{"),ut(),this.second=[];n.id==="case";){for(r=n,r.first=[],r.arity="case",g(),b("case"),i("case");;){if(p(),u=l(0),r.first.push(u),u.id==="NaN"&&t("unexpected_a",u),nt(),i(":"),s(),n.id!=="case")break;g(),b("case"),i("case"),s()}g(),r.second=di(),r.second&&r.second.length>0?(u=r.second[r.second.length-1],u.disrupt?u.id==="break"&&(e=!1):t("missing_a_after_b",n,"break","case")):t("empty_case"),this.second.push(r)}return this.second.length===0&&t("missing_a",n,"case"),n.id==="default"&&(g(),r=n,r.arity="case",b("case"),i("default"),s(),nt(),i(":"),s(),g(),r.second=di(),r.second&&r.second.length>0&&(u=r.second[r.second.length-1],e&&u.disrupt&&u.id!=="break"&&(this.disrupt=!0)),this.second.push(r)),f["(breakage)"]-=1,g(),ft("}",this),this}),lt("debugger",function(){return r.debug||t("unexpected_a",this),this.arity="statement",this}),ou("do",function(){f["(breakage)"]+=1,f["(loopage)"]+=1,p(),this.arity="statement",this.block=ri(!0),this.block.disrupt&&t("strange_loop",pt),p(),i("while"),s();var r=n;return p(),i("("),ut(),s(),y(),b(),this.first=ii(ti(l(0)),w.unexpected_a),y(),ft(")",r),s(),f["(breakage)"]-=1,f["(loopage)"]-=1,this}),ou("for",function(){var c,o,v=!1,k=n,h,a;if(this.arity="statement",f["(breakage)"]+=1,f["(loopage)"]+=1,i("("),ut("control"),s(),g(this,k),y(),n.id==="var"&&e("move_var"),b(),oi(0).id==="in"){a=n;switch(f[a.value]){case"unused":f[a.value]="var";break;case"closure":case"var":break;default:t("bad_in_a",a)}if(it("string",a),i(),h=n,i("in"),h.first=a,h.second=l(20),it("object",h.second),ft(")",k),s(),this.first=h,c=ri(!0),!r.forin){if(c.length===1&&typeof c[0]=="object"&&c[0].value==="if"&&!c[0]["else"]){for(o=c[0].first;o.id==="&&";)o=o.first;switch(o.id){case"===":case"!==":v=o.first.id==="["?o.first.first.value===h.second.value&&o.first.second.value===h.first.value:o.first.id==="typeof"&&o.first.first.id==="["&&o.first.first.first.value===h.second.value&&o.first.first.second.value===h.first.value;break;case"(":v=o.first.id==="."&&(o.first.first.value===h.second.value&&o.first.second.value==="hasOwnProperty"&&o.second[0].value===h.first.value||o.first.first.value==="ADSAFE"&&o.first.second.value==="has"&&o.second[0].value===h.second.value&&o.second[1].value===h.first.value||o.first.first.id==="."&&o.first.first.first.id==="."&&o.first.first.first.first.value==="Object"&&o.first.first.first.second.value==="prototype"&&o.first.first.second.value==="hasOwnProperty"&&o.first.second.value==="call"&&o.second[0].value===h.second.value&&o.second[1].value===h.first.value)}}v||t("for_if",this)}}else{if(n.id!==";")for(b(),this.first=[];;){if(this.first.push(l(0,"for")),n.id!==",")break;tt()}if(wt(),n.id!==";"&&(b(),this.second=ti(l(0)),this.second.id!=="true"&&ii(this.second,w.unexpected_a)),wt(u),n.id===";"&&e("expected_a_b",n,")",";"),n.id!==")")for(this.third=[],b();;){if(this.third.push(l(0,"for")),n.id!==",")break;tt()}y(),ft(")",k),s(),p(),c=ri(!0)}return c.disrupt&&t("strange_loop",pt),this.block=c,f["(breakage)"]-=1,f["(loopage)"]-=1,this}),su("break",function(){var r=n.value;return this.arity="statement",f["(breakage)"]===0&&t("unexpected_a",this),n.identifier&&u.line===n.line&&(rr(),f[r]!=="label"?t("not_a_label",n):a[r].funct!==f&&t("not_a_scope",n),this.first=n,i()),this}),su("continue",function(){r["continue"]||t("unexpected_a",this);var e=n.value;return this.arity="statement",f["(breakage)"]===0&&t("unexpected_a",this),n.identifier&&u.line===n.line&&(rr(),f[e]!=="label"?t("not_a_label",n):a[e].funct!==f&&t("not_a_scope",n),this.first=n,i()),this}),su("return",function(){return this.arity="statement",n.id!==";"&&n.line===u.line&&(rr(),(n.id==="/"||n.id==="(regexp)")&&t("wrap_regexp"),this.first=l(20)),this}),su("throw",function(){return this.arity="statement",rr(),this.first=l(20),this}),k("class"),k("const"),k("enum"),k("export"),k("extends"),k("import"),k("super"),k("let"),k("yield"),k("implements"),k("interface"),k("package"),k("private"),k("protected"),k("public"),k("static"),pu=[gi,function(){for(;;)if(n.identifier)switch(n.value.toLowerCase()){case"url":gi();break;case"expression":t("unexpected_a"),i();break;default:i()}else{if(n.id===";"||n.id==="!"||n.id==="(end)"||n.id==="}")return!0;i()}}],nr=["none","dashed","dotted","double","groove","hidden","inset","outset","ridge","solid"],wu=["auto","always","avoid","left","right"],bf={all:!0,braille:!0,embossed:!0,handheld:!0,print:!0,projection:!0,screen:!0,speech:!0,tty:!0,tv:!0},iu=["auto","hidden","scroll","visible"],tu={background:[!0,"background-attachment","background-color","background-image","background-position","background-repeat"],"background-attachment":["scroll","fixed"],"background-color":["transparent",hi],"background-image":["none",gi],"background-position":[2,[v,"top","bottom","left","right","center"]],"background-repeat":["repeat","repeat-x","repeat-y","no-repeat"],border:[!0,"border-color","border-style","border-width"],"border-bottom":[!0,"border-bottom-color","border-bottom-style","border-bottom-width"],"border-bottom-color":hi,"border-bottom-style":nr,"border-bottom-width":er,"border-collapse":["collapse","separate"],"border-color":["transparent",4,hi],"border-left":[!0,"border-left-color","border-left-style","border-left-width"],"border-left-color":hi,"border-left-style":nr,"border-left-width":er,"border-right":[!0,"border-right-color","border-right-style","border-right-width"],"border-right-color":hi,"border-right-style":nr,"border-right-width":er,"border-spacing":[2,v],"border-style":[4,nr],"border-top":[!0,"border-top-color","border-top-style","border-top-width"],"border-top-color":hi,"border-top-style":nr,"border-top-width":er,"border-width":[4,er],bottom:[v,"auto"],"caption-side":["bottom","left","right","top"],clear:["both","left","none","right"],clip:[is,"auto"],color:hi,content:["open-quote","close-quote","no-open-quote","no-close-quote",vf,gi,ts,go],"counter-increment":[af,"none"],"counter-reset":[af,"none"],cursor:[gi,"auto","crosshair","default","e-resize","help","move","n-resize","ne-resize","nw-resize","pointer","s-resize","se-resize","sw-resize","w-resize","text","wait"],direction:["ltr","rtl"],display:["block","compact","inline","inline-block","inline-table","list-item","marker","none","run-in","table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row","table-row-group"],"empty-cells":["show","hide"],float:["left","none","right"],font:["caption","icon","menu","message-box","small-caption","status-bar",!0,"font-size","font-style","font-weight","font-family"],"font-family":ns,"font-size":["xx-small","x-small","small","medium","large","x-large","xx-large","larger","smaller",v],"font-size-adjust":["none",lu],"font-stretch":["normal","wider","narrower","ultra-condensed","extra-condensed","condensed","semi-condensed","semi-expanded","expanded","extra-expanded"],"font-style":["normal","italic","oblique"],"font-variant":["normal","small-caps"],"font-weight":["normal","bold","bolder","lighter",lu],height:[v,"auto"],left:[v,"auto"],"letter-spacing":["normal",v],"line-height":["normal",ko],"list-style":[!0,"list-style-image","list-style-position","list-style-type"],"list-style-image":["none",gi],"list-style-position":["inside","outside"],"list-style-type":["circle","disc","square","decimal","decimal-leading-zero","lower-roman","upper-roman","lower-greek","lower-alpha","lower-latin","upper-alpha","upper-latin","hebrew","katakana","hiragana-iroha","katakana-oroha","none"],margin:[4,dr],"margin-bottom":dr,"margin-left":dr,"margin-right":dr,"margin-top":dr,"marker-offset":[v,"auto"],"max-height":[v,"none"],"max-width":[v,"none"],"min-height":v,"min-width":v,opacity:lu,outline:[!0,"outline-color","outline-style","outline-width"],"outline-color":["invert",hi],"outline-style":["dashed","dotted","double","groove","inset","none","outset","ridge","solid"],"outline-width":er,overflow:iu,"overflow-x":iu,"overflow-y":iu,padding:[4,v],"padding-bottom":v,"padding-left":v,"padding-right":v,"padding-top":v,"page-break-after":wu,"page-break-before":wu,position:["absolute","fixed","relative","static"],quotes:[8,vf],right:[v,"auto"],"table-layout":["auto","fixed"],"text-align":["center","justify","left","right"],"text-decoration":["none","underline","overline","line-through","blink"],"text-indent":v,"text-shadow":["none",4,[hi,v]],"text-transform":["capitalize","uppercase","lowercase","none"],top:[v,"auto"],"unicode-bidi":["normal","embed","bidi-override"],"vertical-align":["baseline","bottom","sub","super","top","text-top","middle","text-bottom",v],visibility:["visible","hidden","collapse"],"white-space":["normal","nowrap","pre","pre-line","pre-wrap","inherit"],width:[v,"auto"],"word-spacing":["normal",v],"word-wrap":["break-word","normal"],"z-index":["auto",lu]},ni=function(o,s){var l,y,v;if(JAYLINT.comments=[],JAYLINT.errors=[],JAYLINT.tree="",yu=yi=pt=u=n=Object.create(kt["(begin)"]),ct={},ei(no),s){if(r=Object.create(s),y=r.predef,y)if(Array.isArray(y))for(l=0;l<y.length;l+=1)ct[y[l]]=!0;else typeof y=="object"&&ei(y);uf()}else r={};if(r.indent=+r.indent||0,r.maxerr=r.maxerr||50,yt="",or=sr=ci=!1,gr={},r.approved)for(l=0;l<r.approved.length;l+=1)gr[r.approved[l]]=r.approved[l];else gr.test="test";for(gu="",l=0;l<r.indent;l+=1)gu+=" ";lr=a={},bt=f={"(scope)":a,"(breakage)":0,"(loopage)":0},ru=[f],hr=!1,uu={},ar=!1,c=null,li=!1,yr=[],vi={},fu=!1,ui=null,ku=!0,du=!1,rt=null,pi=!1,pr=[],fi=null,nf=0,h="",vr.init(o),re();try{if(i(),n.id==="(number)")e("unexpected_a");else if(n.value.charAt(0)==="<")hs(),r.adsafe&&!ci&&t("adsafe_go",this);else switch(n.id){case"{":case"[":li=!0,lf();break;case"@":case"*":case"#":case".":case":":h="style",i(),u.id==="@"&&n.identifier&&n.value==="charset"&&u.line===1&&u.from===1||e("css"),i(),n.id!=="(string)"&&n.value!=="UTF-8"&&e("css"),i(),wt(),he();break;default:r.adsafe&&r.fragment&&e("expected_a_b",n,"<div>",n.value),ut(1),n.id!==";"||fu||wt(),sr=!0,v=di(),yu.first=v,JAYLINT.tree=yu,r.adsafe&&(v.length!==1||dt(v[0],"id","(")||dt(v[0].first,"id",".")||dt(v[0].first.first,"value","ADSAFE")||dt(v[0].first.second,"value","lib")||v[0].second.length!==2||v[0].second[0].id!=="(string)"||dt(v[0].second[1],"id","function"))&&e("adsafe_lib"),v.disrupt&&t("weird_program",pt)}c=null,i("(end)")}catch(p){p&&JAYLINT.errors.push({reason:p.message,line:p.line||n.line,character:p.character||n.from},null)}return JAYLINT.errors.length===0},ni.data=function(){var i={functions:[]},t,o,e,r,f,c=[],u,n,s=[],h=[];for(ni.errors.length&&(i.errors=ni.errors),li&&(i.json=!0),pr.length>0&&(i.urls=pr),o=Object.keys(lr).filter(function(n){return n.charAt(0)!=="("?n:undefined}),o.length>0&&(i.globals=o),e=1;e<ru.length;e+=1){for(n=ru[e],t={},r=0;r<cr.length;r+=1)t[cr[r]]=[];for(u in n)Object.prototype.hasOwnProperty.call(n,u)&&u.charAt(0)!=="("&&(f=n[u],(f==="unction"||f==="unparam")&&(f="unused"),Array.isArray(t[f])&&(t[f].push(u),f==="unused"?h.push({name:u,line:n["(line)"],"function":n["(name)"]}):f==="undef"&&s.push({name:u,line:n["(line)"],"function":n["(name)"]})));for(r=0;r<cr.length;r+=1)t[cr[r]].length===0&&delete t[cr[r]];t.name=n["(name)"],t.param=n["(params)"],t.line=n["(line)"],t["(complexity)"]=n["(complexity)"],i.functions.push(t)}h.length>0&&(i.unused=h),s.length>0&&(i.undef=s),c=[];for(u in vi)if(typeof vi[u]=="number"){i.member=vi;break}return i},ni.report=function(n){function f(n,t){var u,i;Array.isArray(t)?(r.push("<div><i>"+n+"<\/i> "),t=t.sort().forEach(function(n){n!==i&&(i=n,r.push((u?", ":"")+i),u=!0)}),r.push("<\/div>")):t&&r.push("<div><i>"+n+"<\/i> "+t+"<\/div>")}var t=ni.data(),b,l,i,a,v,e,p,y="",o,w,r=[],c,u,s;if(t.errors||t.unused||t.undef){if(b=!0,r.push("<div id=errors><i>Error:<\/i>"),t.errors)for(i=0;i<t.errors.length;i+=1)s=t.errors[i],s&&(l=s.evidence||"",r.push("<p>Problem"+(isFinite(s.line)?" at line "+s.line+" character "+s.character:"")+": "+s.reason.entityify()+"<\/p><p class=evidence>"+(l&&(l.length>80?l.slice(0,77)+"...":l).entityify())+"<\/p>"));if(t.undef){for(c=[],i=0;i<t.undef.length;i+=1)c[i]="<code><u>"+t.undef[i].name+"<\/u><\/code>&nbsp;<i>"+t.undef[i].line+" <\/i> <small>"+t.undef[i]["function"]+"<\/small>";r.push("<p><i>Undefined variable:<\/i> "+c.join(", ")+"<\/p>")}if(t.unused){for(c=[],i=0;i<t.unused.length;i+=1)c[i]="<code><u>"+t.unused[i].name+"<\/u><\/code>&nbsp;<i>"+t.unused[i].line+" <\/i> <small>"+t.unused[i]["function"]+"<\/small>";r.push("<p><i>Unused variable:<\/i> "+c.join(", ")+"<\/p>")}t.json&&r.push("<p>JSON: bad.<\/p>"),r.push("<\/div>")}if(!n){for(r.push("<br><div id=functions>"),t.urls&&f("URLs<br>",t.urls,"<br>"),h==="style"?r.push("<p>CSS.<\/p>"):t.json&&!b?r.push("<p>JSON: good.<\/p>"):t.globals?r.push("<div><i>Global<\/i> "+t.globals.sort().join(", ")+"<\/div>"):r.push("<div><i>No new global variables introduced.<\/i><\/div>"),i=0;i<t.functions.length;i+=1){if(u=t.functions[i],w=[],u.param)for(a=0;a<u.param.length;a+=1)w[a]=u.param[a].value;r.push("<br><div class=function><i>"+u.line+"<\/i> "+u.name.entityify()+"("+w.join(", ")+")<\/div>"),f("<big><b>Undefined<\/b><\/big>",u.undef),f("<big><b>Unused<\/b><\/big>",u.unused),f("Closure",u.closure),f("Variable",u["var"]),f("Exception",u.exception),f("Outer",u.outer),f("Global",u.global),f("Label",u.label),f("Complexity",u["(complexity)"])}if(t.member){if(e=Object.keys(t.member),e.length){for(e=e.sort(),y="<br><pre id=properties>/*properties ",p=13,i=0;i<e.length;i+=1)v=e[i],o=df.test(v)?v:"'"+v.entityify().replace(gf,ie)+"'",p+o.length>72&&(r.push(y+"<br>"),y="    ",p=1),p+=o.length+2,t.member[v]===1&&(o="<i>"+o+"<\/i>"),i<e.length-1&&(o+=", "),y+=o;r.push(y+"<br>*/<\/pre>")}r.push("<\/div>")}}return r.join("")},ni.jslint=ni,ni.edition="2012-05-01",ni}(),function(n,t){function r(n,t){if(this.kind=i.property,Object.defineProperty(this,"definedBy",{value:t,enumerable:!1,configurable:!1,writable:!1}),n){if(typeof n=="function"||typeof n.asFunction=="function")this.method=n,this.kind=i.method;else if(this.enumerable=!0,this.configurable=!0,typeof n=="number")this.value=n,this.dataType="integer";else if(typeof n=="string")this.value=n,this.dataType=typeof n;else for(var r in n)n.hasOwnProperty(r)&&(this[r]=n[r]);this.type!==undefined?this.dataType=this.dataType||this.type:this.type=this.dataType}}function f(){}function e(){this.classNames={}}function i(){}r.prototype.createPropertyDescriptor=function(n,t){var r=this,i={enumerable:this.enumerable==undefined?!0:this.enumerable,configurable:this.configurable==undefined?!0:this.configurable};return this.set&&this.get?(i.set=this.set,i.get=this.get):"value"in this||t?(i.value=t||this.value,i.writable=!0):(i.set=function(n){this.storeProperty(r,n)},i.get=function(){return this.retrieveProperty(r)}),i},r.prototype.createStorePropertyDescriptor=function(n){var t=this;return{enumerable:!1,writable:!0,configurable:t.configurable,value:n}},r.prototype.createGetMethod=function(){var n=this;return{enumerable:!1,writable:!1,configurable:!1,value:function(t){return this.getProperty(n,t)}}},r.prototype.createSetMethod=function(){var n=this;return{enumerable:!1,writable:!1,configurable:!1,value:function(t,i){return this.setProperty(n,t,i)}}},r.prototype.toJSON=function(){var t={},n;for(n in this)n!=="defineBy"&&n!=="storageModel"&&(t[n]=this[n]);return t},n.MemberDefinition=window.MemberDefinition=r;var u="$";f.prototype={clearCache:function(){this.arrayCache=undefined,this.pubMapPropsCache=undefined,this.keyPropsCache=undefined,this.propByTypeCache=undefined,this.pubMapMethodsCache=undefined,this.pubMapPropNamesCache=undefined},asArray:function(){if(!this.arrayCache){this.arrayCache=[];for(var n in this)n.indexOf(u)===0&&this.arrayCache.push(this[n])}return this.arrayCache},getPublicMappedProperties:function(){if(!this.pubMapPropsCache){this.pubMapPropsCache=[];for(var n in this)n.indexOf(u)===0&&this[n].kind=="property"&&!this[n].notMapped&&this[n].enumerable&&this.pubMapPropsCache.push(this[n])}return this.pubMapPropsCache},getPublicMappedPropertyNames:function(){if(!this.pubMapPropNamesCache){this.pubMapPropNamesCache=[];for(var n in this)n.indexOf(u)===0&&this[n].kind=="property"&&!this[n].notMapped&&this[n].enumerable&&this.pubMapPropNamesCache.push(this[n].name)}return this.pubMapPropNamesCache},getKeyProperties:function(){if(!this.keyPropsCache){this.keyPropsCache=[];for(var n in this)n.indexOf(u)===0&&this[n].kind=="property"&&this[n].key&&this.keyPropsCache.push(this[n])}return this.keyPropsCache},getPublicMappedMethods:function(){if(!this.pubMapMethodsCache){this.pubMapMethodsCache=[];for(var n in this)n.indexOf(u)===0&&this[n].kind=="method"&&this[n].method&&this.pubMapMethodsCache.push(this[n])}return this.pubMapMethodsCache},getPropertyByType:function(n){if(!this.propByTypeCache){this.propByTypeCache=[];for(var t in this)t.indexOf(u)===0&&this[t].dataType==n&&this.propByTypeCache.push(this[t])}return this.propByTypeCache},getMember:function(n){return this[u+n]},setMember:function(n){this[u+n.name]=n}},f.prototype.constructor=f,n.MemberDefinitionCollection=window.MemberDefinitionCollection=f,i.__enum=!0,i.method="method",i.property="property",i.navProperty="navProperty",i.complexProperty="complexProperty",i.field="field",n.MemberTypes=i,e.prototype={define:function(n,t,i,r,u){return this.defineEx(n,[{type:t}],i,r,u)},defineEx:function(t,i,r,u,f){var y,c,a,o,p,e,v;for(i.length==0?i.push({type:n.Base}):i.length>0&&!i[0].type&&(i[0].type=n.Base),e=0,y=i.length;e<y;e++)typeof i[e]=="function"&&(i[e]={type:i[e]});var w=u?u.constructor:undefined,s=t.split("."),l=s.splice(s.length-1,1)[0],h=window;for(e=0;e<s.length;e++)c=s[e],h[c]||(a={},a.__namespace=!0,h[c]=a),h=h[c];for(o=null,o=this.classFunctionBuilder(l,i,f,u),o.fullName=t,o.namespace=s.join("."),this.buildType(o,i,u,f),o.name=l,Container.registerType(t,o),typeof intellisense!="undefined"&&u&&u.constructor&&intellisense.annotate(o,u.constructor),h[l]=this.classNames[t]=o,p=o.baseTypes.length,e=0;e<p;e++)v=o.baseTypes[e],"inheritedTypeProcessor"in v&&v.inheritedTypeProcessor(o);return o},classFunctionBuilder:function(n,t,i,r){var u=this.bodyBuilder(t,i,r);return new Function("base","classDefinition","instanceDefinition","name","return function "+n+" (){ "+u+" \n}; ")(t,i,r,n)},bodyBuilder:function(t,i,r){for(var h="",e="",o="",u,s,f=0,c=t.length;f<c;f++)u=t[f],s=f,s==0?u&&u.type&&u.type!==n.Base&&u.type.fullName&&(e+="    var baseArguments = $data.typeSystem.createCtorParams(arguments, base["+s+"].params, this); \n",e+="    "+u.type.fullName+".apply(this, baseArguments); \n"):u&&u.type&&u.propagateTo?(o+="    "+(o?"":"var ")+"propagationArguments = $data.typeSystem.createCtorParams(arguments, base["+s+"].params, this); \n",o+='    this["'+u.propagateTo+'"] =  Object.create('+u.type.fullName+".prototype); \n    "+u.type.fullName+'.apply(this["'+u.propagateTo+'"], propagationArguments); \n'):u&&u.type&&u.type.memberDefinitions&&u.type.memberDefinitions.$constructor&&!u.propagateTo&&(h+="    "+u.type.fullName+".memberDefinitions.$constructor.method.apply(this); \n");return r&&r.constructor!=Object&&(e+="    instanceDefinition.constructor.apply(this, arguments); \n"),"\n    //mixins \n"+h+"\n    //construction \n"+e+"\n    //propagations \n"+o},buildType:function(n,t,i,r){var e=t[0].type,o,u,s;if(n.inheritsFrom=e,e){if(n.prototype=Object.create(e.prototype),n.memberDefinitions=Object.create(e.memberDefinitions||new f),n.memberDefinitions.clearCache(),o=e.staticDefinitions,o&&(o=o.asArray(),o))for(u=0;u<o.length;u++)this.buildMember(n,o[u],undefined,"staticDefinitions");for(n.baseTypes=e.baseTypes?[].concat(e.baseTypes):[],u=0;u<t.length;u++)n.baseTypes.push(t[u].type);n.isAssignableTo||Object.defineProperty(n,"isAssignableTo",{value:function(n){return this===n||this.baseTypes.indexOf(n)>=0},writable:!1,enumerable:!1,configurable:!1})}r&&(this.buildStaticMembers(n,r),r.constructor&&(n.classConstructor=r.constructor)),i&&this.buildInstanceMembers(n,i),s=[].concat(t),s.shift(),Object.keys(s).length>0&&this.buildInstanceMixins(n,s),n.__class=!0,n.prototype.constructor=n,Object.defineProperty(n.prototype,"getType",{value:function(){return n},writable:!1,enumerable:!1,configurable:!1})},addMethod:function(n,t,i,r){n[t]=r&&typeof intellisense=="undefined"?function(){return i.apply(this[r],arguments)}:i},addProperty:function(n,t,i,r){var u,f;r&&(i.configurable=!0,i.get&&(u=i.get,i.get=function(){return this[r]||Guard.raise(new Exception("not inicialized")),u.apply(this[r],arguments)}),i.set&&(f=i.set,i.set=function(){this[r]||Guard.raise(new Exception("not inicialized")),f.apply(this[r],arguments)})),Object.defineProperty(n,t,i)},addField:function(){Guard.raise("not implemented")},buildMethod:function(n,t,i){var r=t.classMember?n:n.prototype;this.addMethod(r,t.name,t.method,i)},buildProperty:function(n,t,i){var r=t.classMember?n:n.prototype,e=t.createPropertyDescriptor(n),u,f;this.addProperty(r,t.name,e,i),t.classMember||n.__setPropertyfunctions!=!0||(u=t.createGetMethod(),this.addProperty(r,"get_"+t.name,u,i),f=t.createSetMethod(),this.addProperty(r,"set_"+t.name,f,i))},buildMember:function(n,t,r,u){u=u||"memberDefinitions",n[u]=n[u]||new f,n[u].setMember(t);switch(t.kind){case i.method:this.buildMethod(n,t,r);break;case i.navProperty:case i.complexProperty:case i.property:this.buildProperty(n,t,r);break;default:Guard.raise("Unknown member type: "+t.kind+","+t.name)}},buildStaticMembers:function(n,t){var f=this,i,u;for(i in t)t.hasOwnProperty(i)&&(u=new r(t[i],n),u.name=i,u.classMember=!0,f.buildMember(n,u,undefined,"staticDefinitions"))},buildInstanceMembers:function(n,t){var f=this,i,u;for(i in t)t.hasOwnProperty(i)&&(u=new r(t[i],n),u.name=i,f.buildMember(n,u))},copyMembers:function(n,t){function i(n){typeof intellisense!="undefined"&&intellisense.logMessage(n)}Object.keys(n.prototype).forEach(function(r){r!=="constructor"&&r!=="toString"&&(i("copying item:"+r),t.prototype[r]=n[r])})},buildInstanceMixins:function(n,t){var r,i;for(n.mixins=n.mixins||[],n.propagations=n.propagations||[],r=0;r<t.length;r++)i=t[r],i.propagateTo?(this.buildInstancePropagation(n,i),n.propagations.push(i),n.propagations[i.type.name]=!0):(this.buildInstanceMixin(n,i),n.mixins.push(i),n.mixins[i.type.name]=!0)},buildInstanceMixin:function(n,t){for(var e=t.type.memberDefinitions.asArray(),f,r,i=0,u=e.length;i<u;i++)r=e[i].name,r==="constructor"||n.memberDefinitions.getMember(r)||this.buildMember(n,e[i]);if(t.type.staticDefinitions)for(f=t.type.staticDefinitions.asArray(),i=0,u=f.length;i<u;i++)r=f[i].name,r==="constructor"||n.memberDefinitions.getMember(r)||this.buildMember(n,f[i],undefined,"staticDefinitions")},buildInstancePropagation:function(n,t){for(var r=t.type.memberDefinitions.asArray(),u,i=0,f=r.length;i<f;i++)u=r[i].name,u==="constructor"||n.memberDefinitions.getMember(u)||this.buildMember(n,r[i],t.propagateTo)}},n.Class=Class=new e,function(t){function r(){var i={},f=[],t=[],u,r,e;this.classNames=i,this.consolidatedClassNames=f,this.classTypes=t,u=[],this.mappedTo=u,r=this,this.holder=null,e=function(n,t){var i=r.resolveType(n),u=Object.create(i.prototype);return i.apply(u,t),u},this.mapType=function(n,i){Guard.requireValue("aliasType",n),Guard.requireValue("realType",i);var r=this.getType(n),f=this.getType(i),e=t.indexOf(r),o=t.indexOf(f);u[e]=o},this.resolve=function(n,t){var i=this.resolveType(n,t);return new i(t)},this.resolveName=function(n){var i=this.resolveType(n),r=t.indexOf(i);return f[r]},this.isPrimitiveType=function(t){var i=this.resolveType(t);return i===Number||i===String||i===Date||i===String||i===Boolean||i===Array||i===Object||i===n.Number||i===n.Integer||i===n.Date||i===n.String||i===n.Boolean||i===n.Array||i===n.Object||i===n.Geography||i===n.Guid},this.resolveType=function(n){var i=n,r;return i=this.getType(i),r=t.indexOf(i),typeof u[r]=="undefined"?i:t[u[r]]},this.getTypes=function(){for(var u=Object.keys(i),f=[],r,n=0;n<u.length;n++)r=u[n],f.push({name:r,type:t[i[r]],toString:function(){return this.name}});return f},this.getTypeName=function(t){switch(typeof t){case"object":if(t==null)return"$data.Object";if(t instanceof Array)return"$data.Array";if(t.getType)return t.getType().fullName;if(t instanceof Date)return"$data.Date";if(t instanceof n.Geography)return"$data.Geography";if(t instanceof n.Guid)return"$data.Guid";default:return typeof t}},this.isTypeRegistered=function(n){return typeof n=="function"?t.indexOf(n)>-1:n in i},this.unregisterType=function(){Guard.raise("Unimplemented")},this.getType=function(n){return(Guard.requireValue("typeOrName",n),typeof n=="function")?n:(n in i||Guard.raise(new Exception("Unable to resolve type:"+n)),t[i[n]])},this.getName=function(n){var r=this.getType(n),i=t.indexOf(r);return i==-1&&Guard.raise("unknown type to request name for: "+n),f[i]},this.getDefault=function(t){var i=this.resolveType(t);switch(i){case n.Number:return 0;case n.Integer:return 0;case n.String:return null;case n.Boolean:return!1;default:return null}},this.registerType=function(n,u,o){var l,a,v,s,y,h,c,p;if(n){for(typeof u=="string"&&(u=r.resolveType(u)),typeof n=="string"&&(l=[],l.push(n),n=l),s=0;s<n.length;s++)a=n[s].split("."),h={},h.shortName=a[a.length-1],h.fullName=n[s],n[s]=h;for(v=function(){return e(u,arguments)},typeof intellisense!="undefined"&&intellisense.annotate(v,u),s=0,y=n.length;s<y;s++)h=n[s],"create"+h.shortName in r||(r["create"+h.shortName]=typeof o=="function"?o:v),c=t.indexOf(u),c==-1&&(c=t.push(u)-1,p=h.fullName,f[c]=h.fullName),i[h.fullName]=c;u.name||(u.name=n[0].shortName)}}}n.Number=typeof Number!="undefined"?Number:function(){},n.Integer=typeof Integer!="undefined"?Integer:function(){},n.Date=typeof Date!="undefined"?Date:function(){},n.String=typeof String!="undefined"?String:function(){},n.Boolean=typeof Boolean!="undefined"?Boolean:function(){},n.Blob=function(){},n.Array=typeof Array!="undefined"?Array:function(){},n.Object=typeof Object!="undefined"?Object:function(){},n.ObjectID=typeof ObjectID!="undefined"?ObjectID:function(){},n.Function=Function;var i;t.Container=n.Container=i=t.C$=new r,i.registerType(["$data.Number","number","float","real","decimal","JayNumber"],n.Number),i.registerType(["$data.Integer","int","integer","int16","int32","int64","JayInteger"],n.Integer),i.registerType(["$data.String","string","text","character","JayString"],n.String),i.registerType(["$data.Array","array","Array","[]","JayArray"],n.Array,function(){return n.Array.apply(undefined,arguments)}),i.registerType(["$data.Date","datetime","date","JayDate"],n.Date),i.registerType(["$data.Boolean","bool","boolean","JayBoolean"],n.Boolean),i.registerType(["$data.Blob","blob","JayBlob"],n.Blob),i.registerType(["$data.Object","Object","object","{}","JayObject"],n.Object),i.registerType(["$data.Function","Function","function"],n.Function),i.registerType(["$data.ObjectID","ObjectID","objectId","objectid","ID","Id","id","JayObjectID"],n.ObjectID)}(window),t.$C=function(){Class.define.apply(Class,arguments)},n.Class.define("$data.Base",function(){},null,{storeProperty:function(n,t){var i="_"+n.name;this[i]?this[i]=t:Object.defineProperty(this,i,n.createStorePropertyDescriptor(t))},retrieveProperty:function(n){var t="_"+n.name;return this[t]},setProperty:function(n,t,i){this[n.name]=t,i()},getProperty:function(n,t){t.apply(this,[this[n.name]])}},{extend:function(t,i,r){return n.Class.define(t,this,null,i,r)},getMemberDefinition:function(n){return this.memberDefinitions.getMember(n)},addProperty:function(t,i,u,f){var e=i,o=u,h,c,s;return typeof e=="string"&&(h=i,e=u,o=f),c={notMapped:!0,storeOnObject:!0,get:typeof e=="function"?e:function(){},set:typeof o=="function"?o:function(){},type:h},s=new r(c,this),s.name=t,n.Class.buildMember(this,s),this.memberDefinitions.clearCache(),this},addMember:function(t,i){var u=new r(i,this);return u.name=t,n.Class.buildMember(this,u),this.memberDefinitions.clearCache(),this}}),n.Class.ConstructorParameter=ConstructorParameter=n.Class.define("ConstructorParameter",null,null,{constructor:function(n){this.paramIndex=n},paramIndex:{}})}($data,window),$data.defaultErrorCallback=function(){arguments[arguments.length-1]&&typeof arguments[arguments.length-1].reject=="function"?arguments[arguments.length-1].reject.apply(arguments[arguments.length-1],arguments):arguments[0]instanceof Error?Guard.raise(arguments[0]):Guard.raise(new Exception("DEFAULT ERROR CALLBACK!","DefaultError",arguments))},$data.defaultSuccessCallback=function(){},$data.defaultNotifyCallback=function(){},$data.typeSystem={__namespace:!0,extend:function(n){var i,t;for(typeof n!="object"&&typeof n!="function"&&Guard.raise("Target must be object or function"),i=1;i<arguments.length;i++)if(t=arguments[i],t!==null&&typeof t!="undefined")for(key in t)n[key]=t[key];return n},createCallbackSetting:function(n,t){var i={success:$data.defaultSuccessCallback,error:$data.defaultErrorCallback,notify:$data.defaultNotifyCallback};return(t!=undefined&&t!=null&&(i=t),n==null||n==undefined)?i:typeof n=="function"?this.extend(i,{success:n}):this.extend(i,n)},createCtorParams:function(n,t,i){var u,f,e,r;if(t){for(u=[],f=0,e=t.length;f<e;f++)r=f,t[r]instanceof ConstructorParameter?u.push(n[t[r].paramIndex]):typeof t[r]=="function"?u.push(t[r].apply(i)):u.push(t[r]);return u}return n},writePropertyValues:function(n){n&&n.getType&&n.getType().memberDefinitions&&this.writeProperties(n,n.getType().memberDefinitions.asArray().filter(function(n){return(n.kind=="property"||n.kind=="navProperty"||n.kind=="complexProperty")&&!n.prototypeProperty}))},writeProperties:function(n,t){for(var u={},r,i=0,f=t.length;i<f;i++)r=t[i],u[r.name]=r.createPropertyDescriptor(null,r.value);Object.defineProperties(n,u)},writeProperty:function(n,t,i){var r=typeof t=="string"?n.getType().memberDefinitions.getMember(t):t,u;r&&(u=r.createPropertyDescriptor(null,i),Object.defineProperty(n,r.name,u))}},$data.debug=function(){console.log.apply(console,arguments)},$data.Class.define("$data.TraceBase",null,null,{log:function(){},warn:function(){},error:function(){}}),$data.Trace=new $data.TraceBase,$data.Class.define("$data.Logger",$data.TraceBase,null,{log:function(){Array.prototype.unshift.call(arguments,this.getDateFormat()),console.log.apply(console,arguments)},warn:function(){Array.prototype.unshift.call(arguments,this.getDateFormat()),console.warn.apply(console,arguments)},error:function(){Array.prototype.unshift.call(arguments,this.getDateFormat()),console.error.apply(console,arguments)},getDateFormat:function(){var n=new Date;return n.getHours()+":"+n.getMinutes()+":"+n.getSeconds()+"."+n.getMilliseconds()}}),$data.Geography=function(n,t){n&&typeof n=="object"&&Array.isArray(n.coordinates)?(this.longitude=n.coordinates[0],this.latitude=n.coordinates[1]):(this.longitude=n||0,this.latitude=t||0)},$data.Container.registerType(["$data.Geography","Geography","geography","geo"],$data.Geography),$data.Geography.prototype.toJSON=function(){return{type:"Point",coordinates:[this.longitude,this.latitude]}},$data.Guid=function(n){if(n===undefined||typeof n=="string"&&/^[a-zA-z0-9]{8}-[a-zA-z0-9]{4}-[a-zA-z0-9]{4}-[a-zA-z0-9]{4}-[a-zA-z0-9]{12}$/.test(n))this.value=n||"00000000-0000-0000-0000-000000000000";else throw Guard.raise(new Exception("TypeError: ","value not convertable to $data.Guid",n));},$data.Container.registerType(["$data.Guid","Guid","guid"],$data.Guid),$data.Guid.prototype.toJSON=function(){return this.value},$data.Guid.prototype.valueOf=function(){return this.value},$data.Guid.prototype.toString=function(){return this.value},$data.Guid.NewGuid=function(){return $data.createGuid()},$data.parseGuid=function(n){return new $data.Guid(n)},function(){var n="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".split("");$data.createGuid=function(t){var f;if(t)return new $data.Guid(t);var e,u=n,r=[],i,o=u.length;if(e)for(i=0;i<e;i++)r[i]=u[0|Math.random()*o];else for(r[8]=r[13]=r[18]=r[23]="-",r[14]="4",i=0;i<36;i++)r[i]||(f=0|Math.random()*16,r[i]=u[i==19?f&3|8:f]);return $data.parseGuid(r.join(""))}}(),function(n){function t(){}function i(){}function r(){}function u(){}function f(){}function e(){}function o(){}function s(){}function h(){}function c(){}function l(){}function a(){}function v(){}function y(){}function p(){}n.Container.registerType("Edm.Boolean",t),n.Container.mapType(t,n.Boolean),n.Container.registerType("Edm.Binary",i),n.Container.mapType(i,n.Blob),n.Container.registerType("Edm.DateTime",r),n.Container.mapType(r,n.Date),n.Container.registerType("Edm.DateTimeOffset",u),n.Container.mapType(u,n.Integer),n.Container.registerType("Edm.Time",f),n.Container.mapType(f,n.Integer),n.Container.registerType("Edm.Decimal",e),n.Container.mapType(e,n.String),n.Container.registerType("Edm.Single",o),n.Container.mapType(o,n.Number),n.Container.registerType("Edm.Double",s),n.Container.mapType(s,n.Number),n.Container.registerType("Edm.Guid",h),n.Container.mapType(h,n.Guid),n.Container.registerType("Edm.Int16",c),n.Container.mapType(c,n.Integer),n.Container.registerType("Edm.Int32",l),n.Container.mapType(l,n.Integer),n.Container.registerType("Edm.Int64",a),n.Container.mapType(a,n.Integer),n.Container.registerType("Edm.Byte",v),n.Container.mapType(v,n.Integer),n.Container.registerType("Edm.String",y),n.Container.mapType(y,n.String),n.Container.registerType("Edm.GeographyPoint",p),n.Container.mapType(p,n.Geography)}($data),$data.StringFunctions={startsWith:function(){var n,t;if(arguments.length==2)n=arguments[0],t=arguments[1];else if(arguments.length==1&&typeof this=="string")n=this,t=arguments[0];else return!1;return n.indexOf(t)===0},endsWith:function(){var t,n;if(arguments.length==2)t=arguments[0],n=arguments[1];else if(arguments.length==1&&typeof this=="string")t=this,n=arguments[0];else return!1;return t.slice(-n.length)===n},contains:function(){var n,t;if(arguments.length==2)n=arguments[0],t=arguments[1];else if(arguments.length==1&&typeof this=="string")n=this,t=arguments[0];else return!1;return n.indexOf(t)>=0}},$data.ASTNode=function(){},$data.FunctionASTNode=function(){},$data.FunctionASTNode.prototype=new $data.ASTNode,$data.ParameterASTNode=function(){},$data.MemberAccessASTNode=function(){},$data.MemberAccessASTNode.prototype=new $data.ASTNode,$data.ConstantASTNode=function(){},$data.ASTParserResult=function(n,t,i){this.success=t!="",this.result=n,this.tree=t,this.errors=i},$data.ASTParser=function(){},$data.ASTParser.parseCode=function(n){var t,i,r;return!n||(t=n.toString())===""?new $data.ASTParserResult(!1,null,null):(typeof JAYLINT=="undefined"&&Guard.raise(new Exception("JAYLINT is required","Not Found!")),i=JAYLINT(t),r=new $data.ASTParserResult(i,JAYLINT.tree,JAYLINT.errors),r)},$data.Class.define("$data.Expressions.ExpressionType",null,null,{},{Constant:"constant",Variable:"variable",MemberAccess:"memberAccess",Call:"call",Equal:"equal",NotEqual:"notEqual",EqualTyped:"equalTyped",NotEqualTyped:"notEqualTyped",GreaterThen:"greaterThan",LessThen:"lessThan",GreaterThenOrEqual:"greaterThanOrEqual",LessThenOrEqual:"lessThenOrEqual",Or:"or",OrBitwise:"orBitwise",And:"and",AndBitwise:"andBitwise",In:"in",Add:"add",Divide:"divide",Multiply:"multiply",Subtract:"subtract",Modulo:"modulo",ArrayIndex:"arrayIndex",New:"new",Positive:"positive",Negative:"negative",Increment:"increment",Decrement:"decrement",Not:"not",This:"this",LambdaParameterReference:"lambdaParameterReference",LambdaParameter:"lambdaParameter",Parameter:"parameter",ArrayLiteral:"arrayLiteral",ObjectLiteral:"objectLiteral",ObjectField:"objectField",Function:"Function",Unknown:"UNKNOWN",EntitySet:"EntitySet",ServiceOperation:"ServiceOperation",EntityField:"EntityField",EntityContext:"EntityContext",Entity:"Entity",Filter:"Filter",First:"First",Count:"Count",Single:"Single",Some:"Some",Every:"Every",ToArray:"ToArray",BatchDelete:"BatchDelete",ForEach:"ForEach",Projection:"Projection",EntityMember:"EntityMember",EntityFieldOperation:"EntityFieldOperation",FrameOperation:"FrameOperation",EntityBinary:"EntityBinary",Code:"Code",ParametricQuery:"ParametricQuery",MemberInfo:"MemberInfo",QueryParameter:"QueryParameter",ComplexEntityField:"ComplexEntityField",Take:"Take",Skip:"Skip",OrderBy:"OrderBy",OrderByDescending:"OrderByDescending",Include:"Include"}),$data.BinaryOperator=function(){},$data.binaryOperators=[{operator:"==",expressionType:$data.Expressions.ExpressionType.Equal,type:"boolean",implementation:function(n,t){return n==t}},{operator:"===",expressionType:$data.Expressions.ExpressionType.EqualTyped,type:"boolean",implementation:function(n,t){return n===t}},{operator:"!=",expressionType:$data.Expressions.ExpressionType.NotEqual,type:"boolean",implementation:function(n,t){return n!=t}},{operator:"!==",expressionType:$data.Expressions.ExpressionType.NotEqualTyped,type:"boolean",implementation:function(n,t){return n!==t}},{operator:">",expressionType:$data.Expressions.ExpressionType.GreaterThen,type:"boolean",implementation:function(n,t){return n>t}},{operator:">=",expressionType:$data.Expressions.ExpressionType.GreaterThenOrEqual,type:"boolean",implementation:function(n,t){return n>=t}},{operator:"<=",expressionType:$data.Expressions.ExpressionType.LessThenOrEqual,type:"boolean",implementation:function(n,t){return n<=t}},{operator:"<",expressionType:$data.Expressions.ExpressionType.LessThen,type:"boolean",implementation:function(n,t){return n<t}},{operator:"&&",expressionType:$data.Expressions.ExpressionType.And,type:"boolean",implementation:function(n,t){return n&&t}},{operator:"||",expressionType:$data.Expressions.ExpressionType.Or,type:"boolean",implementation:function(n,t){return n||t}},{operator:"&",expressionType:$data.Expressions.ExpressionType.AndBitwise,type:"number",implementation:function(n,t){return n&t}},{operator:"|",expressionType:$data.Expressions.ExpressionType.OrBitwise,type:"number",implementation:function(n,t){return n|t}},{operator:"+",expressionType:$data.Expressions.ExpressionType.Add,type:"number",implementation:function(n,t){return n+t}},{operator:"-",expressionType:$data.Expressions.ExpressionType.Subtract,type:"number",implementation:function(n,t){return n-t}},{operator:"/",expressionType:$data.Expressions.ExpressionType.Divide,type:"number",implementation:function(n,t){return n/t}},{operator:"%",expressionType:$data.Expressions.ExpressionType.Modulo,type:"number",implementation:function(n,t){return n%t}},{operator:"*",expressionType:$data.Expressions.ExpressionType.Multiply,type:"number",implementation:function(n,t){return n*t}},{operator:"[",expressionType:$data.Expressions.ExpressionType.ArrayIndex,type:"number",implementation:function(n,t){return n[t]}},{operator:"in",expressionType:$data.Expressions.ExpressionType.In,type:"boolean",implementation:function(n,t){return n in t}}],$data.binaryOperators.resolve=function(n){var t=$data.binaryOperators.filter(function(t){return t.operator==n});if(t.length>0)return n},$data.binaryOperators.contains=function(n){return $data.binaryOperators.some(function(t){return t.operator==n})},$data.binaryOperators.getOperator=function(n){var t=$data.binaryOperators.filter(function(t){return t.operator==n});return t.length<1&&Guard.raise("Unknown operator: "+n),t[0]},$data.unaryOperators=[{operator:"+",arity:"prefix",expressionType:$data.Expressions.ExpressionType.Positive,type:"number",implementation:function(n){return+n}},{operator:"-",arity:"prefix",expressionType:$data.Expressions.ExpressionType.Negative,type:"number",implementation:function(n){return-n}},{operator:"++",arity:"prefix",expressionType:$data.Expressions.ExpressionType.Increment,type:"number",implementation:function(n){return++n}},{operator:"--",arity:"prefix",expressionType:$data.Expressions.ExpressionType.Decrement,type:"number",implementation:function(n){return--n}},{operator:"++",arity:"suffix",expressionType:$data.Expressions.ExpressionType.Increment,type:"number",implementation:function(n){return n++}},{operator:"!",arity:"prefix",expressionType:$data.Expressions.ExpressionType.Not,type:"boolean",implementation:function(n){return!n}},{operator:"--",arity:"suffix",expressionType:$data.Expressions.ExpressionType.Decrement,type:"number",implementation:function(n){return n--}}],$data.unaryOperators.resolve=function(n){var t=$data.unaryOperators.filter(function(t){return t.operator==n});if(t.length>0)return n},$data.unaryOperators.contains=function(n){return $data.unaryOperators.some(function(t){return t.operator==n})},$data.unaryOperators.getOperator=function(n,t){var i=$data.unaryOperators.filter(function(i){return i.operator==n&&(!t||i.arity==t)});return i.length<1&&Guard.raise("Unknown operator: "+n),i[0]},$data.timeIt=function(n,t){t=t||1,console.time("!");for(var i=0;i<t;i++)n();console.timeEnd("!")},$data.Expressions.OperatorTypes={UNARY:"UNARY",INCDEC:"INCDEC",DECISION:"DECISION",METHODCALL:"METHODCALL",NEW:"NEW",JSONASSIGN:"JSONASSIGN",ARRAYACCESS:"ARRAYACCESS",UNKNOWN:"UNKNOWN"},$data.executable=!0,$C("$data.Expressions.ExpressionNode",null,null,{constructor:function(){this.expressionType=this.constructor},getJSON:function(){return jsonify(this)},expressionType:{set:function(n){typeof n=="string"&&(n=Container.resolveType(n)),this._expressionType=n},get:function(){return arguments.callee.caller==jsonify||arguments.callee.caller==JSON.stringify?Container.resolveName(this._expressionType):this._expressionType},enumerable:!0},nodeType:{value:$data.Expressions.ExpressionType.Unknown,writable:!1},type:{},isTerminated:{value:!1},toString:function(){return this.value}},null),$C("$data.Expressions.UnaryExpression",$data.Expressions.ExpressionNode,null,{constructor:function(n,t,i,r){this.operand=n,this.operator=t,this.nodeType=i,this.resolution=r},operator:{value:undefined,writable:!0},operand:{value:undefined,writable:!0},nodeType:{value:undefined,writable:!0}}),$C("$data.Expressions.ArrayLiteralExpression",$data.Expressions.ExpressionNode,null,{constructor:function(n){this.items=n||[]},nodeType:{value:$data.Expressions.ExpressionType.ArrayLiteral,writable:!0},items:{value:undefined,dataType:Array,elementType:$data.Expressions.ExpressionNode},toString:function(){return"["+this.items.map(function(n){return n.toString()}).join(",")+"]"}},null),$C("$data.Expressions.CallExpression",$data.Expressions.ExpressionNode,null,{constructor:function(n,t,i){this.expression=n,this.member=t,this.args=i},nodeType:{value:$data.Expressions.ExpressionType.Call},expression:{value:undefined,dataType:$data.Expressions.ExpressionNode,writable:!0},member:{value:undefined,dataType:$data.MemberDefinition,writable:!0},type:{value:undefined,writable:!0},implementation:{get:function(){return function(n,t,i){return typeof t!="function"&&(t=n[t]),Guard.requireType("method",t,Function),t.apply(n,i)}},set:function(){Guard.raise("Property can not be set")}},toString:function(){return this.object.toString()+"."+this.member.toString()+"()"}}),$C("$data.Expressions.CodeParser",null,null,{constructor:function(n){this.scopeContext=n,this.lambdaParams=[]},log:function(n){this.scopeContext&&this.scopeContext.log(n)},parseExpression:function(n){var r,t,i;return(typeof n=="object"&&(n=""),r={success:!0,errorMessage:"",errorDetails:""},t=$data.ASTParser.parseCode(n),this.log({event:"AST",data:t}),!t.success)?{success:!1,error:"ASTParser error",errorMessage:t.errors?JSON.stringify(t.errors):"could not get code"}:(i=this.Build2(t.tree.first[0]),{success:!0,expression:i,errors:t.errors})},createExpression:function(n,t){var i=this.parseExpression(n,t);return i.success||Guard.raise("ExpressionParserError: "+i.errorMessage),i.expression},Build2:function(n){var t;switch(n.arity){case"number":case"string":t=this.BuildConstant(n);break;case"prefix":switch(n.value){case"{":t=this.BuildObjectLiteral(n);break;case"[":t=this.BuildArrayLiteral(n);break;case $data.unaryOperators.resolve(n.value):t=this.BuildUnary(n)}break;case"suffix":switch(n.value){case $data.unaryOperators.resolve(n.value):t=this.BuildUnary(n);break;default:Guard.raise("Unknown suffix: "+n.value)}break;case"infix":switch(n.value){case"[":t=this.BuildArray(n);break;case $data.binaryOperators.resolve(n.value):t=this.BuildSimpleBinary(n);break;case"function":Guard.raise("Unexpected function arity");case"(":t=this.BuildCall(n);break;case".":t=this.BuildProperty(n)}break;case"statement":switch(n.value){case"function":t=this.BuildFunction(n)}break;default:switch(n.value){case"function":t=this.BuildFunction(n);break;case"true":case"false":case"null":t=this.BuildConstant(n);break;case"this":t=this.BuildThis(n);break;default:t=this.BuildParameter(n)}}return t},BuildThis:function(){return Container.createThisExpression()},BuildConstant:function(n){var t=n.value,i=n.type;if(n.reserved===!0)switch(n.value){case"true":t=!0,i="boolean";break;case"false":t=!1,i="boolean";break;case"null":t=null,i="object"}return new $data.Expressions.ConstantExpression(t,i)},BuildFunctionParameter:function(){},BuildArray:function(n){switch(n.second.type){case"string":return this.BuildProperty(n);case"number":default:return this.BuildSimpleBinary(n)}},BuildParameter:function(n){var r=n.value,t=n.funct?$data.Expressions.ExpressionType.LambdaParameter:this.lambdaParams.indexOf(n.value)>-1?$data.Expressions.ExpressionType.LambdaParameterReference:$data.Expressions.ExpressionType.Parameter,i=new $data.Expressions.ParameterExpression(n.value,null,t);return t==$data.Expressions.ExpressionType.LambdaParameterReference&&(i.paramIndex=this.lambdaParams.indexOf(n.value)),i},BuildArrayLiteral:function(n){var t=this,i=n.first.map(function(n){return t.Build2(n)});return new $data.Expressions.ArrayLiteralExpression(i)},BuildObjectLiteral:function(n){var t=this,i=n.first.map(function(n){var i=t.Build2(n.first);return new $data.Expressions.ObjectFieldExpression(n.value,i)});return new $data.Expressions.ObjectLiteralExpression(i)},BuildFunction:function(n){var f=this,t=n.first&&n.first.map(function(n){return this.lambdaParams.push(n.value),f.BuildParameter(n)},this),r,u,i;return t=t||[],r=n.block.length==0?!1:n.block[0].value==="return"?!0:!1,u=n.block.length>0?this.Build2(r?n.block[0].first:n.block[0]):null,[].forEach(function(){this.lambdaParams.pop()},this),i=new $data.Expressions.FunctionExpression(n.value,t,u),t.forEach(function(n){n.owningFunction=i}),i.name=n.name,i},BuildCall:function(n){var u=this,t=u.Build2(n.first),f=n.second.map(function(n){return u.Build2(n)}),i,r;switch(!0){case t instanceof $data.Expressions.PropertyExpression:r=t.expression,i=t.member;break;case t instanceof $data.Expressions.ParameterExpression:r=Container.createConstantExpression(null,"object"),i=t}return Container.createCallExpression(r,i,f)},BuildProperty:function(n){var i=this.Build2(n.first),t;return t=n.second.identifier?new $data.Expressions.ConstantExpression(n.second.value,"string"):this.Build2(n.second),new $data.Expressions.PropertyExpression(i,t)},BuildUnary:function(n){var t=$data.unaryOperators.getOperator(n.value,n.arity),i=t.expressionType,r=this.Build2(n.first);return new $data.Expressions.UnaryExpression(r,t,i)},BuildSimpleBinary:function(n){var t=$data.binaryOperators.getOperator(n.value),i=t.expressionType,r=this.Build2(n.first||n.left),u=this.Build2(n.second||n.right);return new $data.Expressions.SimpleBinaryExpression(r,u,i,n.value,t.type)}}),$C("$data.Expressions.ConstantExpression",$data.Expressions.ExpressionNode,null,{constructor:function(n,t,i){this.value=n,this.type=Container.getTypeName(n),this.name=i},nodeType:{value:$data.Expressions.ExpressionType.Constant,enumerable:!0},type:{value:Object,writable:!0},value:{value:undefined,writable:!0},toString:function(){return this.value.toString()}}),$C("$data.Expressions.FunctionExpression",$data.Expressions.ExpressionNode,null,{constructor:function(n,t,i){this.parameters=t||[],this.name=n,this.body=i},toString:function(n){var t=this.parameters.map(function(n){return n.toString()}),i;return t=t.join(","),i=this.body?this.body.toString(n):"","function "+this.name+"("+t+") { "+i+"}"},nodeType:{value:$data.Expressions.ExpressionType.Function,writable:!0},parameters:{value:undefined,dataType:Array,elementType:$data.Expressions.ParameterExpression},body:{value:undefined,dataType:$data.Expressions.ExpressionNode},type:{}},null),$C("$data.Expressions.ObjectFieldExpression",$data.Expressions.ExpressionNode,null,{constructor:function(n,t){this.fieldName=n,this.expression=t},nodeType:{value:$data.Expressions.ExpressionType.ObjectField,writable:!0},toString:function(){return"unimplemented"}},null),$C("$data.Expressions.ObjectLiteralExpression",$data.Expressions.ExpressionNode,null,{constructor:function(n){this.members=n},nodeType:{value:$data.Expressions.ExpressionType.ObjectLiteral,writable:!0},toString:function(){return"unimplemented"},implementation:{get:function(){return function(n){var t={};return n.forEach(function(n){t[n.name]=n.value}),t}},set:function(){}}},null),$C("$data.Expressions.PagingExpression",$data.Expressions.ExpressionNode,null,{constructor:function(n,t,i){this.source=n,this.amount=t,this.nodeType=i},nodeType:{value:$data.Expressions.ExpressionType.Unknown,writable:!0},toString:function(){return"unimplemented"}},null),$C("$data.Expressions.ParameterExpression",$data.Expressions.ExpressionNode,null,{constructor:function(n,t,i){this.nodeType=i||$data.Expressions.ExpressionType.Parameter,this.name=n,this.type=t||"unknown"},owningFunction:{value:undefined,enumerable:!1},nodeType:{value:$data.Expressions.ExpressionType.Parameter,writable:!0},name:{value:undefined,dataType:String,writable:!0},type:{value:undefined,dataType:"object",writable:!0},toString:function(n){var t;return(t=n?this.type+" ":"")+this.name}},null),$C("$data.Expressions.PropertyExpression",$data.Expressions.ExpressionNode,null,{constructor:function(n,t){this.expression=n,this.member=t,this.type=t.dataType},nodeType:{value:$data.Expressions.ExpressionType.MemberAccess},expression:{value:undefined,dataType:$data.Expressions.ExpressionNode,writable:!0},implementation:{get:function(){return function(n,t){return n[t]===undefined&&Guard.raise(new Exception("Parameter '"+t+"' not found in context","Property not found!")),n[t]}},set:function(){}},member:{value:undefined,dataType:$data.MemberDefinition,writable:!0},type:{value:undefined,writable:!0},toString:function(){return this.expression.toString()+"."+this.member.toString()}}),$C("$data.Expressions.SimpleBinaryExpression",$data.Expressions.ExpressionNode,null,{constructor:function(n,t,i,r,u,f){this.left=n,this.right=t,this.nodeType=i,this.operator=r,this.type=u,this.resolution=f},implementation:{get:function(){return $data.binaryOperators.getOperator(this.operator).implementation},set:function(){}},type:{value:"number",writable:!0}}),$C("$data.Expressions.ThisExpression",$data.Expressions.ExpressionNode,null,{nodeType:{value:$data.Expressions.ExpressionType.This}}),$C("$data.Expressions.ExpressionVisitor",null,null,{constructor:function(){this._deep=0},Visit:function(n,t){if(!n)return n;var i=null;switch(n.expressionType){case $data.Expressions.ParameterExpression:i=this.VisitParameter(n,t);break;case $data.Expressions.ConstantExpression:i=this.VisitConstant(n,t);break;case $data.Expressions.FunctionExpression:i=this.VisitFunction(n,t);break;case $data.Expressions.CallExpression:i=this.VisitCall(n,t);break;case $data.Expressions.SimpleBinaryExpression:i=this.VisitBinary(n,t);break;case $data.Expressions.PropertyExpression:i=this.VisitProperty(n,t);break;case $data.Expressions.ThisExpression:i=this.VisitThis(n,t);break;case $data.Expressions.ObjectLiteralExpression:i=this.VisitObjectLiteral(n,t);break;case $data.Expressions.ObjectFieldExpression:i=this.VisitObjectField(n,t);break;case $data.Expressions.ArrayLiteralExpression:i=this.VisitArrayLiteral(n,t);break;case $data.Expressions.UnaryExpression:i=this.VisitUnary(n,t)}return this._deep=this._deep-1,i},VisitArrayLiteral:function(n,t){var i=this,r=n.items.map(function(n){return i.Visit(n,t)});return Container.createArrayLiteralExpression(r)},VisitObjectLiteral:function(n,t){var i=this,r=n.members.map(function(n){return i.Visit(n,t)});return Container.createObjectLiteralExpression(r)},VisitObjectField:function(n,t){var i=this.Visit(n.expression,t);return Container.createObjectFieldExpression(n.fieldName,i)},VisitThis:function(n){return n},VisitCall:function(n,t){var f=this,i=n.args.map(function(n){return this.Visit(n,t)},this),r=this.Visit(n.expression,t),u=this.Visit(n.member,t);return new $data.Expressions.CallExpression(r,u,i)},VisitParameter:function(n){return n},VisitConstant:function(n){return n},VisitFunction:function(n,t){var i=this,r=n.parameters.map(function(n){return i.Visit(n,t)}),u=i.Visit(n.body,t);return new $data.Expressions.FunctionExpression(n.name,r,u)},VisitBinary:function(n,t){var i=this.Visit(n.left,t),r=this.Visit(n.right,t);return new $data.Expressions.SimpleBinaryExpression(i,r,n.nodeType,n.operator,n.type)},VisitProperty:function(n,t){var i=this.Visit(n.expression,t),r=this.Visit(n.member,t);return new $data.Expressions.PropertyExpression(i,r)},VisitUnary:function(n,t){var i=this.Visit(n.operand,t);return i===n.operand?n:new $data.Expressions.UnaryExpression(i,n.operator,n.nodeType)},VisitDecision:function(n,t){var i=this.Visit(n.expression,t),r=this.Visit(n.left,t),u=this.Visit(n.right,t);return i===n.expression&&r===n.left&&u===n.right?n:$data.Expressions.ExpressionNodeTypes.DecisionExpressionNode.create(n.executable,i,r,u)},VisitNew:function(n,t){var i=this.VisitArray(n.values,t);return i===n.values?n:$data.Expressions.ExpressionNodeTypes.NewExpressionNode.create(!0,i)},VisitArrayAccess:function(n,t){var i=this.Visit(n.array,t),r=this.Visit(n.index,t);return i===n.array&&r===n.index?n:$data.Expressions.ExpressionNodeTypes.ArrayAccessExpressionNode.create(!0,i,r)},VisitArray:function(n,t){for(var r=[],u=!0,i=0;i<n.length;i++)r[i]=this.Visit(n[i],t),u=u&&r[i]===n[i];return u?n:r},GetMemberChain:function(n,t){if(n.expression.type==MEMBERACCESS){var i=this.GetMemberChain(n.expression,t);return i.push(n.member),i}return[n.expression,n.member]}},{}),$C("$data.Expressions.ParameterProcessor",$data.Expressions.ExpressionVisitor,null,{constructor:function(){},Visit:function(n,t){if((n instanceof $data.Expressions.ParameterExpression||n instanceof $data.Expressions.ThisExpression)&&this.canResolve(n)){var i=this.resolve(n,t);return i!==n&&(i.resolvedBy=this.constructor.name),i}return n},canResolve:function(){Guard.raise("Pure method")},resolve:function(){Guard.raise("Pure method")}}),$C("$data.Expressions.GlobalContextProcessor",$data.Expressions.ParameterProcessor,null,{constructor:function(n){this.global=n},canResolve:function(n){return n.nodeType==$data.Expressions.ExpressionType.Parameter&&this.global&&typeof this.global=="object"&&n.name in this.global},resolve:function(n){var t=this.global[n.name];return Container.createConstantExpression(t,typeof t,n.name)}}),$C("$data.Expressions.ConstantValueResolver",$data.Expressions.ParameterProcessor,null,{constructor:function(n,t){this.globalResolver=Container.createGlobalContextProcessor(t),this.paramResolver=Container.createGlobalContextProcessor(n),this.paramsObject=n},canResolve:function(n){return n.nodeType==$data.Expressions.ExpressionType.This&&this.paramsObject?!0:this.paramResolver.canResolve(n)||this.globalResolver.canResolve(n)},resolve:function(n){return n.nodeType==$data.Expressions.ExpressionType.This?Container.createConstantExpression(this.paramsObject,typeof this.paramsObject,"this"):this.paramResolver.canResolve(n)?this.paramResolver.resolve(n):this.globalResolver.resolve(n)}}),$C("$data.Expressions.LocalContextProcessor",$data.Expressions.GlobalContextProcessor,null,{constructor:function(n){this.canResolve=function(t){return t.nodeType==$data.Expressions.ExpressionType.Parameter&&n("typeof "+t.name)!=="undefined"},this.resolve=function(t){var i=n(t.name);return Container.createConstantExpression(i,typeof i)}}}),$C("$data.Expressions.LambdaParameterProcessor",$data.Expressions.ParameterProcessor,null,{constructor:function(n){var t={};this.canResolve=function(i){var r,u;if(i.nodeType==$data.Expressions.ExpressionType.LambdaParameter){if(r=i.owningFunction.parameters,r.length==1&&i.name==r[0].name)return t[i.name]=n[0],!0;for(u=0;u<r.length;u++)if(r[u].name==i.name)return t[i.name]=n[u],!0;return!1}return!1},this.resolve=function(n){var r=t[n.name],i=Container.createParameterExpression(n.name,r,$data.Expressions.ExpressionType.LambdaParameter);return i.owningFunction=n.owningFunction,i}}}),$C("$data.Expressions.ParameterResolverVisitor",$data.Expressions.ExpressionVisitor,null,{constructor:function(){this.lambdaParamCache={}},Visit:function(n,t){return $data.Expressions.ExpressionVisitor.prototype.Visit.call(this,n,t)},VisitArrayLiteral:function(n,t){var r=this,i=n.items.map(function(n){return r.Visit(n,t)}),u=i.every(function(n){return n instanceof $data.Expressions.ConstantExpression});return u?(i=i.map(function(n){return n.value}),Container.createConstantExpression(i,"array")):Container.createArrayLiteralExpression(i)},VisitObjectLiteral:function(n,t){var u=this,i=n.members.map(function(n){return u.Visit(n,t)}),f=i.every(function(n){return n.expression instanceof $data.Expressions.ConstantExpression}),r;return f?(r=i.map(function(n){return{name:n.fieldName,value:n.expression.value}}),Container.createConstantExpression(n.implementation(r))):Container.createObjectLiteralExpression(i)},VisitThis:function(n,t){return t.Visit(n,t)},VisitParameter:function(n,t){var i,r;switch(n.nodeType){case $data.Expressions.ExpressionType.Parameter:case $data.Expressions.ExpressionType.LambdaParameter:return i=t.Visit(n,t),i.nodeType==$data.Expressions.ExpressionType.LambdaParameter&&(this.lambdaParamCache[i.name]=i),i;case $data.Expressions.ExpressionType.LambdaParameterReference:if(r=this.lambdaParamCache[n.name],r)return i=Container.createParameterExpression(n.name,r.type,$data.Expressions.ExpressionType.LambdaParameterReference),i.paramIndex=n.paramIndex,i;break;default:return n}return n},VisitConstant:function(n){return n},VisitFunction:function(n,t){var i=this,r=n.parameters.map(function(n){return i.Visit(n,t)}),u=i.Visit(n.body,t);return new $data.Expressions.FunctionExpression(n.name,r,u)},VisitBinary:function(n,t){var i=this.Visit(n.left,t),r=this.Visit(n.right,t),u=$data.Expressions,f;return i instanceof u.ConstantExpression&&r instanceof u.ConstantExpression?(f=n.implementation(i.value,r.value),Container.createConstantExpression(f)):new Container.createSimpleBinaryExpression(i,r,n.nodeType,n.operator,n.type)},VisitUnary:function(n,t){var i=this.Visit(n.operand,t),u=$data.Expressions,r;return i instanceof u.ConstantExpression?(r=n.operator.implementation(i.value),Container.createConstantExpression(r)):new Container.createUnaryExpression(i,n.operator,n.nodeType)},VisitProperty:function(n,t){var i=this.Visit(n.expression,t),r=this.Visit(n.member,t),u;return i instanceof $data.Expressions.ConstantExpression&&r instanceof $data.Expressions.ConstantExpression?(u=n.implementation(i.value,r.value),Container.createConstantExpression(u,typeof u,i.name+"$"+r.value)):i===n.expression&&r===n.member?n:Container.createPropertyExpression(i,r)},VisitCall:function(n){function o(n,t,i){return t instanceof $data.Expressions.ConstantExpression&&(!i||i instanceof $data.Expressions.ConstantExpression)&&n.every(function(n){return n instanceof $data.Expressions.ConstantExpression})}var i=$data.Expressions.ExpressionVisitor.prototype.VisitCall.apply(this,arguments),r=i.expression,u=i.member,f=i.args,t,e;return o(f,u,r)?(t=u.value,typeof t=="string"&&r.value&&(t=r.value[t]),typeof t!="function"&&Guard.raise("Constant expression is not a method..."),e=n.implementation(r.value,t,f),new $data.Expressions.ConstantExpression(e)):i}},{}),$C("$data.Expressions.AggregatedVisitor",$data.Expressions.ExpressionVisitor,null,{constructor:function(n){this.Visit=function(t,i){for(var u,r=0;r<n.length;r++)if(u=n[r].Visit(t,i),u!==t)return u;return t}}}),$C("$data.Expressions.LogicalSchemaBinderVisitor",$data.Expressions.ExpressionVisitor,null,{constructor:function(){},VisitProperty:function(n,t){var r=this.Visit(n.expression,t),i=this.Visit(n.member,t),u=r.type,f=t.memberResolver.resolve(u,i.value);return i.type=f,Container.createPropertyExpression(r,i)}},{}),$data.Class.define("$data.Expressions.ExpTreeVisitor",null,null,{constructor:function(){this._deep=0},Visit:function(n,t){this._deep=this._deep+1;var i=null;switch(n.type){case LITERAL:i=this.VisitLiteral(n,t);break;case VARIABLE:i=this.VisitVariable(n,t);break;case MEMBERACCESS:i=this.VisitMember(n,t);break;case BINARY:i=this.VisitBinary(n,t);break;case UNARY:i=this.VisitUnary(n,t);break;case INCDEC:i=this.VisitIncDec(n,t);break;case EQUALITY:i=this.VisitEquality(n,t);break;case DECISION:i=this.VisitDecision(n,t);break;case METHODCALL:i=this.VisitMethodCall(n,t);break;case NEW:i=this.VisitNew(n,t);break;case JSONASSIGN:i=this.VisitJsonAssign(n,t);break;case ARRAYACCESS:i=this.VisitArrayAccess(n,t);break;default:Guard.raise("Type isn't implemented: "+n.type)}return this._deep=this._deep-1,i},VisitLiteral:function(n){return n},VisitVariable:function(n){return n},VisitMember:function(n,t){var i=this.Visit(n.expression,t),r=this.Visit(n.member,t);return i===n.expression&&r===n.member?n:$data.Expressions.ExpressionNodeTypes.MemberAccessExpressionNode.create(n.executable,i,r)},VisitBinary:function(n,t){var i=this.Visit(n.left,t),r=this.Visit(n.right,t);return i===n.left&&r===n.right?n:$data.Expressions.ExpressionNodeTypes.BinaryExpressionNode.create(n.executable,n.operator,i,r)},VisitUnary:function(n,t){var i=this.Visit(n.operand,t);return i===n.operand?n:$data.Expressions.ExpressionNodeTypes.UnaryExpressionNode.create(n.executable,n.operator,i)},VisitIncDec:function(n,t){var i=this.Visit(n.operand,t);return i===n.operand?n:$data.Expressions.ExpressionNodeTypes.IncDecExpressionNode.create(n.executable,n.operator,i,n.suffix)},VisitEquality:function(n,t){var i=this.Visit(n.left,t),r=this.Visit(n.right,t);return i===n.left&&r===n.right?n:$data.Expressions.ExpressionNodeTypes.EqualityExpressionNode.create(n.executable,n.operator,i,r)},VisitDecision:function(n,t){var i=this.Visit(n.expression,t),r=this.Visit(n.left,t),u=this.Visit(n.right,t);return i===n.expression&&r===n.left&&u===n.right?n:$data.Expressions.ExpressionNodeTypes.DecisionExpressionNode.create(n.executable,i,r,u)},VisitMethodCall:function(n,t){var i=n.object?this.Visit(n.object,t):null,r=this.VisitArray(n.args,t);return i===n.object&&r===n.args?n:$data.Expressions.ExpressionNodeTypes.MethodcallExpressionNode.create(n.executable,i,n.method,r)},VisitNew:function(n,t){var i=this.VisitArray(n.values,t);return i===n.values?n:$data.Expressions.ExpressionNodeTypes.NewExpressionNode.create(!0,i)},VisitJsonAssign:function(n,t){var i=this.Visit(n.left,t),r=this.Visit(n.right,t);return i===n.left&&r===n.right?n:(i.JSONASSIGN=!0,r.JSONASSIGN=!0,$data.Expressions.ExpressionNodeTypes.JsonAssignExpressionNode.create(!0,i,r))},VisitArrayAccess:function(n,t){var i=this.Visit(n.array,t),r=this.Visit(n.index,t);return i===n.array&&r===n.index?n:$data.Expressions.ExpressionNodeTypes.ArrayAccessExpressionNode.create(!0,i,r)},VisitArray:function(n,t){for(var r=[],u=!0,i=0;i<n.length;i++)r[i]=this.Visit(n[i],t),u=u&&r[i]===n[i];return u?n:r},GetMemberChain:function(n,t){if(n.expression.type==MEMBERACCESS){var i=this.GetMemberChain(n.expression,t);return i.push(n.member),i}return[n.expression,n.member]}},{}),$data.Class.define("$data.Expressions.SetExecutableVisitor",$data.Expressions.ExpTreeVisitor,null,{Visit:function(n,t){switch(n.type){case LITERAL:return this.VisitLiteral(n,t);case VARIABLE:return this.VisitVariable(n,t);case MEMBERACCESS:return this.VisitMember(n,t);case BINARY:return this.VisitBinary(n,t);case UNARY:return this.VisitUnary(n,t);case INCDEC:return this.VisitIncDec(n,t);case EQUALITY:return this.VisitEquality(n,t);case DECISION:return this.VisitDecision(n,t);case METHODCALL:return this.VisitMethodCall(n,t);case NEW:return this.VisitNew(n,t);case JSONASSIGN:return this.VisitJsonAssign(n,t);case ARRAYACCESS:return this.VisitArrayAccess(n,t);default:Guard.raise("Type isn't implemented: "+n.type)}},VisitBinary:function(n,t){var i=this.Visit(n.left,t),r=this.Visit(n.right,t);return i===n.left&&r===n.right&&i.executable&&r.executable==n.executable?n:$data.Expressions.ExpressionNodeTypes.BinaryExpressionNode.create(i.executable&&r.executable,n.operator,i,r)},VisitUnary:function(n,t){var i=this.Visit(n.operand,t);return i===n.operand?n:$data.Expressions.ExpressionNodeTypes.UnaryExpressionNode.create(i.executable,n.operator,i)},VisitIncDec:function(n,t){var i=this.Visit(n.operand,t);return i===n.operand?n:$data.Expressions.ExpressionNodeTypes.IncDecExpressionNode.create(i.executable,n.operator,i,n.suffix)},VisitEquality:function(n,t){var i=this.Visit(n.left,t),r=this.Visit(n.right,t);return i===n.left&&r===n.right&&i.executable&&r.executable==n.executable?n:$data.Expressions.ExpressionNodeTypes.EqualityExpressionNode.create(i.executable&&r.executable,n.operator,i,r)},VisitDecision:function(n,t){var i=this.Visit(n.expression,t),r=this.Visit(n.left,t),u=this.Visit(n.right,t);return i===n.expression&&r===n.left&&u===n.right&&r.executable&&u.executable&&i.executable==n.executable?n:$data.Expressions.ExpressionNodeTypes.DecisionExpressionNode.create(r.executable&&u.executable&&i.executable,i,r,u)},VisitMethodCall:function(n,t){var i=n.object?this.Visit(n.object,t):null,r=this.VisitArray(n.args,t);return i===n.object&&r===n.args&&(i==null?!0:i.executable)==n.executable?n:$data.Expressions.ExpressionNodeTypes.MethodcallExpressionNode.create(i==null?!0:i.executable,i,n.method,r)},VisitNew:function(n,t){var i=this.VisitArray(n.values,t);return i===n.values?n:$data.Expressions.ExpressionNodeTypes.NewExpressionNode.create(!0,i)},VisitJsonAssign:function(n,t){var i=this.Visit(n.left,t),r=this.Visit(n.right,t);return i===n.left&&r===n.right?n:(i.JSONASSIGN=!0,r.JSONASSIGN=!0,$data.Expressions.ExpressionNodeTypes.JsonAssignExpressionNode.create(!0,i,r))},VisitArrayAccess:function(n,t){var i=this.Visit(n.array,t),r=this.Visit(n.index,t);return i===n.array&&r===n.index?n:$data.Expressions.ExpressionNodeTypes.ArrayAccessExpressionNode.create(!0,i,r)},VisitArray:function(n,t){for(var r=[],u=!0,i=0;i<n.length;i++)r[i]=this.Visit(n[i],t),u=u&&r[i]===n[i];return u?n:r},VisitLiteral:function(n){return{type:n.type,executable:!0,value:n.value,valueType:n.valueType}},VisitVariable:function(n,t){return typeof t.paramContext[n.name]==undefined&&Guard.raise("Variable is not defined in the paramContext: "+n.name),$data.Expressions.ExpressionNodeTypes.VariableExpressionNode.create(!0,"Math","GLOBALOBJECT")},VisitMember:function(n,t){var u=this.GetMemberChain(n),i=u[0].name,f=t.lambdaParams.indexOf(i)>=0,r=i==t.paramsName;return r||f||Guard.raise("Variable is not defined in the paramContext or the lambda parameters: "+i),$data.Expressions.ExpressionNodeTypes.MemberAccessExpressionNode.create(r,n.expression,n.member)}},null),$data.Class.define("$data.Expressions.ExecutorVisitor",$data.Expressions.ExpTreeVisitor,null,{VisitVariable:function(n,t){if(!n.executable)return n;var i=n.name==t.paramsName?t.paramContext:window[n.name];return typeof i=="undefined"&&Guard.raise(new Exception("Unknown variable in '"+t.operation+"' operation. The variable isn't referenced in the parameter context and it's not a global variable: '"+n.name+"'.","InvalidOperation",{operationName:t.operation,missingParameterName:n.name})),$data.Expressions.ExpressionNodeTypes.LiteralExpressionNode.create(!0,typeof i,i)},VisitMember:function(n,t){var u,r,i;if(!n.executable)return n;for(u=this.GetMemberChain(n),i=0;i<u.length;i++)r=i==0?t.paramContext:r[u[i].name];return $data.Expressions.ExpressionNodeTypes.LiteralExpressionNode.create(!0,typeof r,r)},VisitUnary:function(eNode,context){var operand=this.Visit(eNode.operand,context),value,src,operandValue;return(operand!==eNode.operand&&(eNode=$data.Expressions.ExpressionNodeTypes.UnaryExpressionNode.create(eNode.executable,eNode.operator,operand)),!eNode.executable)?eNode:(operandValue=operand.valueType=="string"?"'"+operand.value+"'":operand.value,src="value = "+eNode.operator+" "+operandValue,eval(src),$data.Expressions.ExpressionNodeTypes.LiteralExpressionNode.create(!0,typeof value,value))},VisitIncDec:function(n,t){var i=this.Visit(n.operand,t),r;return(i!==n.operand&&(n=$data.Expressions.ExpressionNodeTypes.IncDecExpressionNode.create(n.executable,n.operator,i,n.suffix)),!n.executable)?n:(r=n.suffix?n.operator=="++"?i.value++:i.value--:n.operator=="++"?++i.value:--i.value,$data.Expressions.ExpressionNodeTypes.LiteralExpressionNode.create(!0,typeof r,r))},VisitBinary:function(eNode,context){var left=this.Visit(eNode.left,context),right=this.Visit(eNode.right,context),value,src,leftValue,rightValue;return((left!==eNode.left||right!==eNode.right)&&(eNode=$data.Expressions.ExpressionNodeTypes.BinaryExpressionNode.create(eNode.executable,eNode.operator,left,right)),!eNode.executable)?eNode:(leftValue=left.valueType=="string"?"'"+left.value+"'":left.value,rightValue=right.valueType=="string"?"'"+right.value+"'":right.value,src="value = "+leftValue+" "+eNode.operator+" "+rightValue,eval(src),$data.Expressions.ExpressionNodeTypes.LiteralExpressionNode.create(!0,typeof value,value))},VisitEquality:function(eNode,context){var left=this.Visit(eNode.left,context),right=this.Visit(eNode.right,context),value,src,leftValue,rightValue;return((left!==eNode.left||right!==eNode.right)&&(eNode=$data.Expressions.ExpressionNodeTypes.EqualityExpressionNode.create(eNode.executable,eNode.operator,left,right)),!eNode.executable)?eNode:(leftValue=left.valueType=="string"?"'"+left.value+"'":left.value,rightValue=right.valueType=="string"?"'"+right.value+"'":right.value,src="value = "+leftValue+" "+eNode.operator+" "+rightValue,eval(src),$data.Expressions.ExpressionNodeTypes.LiteralExpressionNode.create(!0,typeof value,value))},VisitDecision:function(n,t){var i=this.Visit(n.expression,t),r=this.Visit(n.left,t),u=this.Visit(n.right,t),f;return((i!==n.expression||r!==n.left||u!==n.right)&&(n=$data.Expressions.ExpressionNodeTypes.DecisionExpressionNode.create(n.executable,i,r,u)),!n.executable)?n:(f=i.value?r.value:u.value,$data.Expressions.ExpressionNodeTypes.LiteralExpressionNode.create(!0,typeof f,f))},VisitMethodCall:function(eNode,context){var object=eNode.object?this.Visit(eNode.object,context):null,args=this.VisitArray(eNode.args,context),a,i,arg,t,value,src;if((object!==eNode.object||args!=eNode.args)&&(eNode=$data.Expressions.ExpressionNodeTypes.MethodcallExpressionNode.create(eNode.executable,object,eNode.method,args)),!eNode.executable)return eNode;for(a=[],i=0;i<args.length;i++)arg=args[i],t=typeof arg.value,a.push(t=="string"?"'"+arg.value+"'":arg.value);return src=object?"value = object.value[eNode.method]("+a.join(",")+");":"value = "+eNode.method+"("+a.join(",")+");",eval(src),$data.Expressions.ExpressionNodeTypes.LiteralExpressionNode.create(!0,typeof value,value)},VisitArrayAccess:function(n,t){var r=this.Visit(n.array,t),u=this.Visit(n.index,t),i=r.value[u.value];return $data.Expressions.ExpressionNodeTypes.LiteralExpressionNode.create(!0,typeof i,i)}},null),$data.Class.define("$data.Expressions.ExpressionBuilder",null,null,{constructor:function(n){this.context=n},_isLambdaParam:function(n){for(var i=this.context.lambdaParams,t=0;t<i.length;t++)if(i[t]==n)return!0;return!1},_isParam:function(n){return this.context.paramContext[n]!=undefined},_isParamRoot:function(n){return this.context.paramsName==n},Build:function(n,t){var i;switch(n.arity){case"infix":"("==n.value?i=this.BuildMethodCall(n,t):"."==n.value?i=this.BuildMember(n,t):["===","==","!==","!=",">","<",">=","<="].indexOf(n.value)>=0?i=this.BuildEquality(n,t):["&&","||"].indexOf(n.value)>=0?i=this.BuildBinary(n,t):["+","-","*","/","%"].indexOf(n.value)>=0?i=this.BuildBinary(n,t):"["==n.value?i=this.BuildArrayAccess(n,t):Guard.raise("Value of infix node isn't implemented: "+n.value);break;case"prefix":["+","-","!"].indexOf(n.value)>=0?i=this.BuildUnary(n,t):["++","--"].indexOf(n.value)>=0?i=this.BuildIncDec(n,t):"{"==n.value?i=this.BuildNewExpression(n,t):Guard.raise("Value of prefix node isn't implemented: "+n.value);break;case"suffix":["++","--"].indexOf(n.value)>=0?i=this.BuildIncDec(n,t):Guard.raise("Value of suffix node isn't implemented: "+n.value);break;case"string":case"number":i=this.BuildLiteral(n,t);break;case"ternary":n.value=="?"?i=this.BuildDecision(n,t):Guard.raise("Value of ternary node isn't implemented: "+n.value);break;case null:case undefined:i=n.type=="boolean"&&(n.value=="true"||n.value=="false")?this.BuildBoolLiteral(n,t):this.BuildVariable(n,t);break;default:Guard.raise("Arity isn't implemented: "+n.arity)}return i},BuildNewExpression:function(n){for(var i=$data.Expressions.ExpressionNodeTypes.NewExpressionNode.create(!0,[]),r=n.first,t=0;t<r.length;t++)i.values.push(this.Build(r[t],i));return i},BuildLiteral:function(n){return $data.Expressions.ExpressionNodeTypes.LiteralExpressionNode.create(!0,n.arity,n.value)},BuildBoolLiteral:function(n){return $data.Expressions.ExpressionNodeTypes.LiteralExpressionNode.create(!0,n.type,n.value=="true"?!0:!1)},BuildVariable:function(n,t){var i;if(!n.first)return t.type==MEMBERACCESS?i=this._isLambdaParam(n.value)?"LAMBDAPARAM":this._isParamRoot(n.value)?"PARAMETERROOT":this._isParam(n.value)?"PARAMETER":"PROPERTY":this._isLambdaParam(n.value)?i="LAMBDAPARAM":this._isParamRoot(n.value)?i="PARAMETERROOT":this._isParam(n.value)?i="PARAMETER":window[n.value]!=undefined?i="GLOBALOBJECT":Guard.raise(new Exception("Unknown variable in '"+this.context.operation+"' operation. The variable isn't referenced in the parameter context and it's not a global variable: '"+n.value+"'.","InvalidOperation",{operationName:this.context.operation,missingParameterName:n.value})),$data.Expressions.ExpressionNodeTypes.VariableExpressionNode.create(!0,n.value,i);var u=$data.Expressions.ExpressionNodeTypes.LiteralExpressionNode.create(!0,"name",n.value),r=$data.Expressions.ExpressionNodeTypes.JsonAssignExpressionNode.create(!0),f=this.Build(n.first,r);return r.left=u,r.right=f,u.JSONASSIGN=!0,f.JSONASSIGN=!0,r},BuildMember:function(n){if(n.value!="."||n.arity!="infix")return n.type=="string"?$data.Expressions.ExpressionNodeTypes.LiteralExpressionNode.create(!0,n.arity,n.value):$data.Expressions.ExpressionNodeTypes.MemberAccessExpressionNode.create(!0,null,n.value);var t=$data.Expressions.ExpressionNodeTypes.MemberAccessExpressionNode.create(!0),i=this.Build(n.first,t),r=this.Build(n.second,t);return t.expression=i,t.member=r,t},BuildUnary:function(n){var t=$data.Expressions.ExpressionNodeTypes.UnaryExpressionNode.create(!0,n.value);return t.operand=this.Build(n.first,t),t},BuildIncDec:function(n){var t=$data.Expressions.ExpressionNodeTypes.IncDecExpressionNode.create(!0,n.value,null,n.arity=="suffix");return t.operand=this.Build(n.first,t),t},BuildBinary:function(n){n.first||Guard.raise("Cannot build binary: node.first is null"),n.second||Guard.raise("Cannot build binary: node.second is null");var t=$data.Expressions.ExpressionNodeTypes.BinaryExpressionNode.create(!0,n.value);return t.left=this.Build(n.first,t),t.right=this.Build(n.second,t),t},BuildEquality:function(n){var t=$data.Expressions.ExpressionNodeTypes.EqualityExpressionNode.create(!0,n.value);return t.left=this.Build(n.first,t),t.right=this.Build(n.second,t),t},BuildDecision:function(n){var t=$data.Expressions.ExpressionNodeTypes.DecisionExpressionNode.create(!0);return t.expression=this.Build(n.first,t),t.left=this.Build(n.second,t),t.right=this.Build(n.third,t),t},BuildMethodCall:function(n){var t=$data.Expressions.ExpressionNodeTypes.MethodcallExpressionNode.create(!0),r,u,i,f;for(n.first.type=="function"?(t.object=this.Build(n.first.first,t),t.method=n.first.second.value):(n.first.type!=null&&Guard.raise("Cannot build MethodCall because type is "+type),t.object=null,t.method=n.first.value),r=n.second,u=[],i=0;i<r.length;i++)f=r[i],u[i]=this.Build(f,t);return t.args=u,t},BuildArrayAccess:function(n){var t=$data.Expressions.ExpressionNodeTypes.ArrayAccessExpressionNode.create(!0);return t.array=this.Build(n.first,t),t.index=this.Build(n.second,t),t}},null),$C("$data.Expressions.AssociationInfoExpression",$data.Expressions.ExpressionNode,null,{constructor:function(n){this.associationInfo=n},nodeType:{value:$data.Expressions.ExpressionType.AssociationInfo,enumerable:!0}}),$C("$data.Expressions.CodeExpression",$data.Expressions.ExpressionNode,null,{constructor:function(n,t){Container.resolveType(Container.getTypeName(n))==$data.String&&n.replace(/^[\s\xA0]+/,"").match("^function")!="function"&&(n="function (it) { return "+n+"; }"),this.source=n,this.parameters=t},nodeType:{value:$data.Expressions.ExpressionType.Code,enumerable:!0}}),$C("$data.Expressions.CodeToEntityConverter",$data.Expressions.ExpressionVisitor,null,{constructor:function(n){this.scopeContext=n,this.parameters=[]},VisitBinary:function(n,t){var i=this.Visit(n.left,t),r=this.Visit(n.right,t),u=this.scopeContext.resolveBinaryOperator(n.nodeType,n,t.frameType);return Container.createSimpleBinaryExpression(i,r,n.nodeType,n.operator,n.type,u)},VisitUnary:function(n,t){var i=this.Visit(n.operand,t),r=this.scopeContext.resolveUnaryOperator(n.nodeType,n,t.frameType);return Container.createUnaryExpression(i,n.operator,n.nodeType,r)},VisitParameter:function(n,t){var i;Guard.requireValue("context",t),i=$data.Expressions.ExpressionType;switch(n.nodeType){case i.LambdaParameterReference:return Container.createEntityExpression(t.lambdaParameters[n.paramIndex],{lambda:n.name});case i.LambdaParameter:break;default:Guard.raise("Global parameter "+n.name+" not found. For query parameters use 'this.field' notation")}},VisitThis:function(n,t){var i=this.parameters.push({name:"",value:undefined})-1;return Container.createQueryParameterExpression("",i,t.queryParameters,undefined)},VisitFunction:function(){var n=$data.Expressions.ExpressionVisitor.prototype.VisitFunction.apply(this,arguments);return n.body},VisitCall:function(n,t){var s=this,i=this.Visit(n.expression,t),r=this.Visit(n.member,t),f=n.args.map(function(n){return s.Visit(n,t)}),e,o,u;switch(!0){case i instanceof $data.Expressions.QueryParameterExpression:return o=f.map(function(n){return n.value}),e=n.implementation(i.value,r.value,o),Container.createQueryParameterExpression(i.name+"$"+r.value,i.index,e,typeof e);case i instanceof $data.Expressions.EntityFieldExpression:case i instanceof $data.Expressions.EntityFieldOperationExpression:return(u=this.scopeContext.resolveFieldOperation(r.value,i,t.frameType))||Guard.raise("Unknown entity field operation: "+r.getJSON()),r=Container.createMemberInfoExpression(u),Container.createEntityFieldOperationExpression(i,r,f);case i instanceof $data.Expressions.EntitySetExpression:return(u=this.scopeContext.resolveSetOperations(r.value,i,t.frameType))||Guard.raise("Unknown entity field operation: "+r.getJSON()),r=Container.createMemberInfoExpression(u),Container.createFrameOperationExpression(i,r,f);default:Guard.raise("VisitCall: Only fields can have operations: "+n.getType().name)}},VisitProperty:function(n,t){var i=this.Visit(n.expression,t),r=this.Visit(n.member,t),u,l,f,s,h,e,c,o,a;Guard.requireType("member",r,$data.Expressions.ConstantExpression);switch(i.expressionType){case $data.Expressions.EntityExpression:u=i.getMemberDefinition(r.value),u||Guard.raise(new Exception("Unknown member: "+r.value,"MemberNotFound")),l=u.storageModel.PhysicalType.memberDefinitions.getMember(u.name);switch(l.kind){case"property":return f=Container.createMemberInfoExpression(u),Container.createEntityFieldExpression(i,f);case"navProperty":return(s=u.storageModel.Associations[u.name],h=Container.createEntitySetExpression(i,Container.createAssociationInfoExpression(s)),s.ToMultiplicity!=="*")?Container.createEntityExpression(h,{}):h;case"complexProperty":return f=Container.createMemberInfoExpression(u),Container.createComplexTypeExpression(i,f)}case $data.Expressions.ComplexTypeExpression:return(e=i.getMemberDefinition(r.value),e||Guard.raise("Unknown member "+r.value+" on "+i.entityType.name),c=Container.createMemberInfoExpression(e),Container.isPrimitiveType(Container.resolveType(e.dataType)))?Container.createEntityFieldExpression(i,c):Container.createComplexTypeExpression(i,c);case $data.Expressions.QueryParameterExpression:return o=n.implementation(i.value,r.value),this.parameters[i.index].name+="$"+r.value,this.parameters[i.index].value=o,Container.createQueryParameterExpression(i.name+"$"+r.value,i.index,o,Container.getTypeName(o));case $data.Expressions.EntityFieldExpression:case $data.Expressions.EntityFieldOperationExpression:return(a=this.scopeContext.resolveFieldOperation(r.value,i,t.frameType))||Guard.raise("Unknown entity field operation: "+r.getJSON()),r=Container.createMemberInfoExpression(a),Container.createEntityFieldOperationExpression(i,r,[]);default:Guard.raise("Unknown expression type to handle: "+i.expressionType.name)}}}),$C("$data.Expressions.ComplexTypeExpression",$data.Expressions.ExpressionNode,null,{constructor:function(n,t){Guard.requireType("source",n,[$data.Expressions.EntityExpression,$data.Expressions.ComplexTypeExpression]),Guard.requireType("selector",t,[$data.Expressions.EntityExpression,$data.Expressions.MemberInfoExpression]),this.source=n,this.selector=t;var i=n.entityType.getMemberDefinition(t.memberName).dataType,r=Container.resolveType(i);this.entityType=r},getMemberDefinition:function(n){return this.entityType.getMemberDefinition(n)},nodeType:{value:$data.Expressions.ExpressionType.Com}}),$C("$data.Expressions.EntityContextExpression",$data.Expressions.ExpressionNode,null,{constructor:function(n){this.instance=n},instance:{enumerable:!1},nodeType:{value:$data.Expressions.ExpressionType.EntityContext,enumerable:!0}}),$C("$data.Expressions.EntityExpression",$data.Expressions.ExpressionNode,null,{constructor:function(n,t){Guard.requireValue("source",n),Guard.requireValue("selector",t),n instanceof $data.Expressions.EntitySetExpression||n instanceof $data.Expressions.ServiceOperationExpression||Guard.raise("Only EntitySetExpressions can be the source for an EntityExpression"),this.source=n,this.selector=t,this.entityType=this.source.elementType,this.storageModel=this.source.storageModel,Guard.requireValue("entityType",this.entityType),Guard.requireValue("storageModel",this.storageModel)},getMemberDefinition:function(n){var t=this.entityType.getMemberDefinition(n);return t||Guard.raise(new Exception("Unknown member "+n+" on type "+this.entityType.name,"MemberNotFound")),t.storageModel=this.storageModel,t},nodeType:{value:$data.Expressions.ExpressionType.Entity}}),$C("$data.Expressions.EntityExpressionVisitor",null,null,{constructor:function(){this.lambdaTypes=[]},canVisit:function(n){return n instanceof $data.Expressions.ExpressionNode},Visit:function(n,t){var i,u,r;return this.canVisit(n)?(i="Visit"+n.getType().name,i in this)?(u=this[i],r=u.call(this,n,t),typeof r=="undefined")?n:r:n:n},VisitToArrayExpression:function(n,t){var i=this.Visit(n.source,t);return i!==n.source?Container.createToArrayExpression(i):n},VisitForEachExpression:function(n,t){var i=this.Visit(n.source,t);return i!==n.source?Container.createForEachExpression(i):n},VisitMemberInfoExpression:function(n){return n},VisitSingleExpression:function(n,t){var i=this.Visit(n.source,t);return i!==n.source?Container.createSingleExpression(i):n},VisitFirstExpression:function(n,t){var i=this.Visit(n.source,t);return i!==n.source?Container.createFirstExpression(i):n},VisitSomeExpression:function(n,t){var i=this.Visit(n.source,t);return i!==n.source?Container.createSomeExpression(i):n},VisitEveryExpression:function(n,t){var i=this.Visit(n.source,t);return i!==n.source?Container.createEveryExpression(i):n},VisitCountExpression:function(n,t){var i=this.Visit(n.source,t);return i!==n.source?Container.createCountExpression(i):n},VisitBatchDeleteExpression:function(n,t){var i=this.Visit(n.source,t);return i!==n.source?Container.createBatchDeleteExpression(i):n},VisitObjectLiteralExpression:function(n,t){for(var u=n.members.map(function(n){return this.Visit(n,t)},this),r=!0,i=0;i<n.members.length;i++)r=r&&n.members[i]===u[i];return r?n:Container.createObjectLiteralExpression(u)},VisitObjectFieldExpression:function(n,t){var i=this.Visit(n.expression,t);return n.expression!==i?Container.createObjectFieldExpression(n.fieldName,i):n},VisitIncludeExpression:function(n,t){var i=this.Visit(n.source,t);return i!==n.source?Container.createIncludeExpression(i,n.selector):n},VisitUnaryExpression:function(n,t){var i=this.Visit(n.operand,t);return n.operand!==i?Container.createUnaryExpression(i,n.operator,n.nodeType,n.resolution):n},VisitSimpleBinaryExpression:function(n,t){var i=this.Visit(n.left,t),r=this.Visit(n.right,t);return i!==n.left||r!==n.right?new $data.Expressions.SimpleBinaryExpression(i,r,n.nodeType,n.operator,n.type,n.resolution):n},VisitEntityContextExpression:function(n){return n},VisitCodeExpression:function(n){return n},VisitComplexTypeExpression:function(n,t){var i=this.Visit(n.source,t),r=this.Visit(n.selector,t);return i!==n.source||r!==n.selector?Container.createComplexTypeExpression(i,r):n},VisitEntityExpression:function(n,t){var i=this.Visit(n.source,t),r=this.Visit(n.selector,t);return i!==n.source||r!==n.selector?Container.createEntityExpression(i,r):n},VisitEntityFieldExpression:function(n,t){var i=this.Visit(n.source,t),r=this.Visit(n.selector,t);return i!==n.source||r!==n.selector?Container.createEntityFieldExpression(i,r):n},VisitEntityFieldOperationExpression:function(n,t){var i=this.Visit(n.source,t),r=this.Visit(n.operation,t),u=n.parameters.map(function(n){return this.Visit(n)},this);return Container.createEntityFieldOperationExpression(i,r,u)},VisitParametricQueryExpression:function(n,t){var i=this.Visit(n.expression,t),r=n.parameters.map(function(n){return this.Visit(n)},this);return Container.createParametricQueryExpression(i,r)},VisitEntitySetExpression:function(n,t){var i=this.Visit(n.source,t),r=this.Visit(n.selector,t);return i!==n.source||r!==n.selector?Container.createEntitySetExpression(i,r,n.params,n.instance):n},VisitFilterExpression:function(n,t){var i=this.Visit(n.source,t),r=this.Visit(n.selector,t);return i!==n.source||r!==n.selector?Container.createFilterExpression(i,r,n.params,n.instance):n},VisitProjectionExpression:function(n,t){var r=this.Visit(n.source,t),u=this.Visit(n.selector,t),i;return r!==n.source||u!==n.selector?(i=Container.createProjectionExpression(r,u,n.params,n.instance),i.projectionAs=n.projectionAs,i):n},VisitOrderExpression:function(n,t){var i=this.Visit(n.source,t),r=this.Visit(n.selector,t);return i!==n.source||r!==n.selector?Container.createOrderExpression(i,r,n.nodeType):n},VisitPagingExpression:function(n,t){var i=this.Visit(n.source,t),r=this.Visit(n.amount,t);return i!==n.source||r!==n.amount?Container.createPagingExpression(i,r,n.nodeType):n}}),$C("$data.Expressions.EntityFieldExpression",$data.Expressions.ExpressionNode,null,{constructor:function(n,t){this.selector=t,this.source=n,(this.selector instanceof $data.Expressions.MemberInfoExpression||this.selector.name)&&(this.memberName=this.selector.name)},nodeType:{value:$data.Expressions.ExpressionType.EntityField}}),$C("$data.Expressions.EntityFieldOperationExpression",$data.Expressions.ExpressionNode,null,{constructor:function(n,t,i){this.source=n,this.operation=t,this.parameters=i},nodeType:{value:$data.Expressions.ExpressionType.EntityFieldOperation}}),$C("$data.Expressions.EntitySetExpression",$data.Expressions.ExpressionNode,null,{constructor:function(n,t,i,r){function f(){for(var t=n;t;){if(t instanceof $data.Expressions.EntityContextExpression)return t;t=t.source}}Guard.requireType("source",n,[$data.Expressions.EntityContextExpression,$data.Expressions.EntitySetExpression]),Guard.requireType("selector",n,[$data.Expressions.MemberInfoExpression,$data.Expressions.CodeExpression,$data.Expressions.ParametricQueryExpression]),this.source=n,this.selector=t,this.params=i,this.instance=r,this.storage_type={};var u=f();switch(!0){case this.source instanceof $data.Expressions.EntityContextExpression:Guard.requireType("selector",t,$data.Expressions.MemberInfoExpression),this.elementType=t.memberDefinition.elementType,this.storageModel=u.instance._storageModel.getStorageModel(this.elementType);break;case this.source instanceof $data.Expressions.EntityExpression:Guard.requireType("selector",t,$data.Expressions.AssociationInfoExpression),this.elementType=t.associationInfo.ToType,this.storageModel=u.instance._storageModel.getStorageModel(this.elementType);break;case this.source instanceof $data.Expressions.EntitySetExpression:this.elementType=this.source.elementType,this.storageModel=this.source.storageModel;break;case this.source instanceof $data.Expressions.ServiceOperationExpression:this.elementType=this.source.elementType,this.storageModel=this.source.storageModel;break;default:Guard.raise("Unknown source type for EntitySetExpression: "+this.source.getType().name)}},instance:{enumerable:!1},nodeType:{value:$data.Expressions.ExpressionType.EntitySet,enumerable:!0}}),$C("$data.Expressions.FrameOperationExpression",$data.Expressions.ExpressionNode,null,{constructor:function(n,t,i){this.source=n,this.operation=t,this.parameters=i},nodeType:{value:$data.Expressions.ExpressionType.FrameOperation}}),$C("$data.Expressions.FilterExpression",$data.Expressions.EntitySetExpression,null,{constructor:function(){this.resultType=$data.Array},nodeType:{value:$data.Expressions.ExpressionType.Filter,enumerable:!0}}),$C("$data.Expressions.FrameOperator",$data.Expressions.ExpressionNode,null,{constructor:function(){this.isTerminated=!0}}),$C("$data.Expressions.CountExpression",$data.Expressions.FrameOperator,null,{constructor:function(n){this.source=n,this.resultType=$data.Integer},nodeType:{value:$data.Expressions.ExpressionType.Count,enumerable:!0}}),$C("$data.Expressions.SingleExpression",$data.Expressions.FrameOperator,null,{constructor:function(n){this.source=n,this.resultType=$data.Object},nodeType:{value:$data.Expressions.ExpressionType.Single,enumerable:!0}}),$C("$data.Expressions.FirstExpression",$data.Expressions.FrameOperator,null,{constructor:function(n){this.source=n,this.resultType=$data.Object},nodeType:{value:$data.Expressions.ExpressionType.First,enumerable:!0}}),$C("$data.Expressions.ForEachExpression",$data.Expressions.FrameOperator,null,{constructor:function(n){this.source=n,this.resultType=$data.Array},nodeType:{value:$data.Expressions.ExpressionType.ForEach,enumerable:!0}}),$C("$data.Expressions.ToArrayExpression",$data.Expressions.FrameOperator,null,{constructor:function(n){this.source=n,this.resultType=$data.Array},nodeType:{value:$data.Expressions.ExpressionType.ToArray,enumerable:!0}}),$C("$data.Expressions.SomeExpression",$data.Expressions.FrameOperator,null,{constructor:function(n){this.source=n,this.resultType=$data.Object},nodeType:{value:$data.Expressions.ExpressionType.Some,enumerable:!0}}),$C("$data.Expressions.EveryExpression",$data.Expressions.FrameOperator,null,{constructor:function(n){this.source=n,this.resultType=$data.Object},nodeType:{value:$data.Expressions.ExpressionType.Every,enumerable:!0}}),$C("$data.Expressions.BatchDeleteExpression",$data.Expressions.FrameOperator,null,{constructor:function(n){this.source=n,this.resultType=$data.Integer},nodeType:{value:$data.Expressions.ExpressionType.BatchDelete,enumerable:!0}}),$C("$data.Expressions.IncludeExpression",$data.Expressions.EntitySetExpression,null,{constructor:function(){},nodeType:{value:$data.Expressions.ExpressionType.Include,writable:!0},toString:function(){return"unimplemented"}},null),$C("$data.Expressions.MemberInfoExpression",$data.Expressions.ExpressionNode,null,{constructor:function(n){this.memberDefinition=n,this.memberName=n.name},nodeType:{value:$data.Expressions.ExpressionType.MemberInfo,enumerable:!0}}),$C("$data.Expressions.OrderExpression",$data.Expressions.EntitySetExpression,null,{constructor:function(n,t,i){this.nodeType=i},nodeType:{value:$data.Expressions.ExpressionType.OrderBy,writable:!0},toString:function(){return"unimplemented"}},null),$C("$data.Expressions.ParametricQueryExpression",$data.Expressions.ExpressionNode,null,{constructor:function(n,t){this.expression=n,this.parameters=t},nodeType:{value:$data.Expressions.ExpressionType.ParametricQuery,enumerable:!0}}),$C("$data.Expressions.ProjectionExpression",$data.Expressions.EntitySetExpression,null,{constructor:function(){},nodeType:{value:$data.Expressions.ExpressionType.Projection,enumerable:!0}}),$C("$data.Expressions.QueryExpressionCreator",$data.Expressions.EntityExpressionVisitor,null,{constructor:function(n){Guard.requireValue("scopeContext",n),this.scopeContext=n},VisitEntitySetExpression:function(n){return n.source instanceof $data.Expressions.EntityContextExpression&&this.lambdaTypes.push(n),n},VisitServiceOperationExpression:function(n){return n.source instanceof $data.Expressions.EntityContextExpression&&this.lambdaTypes.push(n),n},VisitCodeExpression:function(n,t){var o=n.source.toString(),i=Container.createCodeParser(this.scopeContext).createExpression(o),r,u;this.scopeContext.log({event:"JSCodeExpression",data:i}),r=Container.createConstantValueResolver(n.parameters,window),u=Container.createParameterResolverVisitor(),i=u.Visit(i,r),this.scopeContext.log({event:"JSCodeExpressionResolved",data:i});var f=Container.createCodeToEntityConverter(this.scopeContext),e=f.Visit(i,{queryParameters:n.parameters,lambdaParameters:this.lambdaTypes,frameType:t.frameType}),s=Container.createParametricQueryExpression(e,f.parameters);return this.scopeContext.log({event:"EntityExpression",data:e}),s},VisitFilterExpression:function(n,t){var r=this.Visit(n.source,t),i;return(t=t||{},t.frameType=n.getType(),i=this.Visit(n.selector,t),r!==n.source||i!==n.selector)?Container.createFilterExpression(r,i,n.params,n.instance):n},VisitProjectionExpression:function(n,t){var u=this.Visit(n.source,t),i,r;return(t=t||{},t.frameType=n.getType(),i=this.Visit(n.selector,t),u!==n.source||i!==n.selector)?(r=Container.createProjectionExpression(u,i,n.params,n.instance),r.projectionAs=n.projectionAs,r):n},VisitOrderExpression:function(n,t){var r=this.Visit(n.source,t),i;return(t=t||{},t.frameType=n.getType(),i=this.Visit(n.selector,t),r!==n.source||i!==n.selector)?Container.createOrderExpression(r,i,n.nodeType):n}}),$C("$data.Expressions.QueryParameterExpression",$data.Expressions.ExpressionNode,null,{constructor:function(n,t,i){this.name=n,this.index=t,this.value=i,this.type=Container.getTypeName(i)},nodeType:{value:$data.Expressions.ExpressionType.QueryParameter,writable:!1}}),$C("$data.Expressions.RepresentationExpression",$data.Expressions.ExpressionNode,null,{constructor:function(){},getMemberDefinition:function(n){return this.entityType.getMemberDefinition(n)},nodeType:{value:$data.Expressions.ExpressionType.Entity}}),$C("$data.Expressions.ServiceOperationExpression",$data.Expressions.ExpressionNode,null,{constructor:function(n,t,i,r){function u(){for(var t=n;t;){if(t instanceof $data.Expressions.EntityContextExpression)return t;t=t.source}}Guard.requireType("source",n,[$data.Expressions.EntityContextExpression]),Guard.requireType("selector",n,[$data.Expressions.MemberInfoExpression]),this.source=n,this.selector=t,this.params=i,this.cfg=r;var f=u();switch(!0){case this.source instanceof $data.Expressions.EntityContextExpression:this.elementType=r.elementType?Container.resolveType(r.elementType):Container.resolveType(r.returnType),this.storageModel=r.elementType?f.instance._storageModel.getStorageModel(Container.resolveType(r.elementType)):null;break;default:Guard.raise("Unknown source type for EntitySetExpression: "+this.source.getType().name)}},nodeType:{value:$data.Expressions.ExpressionType.ServiceOperation,enumerable:!0}}),$data.Class.define("$data.Validation.ValidationError",null,null,{constructor:function(n,t,i){this.Message=n,this.PropertyDefinition=t,this.Type=i},Type:{dataType:"string"},Message:{dataType:"string"},PropertyDefinition:{dataType:$data.MemberDefinition}},null),$data.Class.define("$data.Validation.EntityValidationBase",null,null,{ValidateEntity:function(){return[]},ValidateEntityField:function(){return[]},getValidationValue:function(){Guard.raise("Pure class")},getValidationMessage:function(){Guard.raise("Pure class")}},null),$data.Validation=$data.Validation||{},$data.Validation.Entity=new $data.Validation.EntityValidationBase,$data.Class.define("$data.Validation.EntityValidation",$data.Validation.EntityValidationBase,null,{ValidateEntity:function(n){var t=[];return n.getType().memberDefinitions.getPublicMappedProperties().forEach(function(i){t=t.concat(this.ValidateEntityField(n,i,undefined,!0))},this),t},ValidateEntityField:function(n,t,i,r){var u=[],f=Container.resolveName(Container.resolveType(t.dataType)),e=r?n[t.name]:i;return this.fieldValidate(n,t,e,u,f),u},getValidationValue:function(n,t){return n[t]&&n[t].value?n[t].value:n[t]},getValidationMessage:function(n,t,i){var r=i;return typeof n[t]=="object"&&n[t].message?r=n[t].message:n.errorMessage&&(r=n.errorMessage),r},createValidationError:function(n,t,i){return new $data.Validation.ValidationError(this.getValidationMessage(n,t,i),n,t)},supportedValidations:{value:{"$data.Number":{required:function(n){return!Object.isNullOrUndefined(n)},customValidator:function(n,t){return Object.isNullOrUndefined(n)||typeof t=="function"?t(n):!0},minValue:function(n,t){return Object.isNullOrUndefined(n)||n>=t},maxValue:function(n,t){return Object.isNullOrUndefined(n)||n<=t}},"$data.Integer":{required:function(n){return!Object.isNullOrUndefined(n)},customValidator:function(n,t){return Object.isNullOrUndefined(n)||typeof t=="function"?t(n):!0},minValue:function(n,t){return Object.isNullOrUndefined(n)||n>=t},maxValue:function(n,t){return Object.isNullOrUndefined(n)||n<=t}},"$data.String":{required:function(n){return!Object.isNullOrUndefined(n)},customValidator:function(n,t){return Object.isNullOrUndefined(n)||typeof t=="function"?t(n):!0},minLength:function(n,t){return Object.isNullOrUndefined(n)||n.length>=t},maxLength:function(n,t){return Object.isNullOrUndefined(n)||n.length<=t},length:function(n,t){return Object.isNullOrUndefined(n)||n.length==t},regex:function(n,t){return Object.isNullOrUndefined(n)||n.match(typeof t=="string"?new RegExp(t.indexOf("/")===0&&t.lastIndexOf("/")===t.length-1?t.slice(1,-1):t):t)}},"$data.Date":{required:function(n){return!Object.isNullOrUndefined(n)},customValidator:function(n,t){return Object.isNullOrUndefined(n)||typeof t=="function"?t(n):!0},minValue:function(n,t){return Object.isNullOrUndefined(n)||n>=t},maxValue:function(n,t){return Object.isNullOrUndefined(n)||n<=t}},"$data.Boolean":{required:function(n){return!Object.isNullOrUndefined(n)},customValidator:function(n,t){return Object.isNullOrUndefined(n)||typeof t=="function"?t(n):!0}},"$data.Array":{required:function(n){return!Object.isNullOrUndefined(n)},customValidator:function(n,t){return Object.isNullOrUndefined(n)||typeof t=="function"?t(n):!0},length:function(n,t){return Object.isNullOrUndefined(n)||n.length==t}},"$data.Object":{required:function(n){return!Object.isNullOrUndefined(n)},customValidator:function(n,t){return Object.isNullOrUndefined(n)||typeof t=="function"?t(n):!0}},"$data.Guid":{required:function(n){return!Object.isNullOrUndefined(n)},customValidator:function(n,t){return Object.isNullOrUndefined(n)||typeof t=="function"?t(n):!0}}}},fieldValidate:function(n,t,i,r,u){var f,e;(n.entityState!=$data.EntityState.Modified||n[t.name]!=undefined)&&(f=this.supportedValidations[u],f&&(e=Object.keys(f),e.forEach(function(u){t[u]&&f[u]&&!f[u].call(n,i,this.getValidationValue(t,u))&&r.push(this.createValidationError(t,u,"Validation error!"))},this)))}},null),$data.Validation.Entity=new $data.Validation.EntityValidation,$data.Class.define("$data.Notifications.ChangeDistributorBase",null,null,{distributeData:function(){Guard.raise("Pure class")}},null),$data.Class.define("$data.Notifications.ChangeCollectorBase",null,null,{buildData:function(){Guard.raise("Pure class")},processChangedData:function(n){this.Distrbutor&&this.Distrbutor.distributeData&&this.Distrbutor.distributeData(this.buildData(n))},Distrbutor:{enumerable:!1,dataType:$data.Notifications.ChangeDistributorBase,storeOnObject:!0}},null),$data.Class.define("$data.Notifications.ChangeDistributor",$data.Notifications.ChangeDistributorBase,null,{constructor:function(n){this.broadcastUrl=n},distributeData:function(n){$data.ajax({url:this.broadcastUrl,type:"POST",data:"data="+JSON.stringify(n),succes:this.success,error:this.error})},broadcastUrl:{dataType:"string"},success:function(){},error:function(){}},null),$data.Class.define("$data.Notifications.ChangeCollector",$data.Notifications.ChangeCollectorBase,null,{buildData:function(n){var t=[];return n.forEach(function(n){var r={entityState:n.data.entityState,typeName:n.data.getType().name},i=[];switch(n.data.entityState){case $data.EntityState.Added:i=n.data.getType().memberDefinitions.getPublicMappedProperties();break;case $data.EntityState.Modified:i=n.data.changedProperties;break;case $data.EntityState.Deleted:i=n.data.getType().memberDefinitions.getKeyProperties()}i.forEach(function(t){r[t.name]=n.data[t.name]}),t.push(r)}),t}},null),$data.Class.define("$data.Access",null,null,{},{isAuthorized:function(n,t,i,r){var u=new $data.PromiseHandler,f=u.createCallback(r),e=u.getPromise();return f.success(!0),e},getAccessBitmaskFromPermission:function(n){var t=$data.Access.None;return n.Create&&(t|=$data.Access.Create),n.Read&&(t|=$data.Access.Read),n.Update&&(t|=$data.Access.Update),n.Delete&&(t|=$data.Access.Delete),n.DeleteBatch&&(t|=$data.Access.DeleteBatch),n.Execute&&(t|=$data.Access.Execute),t},None:{value:0},Create:{value:1},Read:{value:2},Update:{value:4},Delete:{value:8},DeleteBatch:{value:16},Execute:{value:32}}),$data.Class.define("$data.Promise",null,null,{always:function(){Guard.raise(new Exception("$data.Promise.always","Not implemented!"))},done:function(){Guard.raise(new Exception("$data.Promise.done","Not implemented!"))},fail:function(){Guard.raise(new Exception("$data.Promise.fail","Not implemented!"))},isRejected:function(){Guard.raise(new Exception("$data.Promise.isRejected","Not implemented!"))},isResolved:function(){Guard.raise(new Exception("$data.Promise.isResolved","Not implemented!"))},pipe:function(){Guard.raise(new Exception("$data.Promise.pipe","Not implemented!"))},progress:function(){Guard.raise(new Exception("$data.Promise.progress","Not implemented!"))},promise:function(){Guard.raise(new Exception("$data.Promise.promise","Not implemented!"))},state:function(){Guard.raise(new Exception("$data.Promise.state","Not implemented!"))},then:function(){Guard.raise(new Exception("$data.Promise.then","Not implemented!"))}},null),$data.Class.define("$data.PromiseHandlerBase",null,null,{constructor:function(){},createCallback:function(n){return n=$data.typeSystem.createCallbackSetting(n),cbWrapper={success:n.success,error:n.error,notify:n.notify}},getPromise:function(){return new $data.Promise}},null),$data.PromiseHandler=$data.PromiseHandlerBase,EventSubscriber=$data.Class.define("EventSubscriber",null,null,{constructor:function(n,t,i){this.handler=n,this.state=t,this.thisArg=i},handler:{},state:{},thisArg:{}}),$data.Event=Event=$data.Class.define("$data.Event",null,null,{constructor:function(n,t){function r(n,t){n.forEach(function(i,r){i.handler==t&&n.splice(r,1)})}var i=null,u=t;this.attach=function(n,r,u){i||(i=[]),i.push(new EventSubscriber(n,r,u||t))},this.detach=function(n){r(i,n)},this.fire=function(n,r){var u=r||t||this;i&&i.forEach(function(t){try{t.handler.call(t.thisArg,u,n,t.state)}catch(i){console.log("unhandled exception in event handler. exception suppressed"),console.dir(i)}})},this.fireCancelAble=function(n,r){var f=r||t||this,u=!0;return i&&i.forEach(function(t){try{u=u&&(t.handler.call(t.thisArg,f,n,t.state)===!1?!1:!0)}catch(i){console.log("unhandled exception in event handler. exception suppressed"),console.dir(i)}}),u}}});var eventData=$data.Class.define("EventData",null,null,{eventName:{}}),PropertyChangeEventData=$data.Class.define("PropertyChangeEventData",EventData,null,{constructor:function(n,t,i){this.propertyName=n,this.oldValue=t,this.newValue=i},propertyName:{},oldValue:{},newValue:{}}),PropertyValidationEventData=$data.Class.define("PropertyValidationEventData",EventData,null,{constructor:function(n,t,i,r){this.propertyName=n,this.oldValue=t,this.newValue=i,this.errors=r,this.cancel=!1},propertyName:{},oldValue:{},newValue:{},errors:{},cancel:{}});$data.Entity=Entity=$data.Class.define("$data.Entity",null,null,{constructor:function(n){var u,r,f,t,i;if(this.initData={},this.getType().__copyPropertiesToInstance&&$data.typeSystem.writePropertyValues(this),u=null,this.context=u,arguments.length==1&&typeof n=="object"){r=this.getType().memberDefinitions,f=r.getPublicMappedPropertyNames(),this.initData={};for(t in n)f.indexOf(t)>-1&&(i=Container.resolveType(r.getMember(t).type),this.initData[t]=Object.isNullOrUndefined(n[t])?n[t]:i===$data.Date&&typeof n[t]=="string"?new Date(n[t]):i!==$data.Geography||typeof n[t]!="object"||n[t]instanceof $data.Geography?i!==$data.Guid||n[t]instanceof $data.Guid?n[t]:$data.parseGuid(n[t]):new $data.Geography(n[t]));this.changedProperties=undefined,this.entityState=undefined}},toString:function(){return this.getType().fullName+"("+(this.Id||this.Name||"")+")"},toJSON:function(){var n={},t=this;return this.getType().memberDefinitions.getPublicMappedProperties().forEach(function(i){n[i.name]=t[i.name]}),n},equals:function(n){var i,t;if(n.getType()!==this.getType())return!1;for(i=this.getType().memberDefinitions.getKeyProperties(),t=0;t<i.length;t++)if(this[i[t].name]==n[i[t].name])return!0;return!1},propertyChanging:{dataType:$data.Event,storeOnObject:!0,monitorChanges:!1,notMapped:!0,enumerable:!1,prototypeProperty:!0,get:function(){return this._propertyChanging||(this._propertyChanging=new Event("propertyChanging",this)),this._propertyChanging},set:function(n){this._propertyChanging=n}},propertyChanged:{dataType:$data.Event,storeOnObject:!0,monitorChanges:!1,notMapped:!0,enumerable:!1,prototypeProperty:!0,get:function(){return this._propertyChanged||(this._propertyChanged=new Event("propertyChanged",this)),this._propertyChanged},set:function(n){this._propertyChanged=n}},propertyValidationError:{dataType:$data.Event,storeOnObject:!0,monitorChanges:!1,notMapped:!0,enumerable:!1,prototypeProperty:!0,get:function(){return this._propertyValidationError||(this._propertyValidationError=new Event("propertyValidationError",this)),this._propertyValidationError},set:function(n){this._propertyValidationError=n}},storeProperty:function(n,t){var i,f,r,u,e;(t=this.typeConversion(n,t),i=null,n.monitorChanges!=!1&&(this._propertyChanging||this._propertyChanged||"instancePropertyChanged"in this.constructor)&&(r=this[n.name],i=new PropertyChangeEventData(n.name,r,t),this._propertyChanging&&this.propertyChanging.fire(i)),n.monitorChanges!=!1&&(this._propertyValidationError||"instancePropertyValidationError"in this.constructor)&&(f=$data.Validation.Entity.ValidateEntityField(this,n,t),f.length>0&&(r=this[n.name],u=new PropertyValidationEventData(n.name,r,t,f),this._propertyValidationError&&this.propertyValidationError.fire(u),"instancePropertyValidationError"in this.constructor&&this.constructor.instancePropertyValidationError.fire(u,this),u.cancel==!0)))||(n.storeOnObject==!0?(e="_"+n.name,this[e]=t):this.initData[n.name]=t,this.isValidated=!1,n.monitorChanges!=!1&&this.entityState==$data.EntityState.Unchanged&&(this.entityState=$data.EntityState.Modified),n.monitorChanges!=!1&&(this.changedProperties||(this.changedProperties=[]),this.changedProperties.some(function(t){return t.name==n.name})||this.changedProperties.push(n),this._propertyChanged&&this.propertyChanged.fire(i),"instancePropertyChanged"in this.constructor&&this.constructor.instancePropertyChanged.fire(i,this)))},typeConversion:function(n,t){var i=t;if(typeof t=="string"&&!n.concurrencyMode)switch(Container.resolveName(n.type)){case"$data.Guid":i=$data.parseGuid(t);break;case"$data.Integer":if(i=parseInt(t),isNaN(i))throw Guard.raise(new Exception("TypeError: ","value not convertable to $data.Integer",[n,t]));break;case"$data.Number":if(i=parseFloat(t),isNaN(i))throw Guard.raise(new Exception("TypeError: ","value not convertable to $data.Number",[n,t]));break;case"$data.Date":if(i=new Date(t),isNaN(i.valueOf()))throw Guard.raise(new Exception("TypeError: ","value not convertable to $data.Date",[n,t]));break;case"$data.Boolean":switch(t.toLowerCase()){case"true":i=!0;break;case"false":i=!1;break;default:throw Guard.raise(new Exception("TypeError: ","value not convertable to $data.Boolean",[n,t]));}break;case"$data.Object":try{i=JSON.parse(t)}catch(r){throw Guard.raise(new Exception("TypeError: ",r.toString(),[n,t]));}}return i},retrieveProperty:function(n){if(n.storeOnObject==!0){var t="_"+n.name;return this[t]}return this.initData[n.name]},getProperty:function(n,t){if(t=$data.typeSystem.createCallbackSetting(t),this[n.name]!=undefined){t.success(this[n.name]);return}return this.context||Guard.raise(new Exception("Entity not in context","Invalid operation")),this.context.loadItemProperty(this,n,t)},setProperty:function(n,t,i){this[n.name]=t,i=$data.typeSystem.createCallbackSetting(i);var r=new $data.PromiseHandler;return callBack=r.createCallback(i),i.success(this[n.name]),r.getPromise()},isValid:function(){return this.isValidated||(this.ValidationErrors=$data.Validation.Entity.ValidateEntity(this),this.isValidated=!0),this.ValidationErrors.length==0},isValidated:{dataType:"bool",storeOnObject:!0,monitorChanges:!1,notMapped:!0,enumerable:!1,value:!1},ValidationErrors:{dataType:Array,elementType:$data.Validation.ValidationError,storeOnObject:!0,monitorChanges:!0,notMapped:!0,enumerable:!1},resetChanges:function(){delete this._changedProperties},changedProperties:{dataType:Array,elementType:window.MemberDefinition,storeOnObject:!0,monitorChanges:!1,notMapped:!0,enumerable:!1},entityState:{dataType:"integer",storeOnObject:!0,monitorChanges:!1,notMapped:!0,enumerable:!1},remove:function(){if($data.ItemStore&&"EntityInstanceRemove"in $data.ItemStore)return $data.ItemStore.EntityInstanceRemove.apply(this,arguments);throw"not implemented";},save:function(){if($data.ItemStore&&"EntityInstanceSave"in $data.ItemStore)return $data.ItemStore.EntityInstanceSave.apply(this,arguments);throw"not implemented";},refresh:function(){if($data.ItemStore&&"EntityInstanceSave"in $data.ItemStore)return $data.ItemStore.EntityInstanceRefresh.apply(this,arguments);throw"not implemented";},storeToken:{type:Object,monitorChanges:!1,notMapped:!0,storeOnObject:!0}},{__setPropertyfunctions:{value:!0,notMapped:!0,enumerable:!1,storeOnObject:!0},__copyPropertiesToInstance:{value:!1,notMapped:!0,enumerable:!1,storeOnObject:!0},inheritedTypeProcessor:function(){$data.ItemStore&&"EntityInheritedTypeProcessor"in $data.ItemStore&&$data.ItemStore.EntityInheritedTypeProcessor.apply(this,arguments)},addEventListener:function(n,t){var i="on"+n;i in this||(this[i]=new $data.Event(n,this)),this[i].attach(t)},removeEventListener:function(n,t){var i="on"+n;i in this&&this[i].detach(t)},raiseEvent:function(n,t){var i="on"+n;i in this&&this[i].fire(t)}}),$data.define=function(n,t){var r,f;if(!t)throw new Error("json object type is not supported yet");var i={},u=[];if(Object.keys(t).forEach(function(n){var r=t[n];typeof r=="object"&&("type"in r||"get"in r||"set"in r)?(i[n]=r,r.key&&u.push(r),!("get"in r||"set"in r)||"notMapped"in r&&r.notMapped!==!0||(r.notMapped=!0,r.storeOnObject=!0),"get"in r&&!("set"in r)?r.set=function(){}:"set"in r&&!("get"in r)&&(r.get=function(){})):i[n]={type:r}}),u.length<1){switch(!0){case"id"in i:r="id";break;case"Id"in i:r="Id";break;case"ID"in i:r="ID"}r?(i[r].key=!0,f=$data.Container.resolveName(i[r].type),i[r].computed=!0):i.Id={type:"int",key:!0,computed:!0}}return $data.Entity.extend(n,i)},$data.implementation=function(n){return Container.resolveType(n)},$data.Class.define("$data.StorageModel",null,null,{constructor:function(){this.ComplexTypes=[],this.Associations=[]},LogicalType:{},LogicalTypeName:{},PhysicalType:{},PhysicalTypeName:{},EventHandlers:{},TableName:{},TableOptions:{value:undefined},ComplexTypes:{},Associations:{},EntitySetReference:{}},null),$data.Class.define("$data.Association",null,null,{constructor:function(n){n&&(this.From=n.From,this.FromType=n.FromType,this.FromMultiplicity=n.FromMultiplicity,this.FromPropertyName=n.FromPropertyName,this.To=n.To,this.ToType=n.ToType,this.ToMultiplicity=n.ToMultiplicity,this.ToPropertyName=n.ToPropertyName)},From:{},FromType:{},FromMultiplicity:{},FromPropertyName:{},To:{},ToType:{},ToMultiplicity:{},ToPropertyName:{},ReferentialConstraint:{}},null),$data.Class.define("$data.ComplexType",$data.Association,null,{},null),$data.Class.define("$data.EntityContext",null,null,{constructor:function(n){var f=this,i=JSON.parse(JSON.stringify(n)),t,r;this.storeToken={typeName:this.getType().fullName,args:i,factory:function(){return new(f.getType())(i)}},"string"==typeof n&&(n=0===n.indexOf("http")?{name:"oData",oDataServiceHost:n}:{name:"local",databaseName:n}),"provider"in n&&(n.name=n.provider),this.lazyLoad=!1,this.trackChanges=!1,this._entitySetReferences={},this._storageModel=[],t=this,this._storageModel.getStorageModel=function(n){for(var u=Container.resolveType(n),r,i=0;i<t._storageModel.length;i++)if(r=t._storageModel[i],r.LogicalType===u)return r},typeof n.name=="string"&&(r=n.name,n.name=[r]);var e=[].concat(n.name),u=$data.typeSystem.createCallbackSetting({success:this._successInitProvider});$data.StorageProviderLoader.load(e,{success:function(i){t.storageProvider=new i(n,t),t.storageProvider.setContext(t),t.stateManager=new $data.EntityStateManager(t),n.name in t.getType()._storageModelCache?t._storageModel=t.getType()._storageModelCache[n.name]:(t._initializeStorageModel(),t.getType()._storageModelCache[n.name]=t._storageModel),t._initializeEntitySets(t.constructor),n&&n.user&&Object.defineProperty(t,"user",{value:n.user,enumerable:!0}),n&&n.checkPermission&&Object.defineProperty(t,"checkPermission",{value:n.checkPermission,enumerable:!0}),t._isOK=!1,t.storageProvider&&t.storageProvider.initializeStore(u)},error:function(){u.error("Provider fallback failed!")}}),this.addEventListener=function(n,t){var i="on"+n;i in this||(this[i]=new $data.Event(n,this)),this[i].attach(t)},this.removeEventListener=function(n,t){var i="on"+n;i in this&&this[i].detach(t)},this.raiseEvent=function(n,t){var i="on"+n;i in this&&this[i].fire(t)}},getDataType:function(dataType){if(typeof dataType=="string"){var memDef_dataType=this[dataType];return(memDef_dataType===undefined||memDef_dataType===null)&&(memDef_dataType=eval(dataType)),memDef_dataType}return dataType},_initializeEntitySets:function(){for(var n,t,i=0,r=this._storageModel.length;i<r;i++)n=this._storageModel[i],this[n.ItemName]=new $data.EntitySet(n.LogicalType,this,n.ItemName,n.EventHandlers),t=this[n.ItemName],t.name=n.ItemName,t.tableName=n.TableName,t.tableOptions=n.TableOptions,t.eventHandlers=n.EventHandlers,this._entitySetReferences[n.LogicalType.name]=t,n.EntitySetReference=t},_initializeStorageModel:function(){for(var l=this.getType().memberDefinitions.asArray(),t,e,n,u,o,i,r,c,s,a,h,f=0;f<l.length;f++)t=l[f],"dataType"in t&&(e=Container.resolveType(t.dataType),e&&e.isAssignableTo&&e.isAssignableTo($data.EntitySet)&&(n=new $data.StorageModel,n.TableName=t.tableName||t.name,n.TableOptions=t.tableOptions,n.ItemName=t.name,n.LogicalType=Container.resolveType(t.elementType),n.LogicalTypeName=n.LogicalType.name,n.PhysicalTypeName=$data.EntityContext._convertLogicalTypeNameToPhysical(n.LogicalTypeName),t.beforeCreate&&(n.EventHandlers||(n.EventHandlers={}),n.EventHandlers.beforeCreate=t.beforeCreate),t.beforeRead&&(n.EventHandlers||(n.EventHandlers={}),n.EventHandlers.beforeRead=t.beforeRead),t.beforeUpdate&&(n.EventHandlers||(n.EventHandlers={}),n.EventHandlers.beforeUpdate=t.beforeUpdate),t.beforeDelete&&(n.EventHandlers||(n.EventHandlers={}),n.EventHandlers.beforeDelete=t.beforeDelete),t.afterCreate&&(n.EventHandlers||(n.EventHandlers={}),n.EventHandlers.afterCreate=t.afterCreate),t.afterRead&&(n.EventHandlers||(n.EventHandlers={}),n.EventHandlers.afterRead=t.afterRead),t.afterUpdate&&(n.EventHandlers||(n.EventHandlers={}),n.EventHandlers.afterUpdate=t.afterUpdate),t.afterDelete&&(n.EventHandlers||(n.EventHandlers={}),n.EventHandlers.afterDelete=t.afterDelete),this._storageModel.push(n)));if(typeof intellisense=="undefined")for(f=0;f<this._storageModel.length;f++){for(n=this._storageModel[f],u={},n.Associations=n.Associations||[],n.ComplexTypes=n.ComplexTypes||[],o=0;o<n.LogicalType.memberDefinitions.getPublicMappedProperties().length;o++){if(i=n.LogicalType.memberDefinitions.getPublicMappedProperties()[o],r=Container.resolveType(i.dataType),this.storageProvider.supportedDataTypes.indexOf(r)>-1&&Object.isNullOrUndefined(i.inverseProperty)){c=JSON.parse(JSON.stringify(i)),c.dataType=r,u[i.name]=c;continue}this._buildDbType_navigationPropertyComplite(i,r,n),(r===$data.Array||r.isAssignableTo&&r.isAssignableTo($data.EntitySet))&&i.inverseProperty&&i.inverseProperty!=="$$unbound"?this._buildDbType_Collection_OneManyDefinition(u,n,r,i):i.inverseProperty?i.inverseProperty==="$$unbound"?r===$data.Array?this._buildDbType_Collection_OneManyDefinition(u,n,r,i):this._buildDbType_ElementType_OneManyDefinition(u,n,r,i):(s=r.memberDefinitions.getMember(i.inverseProperty),s?s.elementType?(a=Container.resolveType(s.elementType),a===n.LogicalType?this._buildDbType_ElementType_OneManyDefinition(u,n,r,i):typeof intellisense=="undefined"&&Guard.raise(new Exception("Inverse property not valid, refereed item element type not match: "+n.LogicalTypeName,", property: "+i.name))):this._buildDbType_ElementType_OneOneDefinition(u,n,r,i):typeof intellisense=="undefined"&&Guard.raise(new Exception("Inverse property not valid"))):this._buildDbType_addComplexTypePropertyDefinition(u,n,r,i)}this._buildDbType_modifyInstanceDefinition(u,n,this),h={},h.convertTo=this._buildDbType_generateConvertToFunction(n,this),this._buildDbType_modifyClassDefinition(h,n,this),n.PhysicalType=$data.Class.define(n.PhysicalTypeName,$data.Entity,null,u,h)}},_buildDbType_navigationPropertyComplite:function(n,t,i){var f,o,e,r,h,u,s;if(n.inverseProperty)u=null,u=t===$data.Array||t.isAssignableTo&&t.isAssignableTo($data.EntitySet)?this._storageModel.getStorageModel(Container.resolveType(n.elementType)):this._storageModel.getStorageModel(t),s=u.LogicalType.memberDefinitions.getMember(n.inverseProperty),s&&(s.inverseProperty?s.inverseProperty!=n.name&&typeof intellisense=="undefined"&&Guard.raise(new Exception("Inverse property mismatch")):s.inverseProperty=n.name);else{if(f=null,t===$data.Array||t.isAssignableTo&&t.isAssignableTo($data.EntitySet)){if(u=this._storageModel.getStorageModel(Container.resolveType(n.elementType)),u)for(f=[],o=u.LogicalType.memberDefinitions.getPublicMappedProperties(),e=0;e<o.length;e++)r=o[e],r.inverseProperty==n.name&&Container.resolveType(r.dataType)===Container.resolveType(i.LogicalType)&&f.push(r)}else if(u=this._storageModel.getStorageModel(t),u)for(f=[],o=u.LogicalType.memberDefinitions.getPublicMappedProperties(),e=0;e<o.length;e++)r=o[e],r.elementType&&r.inverseProperty==n.name&&Container.resolveType(r.elementType)===i.LogicalType?f.push(r):r.inverseProperty==n.name&&Container.resolveType(r.dataType)===i.LogicalType&&f.push(r);f&&(f.length>1&&typeof intellisense!="undefined"&&Guard.raise(new Exception("More than one inverse property refer to this member definition: "+n.name+", type: "+Container.resolveName(i.LogicalType))),h=f.pop(),h&&(n.inverseProperty=h.name))}},_buildDbType_generateConvertToFunction:function(){return function(n){return n}},_buildDbType_modifyInstanceDefinition:function(){return},_buildDbType_modifyClassDefinition:function(){return},_buildDbType_addComplexTypePropertyDefinition:function(n,t,i,r){this._addNavigationPropertyDefinition(n,r,r.name,$data.MemberTypes.complexProperty);var u=this._createComplexElement(t.LogicalType,"",r.name,i,"","");t.ComplexTypes[r.name]=u,t.ComplexTypes.push(u)},_buildDbType_Collection_OneManyDefinition:function(n,t,i,r){var f=Container.resolveType(r.elementType),e,u,o,h,s;for((f===undefined||f===null)&&typeof intellisense=="undefined"&&Guard.raise(new Exception("Element type definition error","Field definition",r)),u=0;u<this._storageModel.length;u++)if(o=this._storageModel[u],o.LogicalType===f){e=o;break}e||typeof intellisense=="undefined"&&Guard.raise(new Exception("No EntitySet definition for the following element type","Field definition",r)),this._addNavigationPropertyDefinition(n,r,r.name),h=r.inverseProperty==="$$unbound"?"$$unbound":"0..1",s=this._addAssociationElement(t.LogicalType,h,r.name,e.LogicalType,"*",r.inverseProperty),t.Associations[r.name]=s,t.Associations.push(s)},_buildDbType_ElementType_OneManyDefinition:function(n,t,i,r){var f=Container.resolveType(r.dataType),e,u,o,h,s;for((f===undefined||f===null)&&typeof intellisense=="undefined"&&Guard.raise(new Exception("Element type definition error","Field definition",r)),u=0;u<this._storageModel.length;u++)if(o=this._storageModel[u],o.LogicalType===f){e=o;break}e||typeof intellisense=="undefined"&&Guard.raise(new Exception("No EntitySet definition for the following element type","Field definition",r)),this._addNavigationPropertyDefinition(n,r,r.name),h=r.inverseProperty==="$$unbound"?"$$unbound":"*",s=this._addAssociationElement(t.LogicalType,h,r.name,e.LogicalType,"0..1",r.inverseProperty),t.Associations[r.name]=s,t.Associations.push(s)},_buildDbType_ElementType_OneOneDefinition:function(n,t,i,r){var e=Container.resolveType(r.dataType),u,f,o,s;for((e===undefined||e===null)&&typeof intellisense=="undefined"&&Guard.raise(new Exception("Element type definition error","Field definition",r)),f=0;f<this._storageModel.length;f++)if(o=this._storageModel[f],o.LogicalType===e){u=o;break}u||typeof intellisense=="undefined"&&Guard.raise(new Exception("No EntitySet definition following element type","Field definition",r)),s=u.LogicalType.memberDefinitions.getMember(r.inverseProperty),s.required||r.required||typeof intellisense=="undefined"&&typeof intellisense=="undefined"&&Guard.raise(new Exception("In one to one connection, one side must required!","One to One connection",r)),this._addNavigationPropertyDefinition(n,r,r.name),association=this._addAssociationElement(t.LogicalType,r.required?"0..1":"1",r.name,u.LogicalType,r.required?"1":"0..1",r.inverseProperty),t.Associations[r.name]=association,t.Associations.push(association)},_addNavigationPropertyDefinition:function(n,t,i,r){var u=JSON.parse(JSON.stringify(t));u.dataType=$data.EntitySet,u.notMapped=!0,u.kind=r?r:$data.MemberTypes.navProperty,u.association=i,n[t.name]=u},_addAssociationElement:function(n,t,i,r,u,f){return new $data.Association({From:n.name,FromType:n,FromMultiplicity:t,FromPropertyName:i,To:r.name,ToType:r,ToMultiplicity:u,ReferentialConstraint:[],ToPropertyName:f})},_createComplexElement:function(n,t,i,r,u,f){return new $data.ComplexType({From:n.name,FromType:n,FromMultiplicity:t,FromPropertyName:i,To:r.name,ToType:r,ToMultiplicity:u,ReferentialConstraint:[],ToPropertyName:f})},_successInitProvider:function(n){if(n!=undefined&&n._isOK!=undefined&&(n._isOK=!0,n.onReadyFunction))n.onReadyFunction(n)},onReady:function(n){var t=new $data.PromiseHandler,i=t.createCallback(n);return this.onReadyFunction=i.success,this._isOK&&i.success(this),t.getPromise()},getEntitySetFromElementType:function(elementType){var result=this._entitySetReferences[elementType];if(!result)try{result=this._entitySetReferences[eval(elementType).name]}catch(ex){}return result},executeQuery:function(n,t){var i=new $data.Query(n.expression,n.defaultType,this),f,u,r,e;t=$data.typeSystem.createCallbackSetting(t),f=this,u={},u.success=function(n){var i;if(n.buildResultSet(f),$data.ItemStore&&"QueryResultModifier"in $data.ItemStore&&$data.ItemStore.QueryResultModifier.call(f,n),n.expression.nodeType===$data.Expressions.ExpressionType.Single||n.expression.nodeType===$data.Expressions.ExpressionType.Count||n.expression.nodeType===$data.Expressions.ExpressionType.BatchDelete||n.expression.nodeType===$data.Expressions.ExpressionType.Some||n.expression.nodeType===$data.Expressions.ExpressionType.Every){if(n.result.length!==1){t.error(new Exception("result count failed"));return}i=n.result[0]}else if(n.expression.nodeType===$data.Expressions.ExpressionType.First){if(n.result.length===0){t.error(new Exception("result count failed"));return}i=n.result[0]}else i=n.result;var u=function(){t.success(i)},e=0,r=n.getEntitySets(),o=function(){var f=r[e],t;f.afterRead?(e++,t=f.afterRead.call(this,i,r,n),typeof t=="function"?t.call(this,e<r.length?o:u,i,r,n):e<r.length?o():u()):u()};r.length?o():u()},u.error=t.error,r=i.getEntitySets(),e=function(){var n=!0,s=f,t=function(t){t===!1&&(n=!1),n?s.storageProvider.executeQuery(i,u):(i.rawDataList=[],i.result=[],u.success(i))},e=0,o=function(u){var s,f;u===!1&&(n=!1),s=r[e],s.beforeRead?(e++,f=s.beforeRead.call(this,r,i),typeof f=="function"?f.call(this,e<r.length&&n?o:t,r,i):(f===!1&&(n=!1),e<r.length&&n?o():t())):t()};r.length?o():t()},this.user&&this.checkPermission?this.checkPermission(i.expression.nodeType===$data.Expressions.ExpressionType.BatchDelete?$data.Access.DeleteBatch:$data.Access.Read,this.user,r,{success:e,error:u.error}):e()},saveChanges:function(n){for(var u=[],l=this.stateManager.trackedEntities,kt=new $data.PromiseHandler,a=kt.createCallback(n),vt=kt.getPromise(),b=[],nt,i,tt,dt,ft,yt,et,pt,ht,r,h,wt,ct,ri,it,k,bt,d,lt,f,e,g,t,v,s,y;l.length>0;){for(nt=[],t=0;t<l.length;t++){for(i=l[t],tt=this._storageModel.getStorageModel(i.data.getType()),i.data.entityState==$data.EntityState.Unchanged?(i.skipSave=!0,b.push(i.data)):i.data.entityState==$data.EntityState.Modified&&i.data.changedProperties&&(dt=i.data.changedProperties.some(function(n){var r=tt.PhysicalType.memberDefinitions.getMember(n.name),t,i;return r.kind==$data.MemberTypes.navProperty?(t=tt.Associations[r.association],i=t.FromMultiplicity+t.ToMultiplicity,i=="*0..1"||i=="0..11"):!0}),dt||(i.skipSave=!0,b.push(i.data))),this.processEntityTypeBeforeEventHandler(b,i),ft=[],yt=tt.PhysicalType.memberDefinitions.asArray(),et=0;et<yt.length;et++)pt=yt[et],pt.kind==$data.MemberTypes.navProperty&&ft.push(pt);for(e=0;e<ft.length;e++){var gt=ft[e],ot=tt.Associations[gt.name],ii=gt.name,st=ot.ToPropertyName,ni=[].concat(i.data[ii]);for(ht=0;ht<ni.length;ht++)if(r=ni[ht],r){if(h=r[st],wt=ot.FromMultiplicity+ot.ToMultiplicity,ot.FromMultiplicity==="$$unbound")if(r instanceof $data.Array)for(i.dependentOn=i.dependentOn||[],ct=0;ct<r.length;ct++)ri=r[ct],i.dependentOn.indexOf(r)<0&&r.skipSave!==!0&&i.dependentOn.push(r);else i.dependentOn=i.dependentOn||[],i.dependentOn.indexOf(r)<0&&r.skipSave!==!0&&i.dependentOn.push(r);else{switch(wt){case"*0..1":h?h instanceof Array?h.indexOf(i.data)==-1&&(h.push(i.data),r[st]=h):typeof intellisense=="undefined"&&Guard.raise("Item must be array or subtype of array"):r[st]=[i.data];break;default:h?h!==i.data&&typeof intellisense=="undefined"&&Guard.raise("Integrity check error! Item assigned to another entity!"):r[st]=i.data}switch(wt){case"*0..1":case"0..11":i.dependentOn=i.dependentOn||[],i.dependentOn.indexOf(r)<0&&r.skipSave!==!0&&i.dependentOn.push(r)}}r.entityState||(r.entityState=$data.EntityState.Added),nt.indexOf(r)==-1&&nt.push(r)}}}for(t=0;t<l.length;t++)f=l[t],f.skipSave!==!0&&u.push(f);for(l=[],t=0;t<nt.length;t++)it=nt[t],b.some(function(n){return n==it})||u.some(function(n){return n.data==it})||l.push({data:it,entitySet:this.getEntitySetFromElementType(it.getType().name)})}for(e=0;e<u.length;e++)if(k=u[e],k.dependentOn){for(bt=[],t=0;t<k.dependentOn.length;t++)b.indexOf(k.dependentOn[t])<0&&bt.push(k.dependentOn[t]);k.dependentOn=bt}if(b=null,d=this,u.length==0)return this.stateManager.trackedEntities.length=0,a.success(0),vt;for(lt=[],t=0;t<u.length;t++){if(f=u[t],f.data.entityState===$data.EntityState.Added)for(e=0;e<f.data.getType().memberDefinitions.getPublicMappedProperties().length;e++)g=f.data.getType().memberDefinitions.getPublicMappedProperties()[e],!g.required||g.computed||f.data[g.name]||(f.data[g.name]=Container.getDefault(g.dataType));f.data.entityState!==$data.EntityState.Added&&f.data.entityState!==$data.EntityState.Modified||f.data.isValid()||lt.push({item:f.data,errors:f.data.ValidationErrors})}if(lt.length>0)return a.error(lt),vt;var at=$data.Access.None,o={},ti=[];for(t=0;t<u.length;t++)if(v=u[t],s=v.entitySet.elementType.name,ti.push(v.entitySet.name),y=this._entitySetReferences[s],y.beforeCreate||y.beforeUpdate||y.beforeDelete||this.user&&this.checkPermission){o[s]||(o[s]={});switch(v.data.entityState){case $data.EntityState.Added:at|=$data.Access.Create,y.beforeCreate&&(o[s].createAll||(o[s].createAll=[]),o[s].createAll.push(v));break;case $data.EntityState.Modified:at|=$data.Access.Update,y.beforeUpdate&&(o[s].modifyAll||(o[s].modifyAll=[]),o[s].modifyAll.push(v));break;case $data.EntityState.Deleted:at|=$data.Access.Delete,y.beforeDelete&&(o[s].deleteAll||(o[s].deleteAll=[]),o[s].deleteAll.push(v))}}var p=function(n){n===!1&&(c="async",u.length=0),u.length?d.storageProvider.saveChanges({success:function(){d._postProcessSavedItems(a,u)},error:a.error},u):c?a.error(new Exception("Cancelled event in "+c,"CancelEvent")):a.success(0)},c,w=Object.getOwnPropertyNames(o),t=0,rt=["beforeUpdate","beforeDelete","beforeCreate"],ui={beforeCreate:"createAll",beforeDelete:"deleteAll",beforeUpdate:"modifyAll"},ut=function(n){var r,f,e,s,a,v;if(n===!1){c="async",u.length=0,p(n);return}var l=d._entitySetReferences[w[t]],h=rt.pop(),y=o[w[t]],i=y[ui[h]];if(i){for(r=[],f=0;f<i.length;f++)r.push(i[f].data);if(rt.length||(rt=["beforeUpdate","beforeDelete","beforeCreate"],t++),e=l[h].call(d,r),typeof e=="function")e.call(d,t<w.length&&!c?ut:p,r);else if(e===!1){for(c=l.name+"."+h,s=0;s<i.length;s++)a=i[s],v=u.indexOf(a),u.splice(v,1);p()}else t<w.length&&!c?ut():p()}else rt.length||(rt=["beforeUpdate","beforeDelete","beforeCreate"],t++),t<w.length&&!c?ut():p()};return this.user&&this.checkPermission?this.checkPermission(at,this.user,ti,{success:function(){t<w.length?ut():p()},error:a.error}):t<w.length?ut():p(),vt},processEntityTypeBeforeEventHandler:function(n,t){if(!t.skipSave){var i=t.data,r=i.getType(),u=i.entityState;switch(!0){case u===$data.EntityState.Added&&r.onbeforeCreate instanceof $data.Event:r.onbeforeCreate.fireCancelAble(i)===!1&&(t.skipSave=!0,n.push(i));break;case u===$data.EntityState.Modified&&r.onbeforeUpdate instanceof $data.Event:r.onbeforeUpdate.fireCancelAble(i)===!1&&(t.skipSave=!0,n.push(i));break;case u===$data.EntityState.Deleted&&r.onbeforeDelete instanceof $data.Event:r.onbeforeDelete.fireCancelAble(i)===!1&&(t.skipSave=!0,n.push(i))}}},processEntityTypeAfterEventHandler:function(n){var i=n.data,t=i.getType(),r=i.entityState;switch(!0){case r===$data.EntityState.Added&&t.onafterCreate instanceof $data.Event:t.onafterCreate.fire(i);break;case r===$data.EntityState.Modified&&t.onafterUpdate instanceof $data.Event:t.onafterUpdate.fire(i);break;case r===$data.EntityState.Deleted&&t.onafterDelete instanceof $data.Event:t.onafterDelete.fire(i)}},prepareRequest:function(){},_postProcessSavedItems:function(n,t){var i,e,r,f,v;for(this.ChangeCollector&&this.ChangeCollector instanceof $data.Notifications.ChangeCollectorBase&&this.ChangeCollector.processChangedData(t),i={},e=this,r=0;r<t.length;r++){f=t[r],this.processEntityTypeAfterEventHandler(f),v=f.data.entityState,f.data.entityState=$data.EntityState.Unchanged,f.data.changedProperties=[],f.physicalData=undefined;var u=f.entitySet.elementType.name,o=e._entitySetReferences[u],h=undefined;switch(v){case $data.EntityState.Added:h="added";break;case $data.EntityState.Deleted:h="deleted";break;case $data.EntityState.Modified:h="updated"}if(h&&this.raiseEvent(h,f),o.afterCreate||o.afterUpdate||o.afterDelete){i[u]||(i[u]={});switch(v){case $data.EntityState.Added:o.afterCreate&&(i[u].createAll||(i[u].createAll=[]),i[u].createAll.push(f));break;case $data.EntityState.Modified:o.afterUpdate&&(i[u].modifyAll||(i[u].modifyAll=[]),i[u].modifyAll.push(f));break;case $data.EntityState.Deleted:o.afterDelete&&(i[u].deleteAll||(i[u].deleteAll=[]),i[u].deleteAll.push(f))}}}var s=Object.getOwnPropertyNames(i),r=0,e=this,c=["afterUpdate","afterDelete","afterCreate"],y={afterCreate:"createAll",afterDelete:"deleteAll",afterUpdate:"modifyAll"},l=function(){e.trackChanges||e.stateManager.reset(),n.success(t.length)},a=function(){var h=e._entitySetReferences[s[r]],o=c.pop(),v=i[s[r]],u=v[y[o]],n,t,f;if(u){for(n=[],t=0;t<u.length;t++)n.push(u[t].data);c.length||(c=["afterUpdate","afterDelete","afterCreate"],r++),f=h[o].call(e,n),typeof f=="function"?f.call(e,r<s.length?a:l,n):r<s.length?a():l()}else c.length||(c=["afterUpdate","afterDelete","afterCreate"],r++),r<s.length?a():l()};r<s.length?a():l()},forEachEntitySet:function(n,t){var i,r;for(i in this._entitySetReferences)r=this._entitySetReferences[i],n.call(t,r)},loadItemProperty:function(n,t,i){var f,v,l,a,p,h,u,e,r,o,w;if(Guard.requireType("entity",n,$data.Entity),f=typeof t=="string"?n.getType().memberDefinitions.getMember(t):t,n[f.name]!=undefined)return v=new $data.PromiseHandler,callBack=v.createCallback(i),i.success(n[f.name]),v.getPromise();var y=!0,c=this._storageModel.getStorageModel(n.getType().fullName),s=Container.resolveType(f.dataType);if(s===$data.Array||s.isAssignableTo&&s.isAssignableTo($data.EntitySet))s=Container.resolveType(f.elementType),y=!1;else{for(a=0;a<c.Associations.length;a++)if(p=c.Associations[a],p.FromPropertyName==f.name){l=p;break}l&&l.FromMultiplicity==="0..1"&&l.ToMultiplicity==="1"&&(y=!1)}if(h=c.LogicalType.memberDefinitions.getKeyProperties(),y===!0){for(u="function (e) { return",e={},r=0;r<h.length;r++)o=h[r],r>0&&(u+=" &&"),u+=" e."+o.name+" == this.key"+r,e["key"+r]=n[o.name];return u+="; }",c.EntitySetReference.map("function (e) { return e."+f.name+" }").single(u,e,i)}for(u="function (e) { return",e={},r=0;r<h.length;r++)o=h[r],r>0&&(u+=" &&"),u+=" e."+f.inverseProperty+"."+o.name+" == this.key"+r,e["key"+r]=n[o.name];return u+="; }",w=this.getEntitySetFromElementType(s),w.filter(u,e).toArray(i)},getTraceString:function(n){var t=new $data.Query(n.expression,n.defaultType,this);return this.storageProvider.getTraceString(t)},log:function(){},resolveBinaryOperator:function(n,t,i){return this.storageProvider.resolveBinaryOperator(n,t,i)},resolveUnaryOperator:function(n,t,i){return this.storageProvider.resolveUnaryOperator(n,t,i)},resolveFieldOperation:function(n,t,i){return this.storageProvider.resolveFieldOperation(n,t,i)},resolveSetOperations:function(n,t,i){return this.storageProvider.resolveSetOperations(n,t,i)},_generateServiceOperationQueryable:function(n,t,i,r){var f,u,e,o;for(typeof console!="undefined"&&console.log&&console.log("Obsolate: _generateServiceOperationQueryable, $data.EntityContext"),f=[],u=0;u<r.length;u++)e={},e[r[u]]=Container.resolveType(Container.getTypeName(i[u])),f.push(e);return o=$data.EntityContext.generateServiceOperation({serviceName:n,returnType:$data.Queryable,elementType:this[t].elementType,params:f}),o.apply(this,i)},attach:function(n,t){n instanceof $data.EntityWrapper&&(n=n.getEntity());var i=this.getEntitySetFromElementType(n.getType());return i.attach(n,t)},attachOrGet:function(n){n instanceof $data.EntityWrapper&&(n=n.getEntity());var t=this.getEntitySetFromElementType(n.getType());return t.attachOrGet(n)},addMany:function(n){var t=this;return n.forEach(function(n){t.add(n)}),n},add:function(n){n instanceof $data.EntityWrapper&&(n=n.getEntity());var t=this.getEntitySetFromElementType(n.getType());return t.add(n)},remove:function(n){n instanceof $data.EntityWrapper&&(n=n.getEntity());var t=this.getEntitySetFromElementType(n.getType());return t.remove(n)},storeToken:{type:Object}},{generateServiceOperation:function(n){var t,r,u,i,f,e;if(n.serviceMethod?(r=n.returnType?Container.resolveType(n.returnType):{},t=r.isAssignableTo&&r.isAssignableTo($data.Queryable)?n.serviceMethod:function(){var u=arguments[arguments.length-1],i=new $data.PromiseHandler,t,e=arguments,r;typeof u=="function"?(t=i.createCallback(u),arguments[arguments.length-1]=t):(t=i.createCallback(),arguments.push(t));try{r=n.serviceMethod.apply(this,arguments),r!==undefined&&t.success(r)}catch(f){t.error(f)}return i.getPromise()}):t=function(){var s=n.elementType?this.getEntitySetFromElementType(Container.resolveType(n.elementType)):null,f=null,r,e,o,t;if(n.params)for(f=[],r=0;r<n.params.length;r++)for(e in n.params[r])f.push(Container.createConstantExpression(arguments[r],Container.resolveType(n.params[r][e]),e));var h=Container.createEntityContextExpression(this),c=this.getType().getMemberDefinition(n.serviceName),u=Container.createServiceOperationExpression(h,Container.createMemberInfoExpression(c),f,n),i=arguments[arguments.length-1];return typeof i!="function"&&(i=undefined),s?(t=Container.createQueryable(s,u),i)?(u.isTerminated=!0,t._runQuery(i)):t:(o=Container.resolveType(n.returnType),t=Container.createQueryable(this,u),t.defaultType=o,o===$data.Queryable)?(t.defaultType=Container.resolveType(n.elementType),i)?(u.isTerminated=!0,t._runQuery(i)):t:(u.isTerminated=!0,t._runQuery(i))},u=[],n.params)for(i=0;i<n.params.length;i++){f=n.params[i];for(e in f)u.push({name:e,type:f[e]})}return $data.typeSystem.extend(t,n,{params:u}),t},_convertLogicalTypeNameToPhysical:function(n){return n+"_$db$"},_storageModelCache:{get:function(){return this.__storageModelCache||(this.__storageModelCache={}),this.__storageModelCache},set:function(){}}}),$data.Class.define("$data.QueryProvider",null,null,{constructor:function(){this.requiresExpressions=!1},executeQuery:function(){},getTraceString:function(){}},null),$data.Class.define("$data.ModelBinder",null,null,{constructor:function(n){this.context=n,this.cache={}},deepExtend:function(n,t){var i,r;if(n===null||n===undefined){n=t;return}for(i in t)if(n.hasOwnProperty(i)){if(typeof t[i]=="object")if(Array.isArray(t[i]))for(r=0;r<t[i].length;r++)n[i].indexOf(t[i][r])<0&&n[i].push(t[i][r]);else this.deepExtend(n[i],t[i])}else n[i]=t[i]},call:function(n,t){var n,u,c,h,b,l,v,p,w,a,s,r,y,o,i,e,f;if(!Object.getOwnPropertyNames(t).length)return n;if(n=n,t.$selector){for(c=t.$selector,c instanceof Array||(c=[c]),s=0;s<c.length;){h=n,b=c[s],e=b.split(":");switch(e[0]){case"json":for(l=e[1].split(".");l.length;)if(typeof h[l[0]]=="undefined"){if(s===c.length)return undefined;if(l.length)break}else if(h=h[l[0]],l=l.slice(1),h===null)return h;l.length||(s=c.length);break;case"css":case"xml":h.querySelector?h=h[t.$item?"querySelectorAll":"querySelector"](e[1]):(h=$(h).find(e[1]),t.$item||(h=h[0]))}s++}if(n=h,!n)return n}if(t.$type){if(v=Container.resolveType(t.$type),p=!1,t.$source||t.$value||v===$data.Array||v===$data.Object||v.isAssignableTo||(p=!0),(v===$data.Object||v===$data.Array)&&(w=Object.keys(t),(w.length==1||w.length==2&&t.$selector)&&(p=!0)),e=Container.resolveName(t.$type),f=this.context.storageProvider.fieldConverter.fromDb[e],p)return n!=undefined&&f?f(n):n;u=f?f():new(Container.resolveType(t.$type))}if(t.$value)typeof t.$value=="function"?u=t.$value.call(this,t,n):t.$type?(e=Container.resolveName(t.$type),f=this.context.storageProvider.fieldConverter.fromDb[e],u=f?f(t.$value):new(Container.resolveType(t.$type))(t.$value)):u=t.$value;else if(t.$source)t.$type?(e=Container.resolveName(t.$type),f=this.context.storageProvider.fieldConverter.fromDb[e],u=f?f(n[t.$source]):new(Container.resolveType(t.$type))(n[t.$source])):u=t.$source.split(":")[0]=="attr"&&n.getAttribute?n.getAttribute(t.$source.split(":")[1]):t.$source=="textContent"&&!n[t.$source]?$(n).text():n[t.$source];else if(t.$item)if(t.$item.$keys&&(a=[]),Array.isArray(n))for(s=0;s<n.length;s++){if(r="",t.$keys)for(i=0;i<t.$keys.length;i++)r+=t.$type+"_"+t.$keys[i]+"#"+n[s][t.$keys[i]];if(o=this.call(n[s],t.$item),r)this.cache[r]?(u=this.cache[r],u.indexOf(o)<0&&u.push(o)):(this.cache[r]=u,u.push(o));else{if(r="",t.$item.$keys)for(i=0;i<t.$item.$keys.length;i++){if(typeof n[s][t.$item.$keys[i]]=="undefined"){r=undefined;break}r+=t.$type+"_"+t.$item.$keys[i]+"#"+n[s][t.$item.$keys[i]]}a&&r?a.indexOf(r)<0&&(u.push(o),a.push(r)):u.push(o)}}else{if(r="",t.$keys)for(i=0;i<t.$keys.length;i++)r+=t.$type+"_"+t.$keys[i]+"#"+n[t.$keys[i]];if(o=this.call(n,t.$item),r)this.cache[r]?(u=this.cache[r],u.indexOf(o)<0&&u.push(o)):(this.cache[r]=u,u.push(o));else{if(r="",t.$item.$keys)for(i=0;i<t.$item.$keys.length;i++){if(typeof n[t.$item.$keys[i]]=="undefined"){r=undefined;break}r+=t.$type+"_"+t.$item.$keys[i]+"#"+n[t.$item.$keys[i]]}a&&r?a.indexOf(r)<0&&(u.push(o),a.push(r)):u.push(o)}}else if(r="",t.$keys){for(i=0;i<t.$keys.length;i++)r+=t.$type+"_"+t.$keys[i]+"#"+n[t.$keys[i]];if(this.cache[r]){u=this.cache[r];for(i in t)if(i.indexOf("$")<0)if(t[i].$item)if(t[i].$item.$keys){for(r="",y=0;y<t[i].$item.$keys.length;y++)r+=t[i].$item.$type+"_"+t[i].$item.$keys[y]+"#"+n[t[i].$item.$keys[y]];o=this.call(n,t[i].$item),this.cache[r]?u[i].indexOf(this.cache[r])<0&&u[i].push(this.cache[r]):(this.cache[r]=o,u[i].push(o))}else u[i].push(this.call(n,t[i].$item));else typeof t[i]=="object"&&(o=this.call(n,t[i]),this.deepExtend(u[i],o))}else{for(i in t)i.indexOf("$")<0&&(t[i].$item?u[i]=this.call(n,t[i]):t[i].$type||t[i].$source?u[i]=this.call(n,t[i]):t.$type?(e=Container.resolveName(t.$type.memberDefinitions.getMember(i).type),f=this.context.storageProvider.fieldConverter.fromDb[e],u[i]=f?f(n[t[i]]):new(Container.resolveType(t.$type.memberDefinitions.getMember(i).type))(n[t[i]])):u[i]=t[i].$source?n[t[i].$source]:n[t[i]]);this.cache[r]=u}}else for(i in t)i.indexOf("$")<0&&(t[i].$item?u[i]=this.call(n,t[i]):t[i].$type||t[i].$source?u[i]=this.call(n,t[i]):t.$type?(e=Container.resolveName(Container.resolveType(t.$type).memberDefinitions.getMember(i).type),f=this.context.storageProvider.fieldConverter.fromDb[e],u[i]=f?f(n[t[i]]):new(Container.resolveType(t.$type.memberDefinitions.getMember(i).type))(n[t[i]])):u[i]=t[i].$source?n[t[i].$source]:n[t[i]]);return u instanceof $data.Entity&&(u.changedProperties=undefined),u}}),$C("$data.queryBuilder",null,null,{constructor:function(){this._fragments={},this.selectedFragment=null,this._binderConfig={},this.modelBinderConfig=this._binderConfig,this._binderConfigPropertyStack=[]},selectTextPart:function(n){this._fragments[n]||(this._fragments[n]={text:"",params:[]}),this.selectedFragment=this._fragments[n]},getTextPart:function(n){return this._fragments[n]},addText:function(n){this.selectedFragment.text+=n},addParameter:function(n){this.selectedFragment.params.push(n)},selectModelBinderProperty:function(n){this._binderConfigPropertyStack.push(this.modelBinderConfig),n in this.modelBinderConfig||(this.modelBinderConfig[n]={}),this.modelBinderConfig=this.modelBinderConfig[n]},popModelBinderProperty:function(){this.modelBinderConfig=this._binderConfigPropertyStack.length===0?this._binderConfig():this._binderConfigPropertyStack.pop()},resetModelBinderProperty:function(){this._binderConfigPropertyStack=[],this.modelBinderConfig=this._binderConfig},addKeyField:function(n){this.modelBinderConfig.$keys||(this.modelBinderConfig.$keys=[]),this.modelBinderConfig.$keys.push(n)}}),$C("$data.Query",null,null,{constructor:function(n,t,i){this.expression=n,this.context=i,this.expressions=n,this.defaultType=t,this.result=[],this.rawDataList=[],this.modelBinderConfig={},this.context=i},rawDataList:{dataType:"Array"},result:{dataType:"Array"},resultType:{},buildResultSet:function(){var n=new $data.ModelBinder(this.context);this.result=n.call(this.rawDataList,this.modelBinderConfig);return},getEntitySets:function(){var n=[],t=this.context,i=function(r){r instanceof $data.Expressions.EntitySetExpression&&n.indexOf(t._entitySetReferences[r.elementType.name])<0&&n.push(t._entitySetReferences[r.elementType.name]),r.source&&i(r.source)};return i(this.expression),n}},null),$data.Class.define("$data.Queryable",null,null,{constructor:function(n,t){var i=n instanceof $data.EntityContext?n:n.entityContext;this.defaultType=n instanceof $data.EntityContext?null:n.defaultType,this.entityContext=i,this.expression=t},filter:function(n,t){var i,r,u,f,e;return this._checkOperation("filter"),i=Container.createCodeExpression(n,t),r=this.expression,this.expression instanceof $data.Expressions.FilterExpression&&(r=this.expression.source,u=this.entityContext.storageProvider.resolveBinaryOperator("and"),i=Container.createSimpleBinaryExpression(this.expression.selector,i,"and","filter","boolean",u)),f=Container.createFilterExpression(r,i),e=Container.createQueryable(this,f),e},where:function(n,t){return this.filter(n,t)},map:function(n,t,i){var u,r;return this._checkOperation("map"),u=Container.createCodeExpression(n,t),r=Container.createProjectionExpression(this.expression,u),r.projectionAs=i==="default"?this.defaultType:i?Container.resolveType(i):$data.Object,Container.createQueryable(this,r)},select:function(n,t,i){return this.map(n,t,i)},length:function(n){var t;this._checkOperation("length");var i=new $data.PromiseHandler,r=i.createCallback(n),u=Container.createCountExpression(this.expression),f=Container.createQueryExpressionCreator(this.entityContext);try{t=f.Visit(u),this.entityContext.log({event:"EntityExpression",data:t}),this.entityContext.executeQuery(Container.createQueryable(this,t),r)}catch(e){r.error(e)}return i.getPromise()},count:function(n){return this.length(n)},forEach:function(n){function u(t){t.forEach(n)}var t,i;this._checkOperation("forEach"),t=new $data.PromiseHandler;var r=t.createCallback(u),f=Container.createForEachExpression(this.expression),e=Container.createQueryExpressionCreator(this.entityContext);try{i=e.Visit(f),this.entityContext.log({event:"EntityExpression",data:i}),this.entityContext.executeQuery(Container.createQueryable(this,i),r)}catch(o){r.error(o)}return t.getPromise()},toArray:function(n){var t;if(n instanceof $data.Array)return this.toArray(function(t){n.length=0,t.forEach(function(t){n.push(t)})});this._checkOperation("toArray");var i=new $data.PromiseHandler,r=i.createCallback(n),u=Container.createToArrayExpression(this.expression),f=Container.createQueryExpressionCreator(this.entityContext);try{t=f.Visit(u),this.entityContext.log({event:"EntityExpression",data:t}),this.entityContext.executeQuery(Container.createQueryable(this,t),r)}catch(e){r.error(e)}return i.getPromise()},single:function(n,t,i){var r,u;this._checkOperation("single"),r=this,n&&(r=this.filter(n,t)),r=r.take(2);var f=new $data.PromiseHandler,e=f.createCallback(i),o=Container.createSingleExpression(r.expression),s=Container.createQueryExpressionCreator(r.entityContext);try{u=s.Visit(o),this.entityContext.log({event:"EntityExpression",data:u}),r.entityContext.executeQuery(Container.createQueryable(r,u),e)}catch(h){e.error(h)}return f.getPromise()},some:function(n,t,i){var r,u;this._checkOperation("some"),r=this,n&&(r=this.filter(n,t)),r=r.take(1);var f=new $data.PromiseHandler,e=f.createCallback(i),o=Container.createSomeExpression(r.expression),s=Container.createQueryExpressionCreator(r.entityContext);try{u=s.Visit(o),this.entityContext.log({event:"EntityExpression",data:u}),r.entityContext.executeQuery(Container.createQueryable(r,u),e)}catch(h){e.error(h)}return f.getPromise()},every:function(n,t,i){var r,u;this._checkOperation("every"),r=this,n&&(r=this.filter(n,t)),r=r.take(1);var f=new $data.PromiseHandler,e=f.createCallback(i),o=Container.createEveryExpression(r.expression),s=Container.createQueryExpressionCreator(r.entityContext);try{u=s.Visit(o),this.entityContext.log({event:"EntityExpression",data:u}),r.entityContext.executeQuery(Container.createQueryable(r,u),e)}catch(h){e.error(h)}return f.getPromise()},take:function(n){this._checkOperation("take");var t=Container.createConstantExpression(n,"number"),i=Container.createPagingExpression(this.expression,t,$data.Expressions.ExpressionType.Take);return Container.createQueryable(this,i)},skip:function(n){this._checkOperation("skip");var t=Container.createConstantExpression(n,"number"),i=Container.createPagingExpression(this.expression,t,$data.Expressions.ExpressionType.Skip);return Container.createQueryable(this,i)},order:function(n){if(n===""||n===undefined||n===null)return this;if(n[0]==="-"){var t="it."+n.replace("-","");return this.orderByDescending(t)}return this.orderBy("it."+n)},orderBy:function(n,t){this._checkOperation("orderBy");var i=Container.createCodeExpression(n,t),r=Container.createOrderExpression(this.expression,i,$data.Expressions.ExpressionType.OrderBy);return Container.createQueryable(this,r)},orderByDescending:function(n,t){this._checkOperation("orderByDescending");var i=Container.createCodeExpression(n,t),r=Container.createOrderExpression(this.expression,i,$data.Expressions.ExpressionType.OrderByDescending);return Container.createQueryable(this,r)},first:function(n,t,i){var r,u;this._checkOperation("first"),r=this,n&&(r=this.filter(n,t)),r=r.take(1);var f=new $data.PromiseHandler,e=f.createCallback(i),o=Container.createFirstExpression(r.expression),s=Container.createQueryExpressionCreator(r.entityContext);try{u=s.Visit(o),r.entityContext.log({event:"EntityExpression",data:u}),r.entityContext.executeQuery(Container.createQueryable(r,u),e)}catch(h){e.error(h)}return f.getPromise()},include:function(n){this._checkOperation("include");var t=Container.createConstantExpression(n,"string"),i=Container.createIncludeExpression(this.expression,t);return Container.createQueryable(this,i)},removeAll:function(n){var t;this._checkOperation("batchDelete");var i=new $data.PromiseHandler,r=i.createCallback(n),u=Container.createBatchDeleteExpression(this.expression),f=Container.createQueryExpressionCreator(this.entityContext);try{t=f.Visit(u),this.entityContext.log({event:"EntityExpression",data:t}),this.entityContext.executeQuery(Container.createQueryable(this,t),r)}catch(e){r.error(e)}return i.getPromise()},_runQuery:function(n){var i=new $data.PromiseHandler,r=i.createCallback(n),u=Container.createQueryExpressionCreator(this.entityContext),t;try{t=u.Visit(this.expression),this.entityContext.log({event:"EntityExpression",data:t}),this.entityContext.executeQuery(Container.createQueryable(this,t),r)}catch(f){r.error(f)}return i.getPromise()},toTraceString:function(n){var t=this.expression,r,i;return t=n?Container["create"+n+"Expression"](t):Container.createToArrayExpression(t),r=Container.createQueryExpressionCreator(this.entityContext),t=r.Visit(t),i=Container.createQueryable(this,t),i.entityContext.getTraceString(i)},_checkOperation:function(n){var t=this.entityContext.resolveSetOperations(n);t.invokable==undefined||t.invokable||Guard.raise(new Exception("Operation '"+n+"' is not invokable with the provider"))},defaultType:{}},null),$data.EntitySchemaConfig=function(){this.Name=""},$data.entitySetState={created:0,defined:1,active:2},$data.Class.defineEx("$data.EntitySet",[{type:$data.Queryable,params:[new ConstructorParameter(1)]}],null,{constructor:function(n,t,i,r,u){var e,f;this.createNew=this[n.name]=this.elementType=this.defaultType=n,e=this,t["createAdd"+n.name]=function(t){var i=new n(t);return e.add(i)},this.stateManager=new $data.EntityStateManager(this),this.collectionName=i,this.roles=u;for(f in r)this[f]=r[f];this.elementType.storeToken=this.elementType.storeToken||t.storeToken},find:function(n,t){var i=this.defaultType.memberDefinitions.getKeyProperties()[0];return this.single("it."+i.name+" == this.value",{value:n},t)},addNew:function(n,t){var r=$data.typeSystem.createCallbackSetting(t),i=new this.createNew(n);return this.entityContext.saveChanges(t),i},executeQuery:function(n,t){var i=$data.typeSystem.createCallbackSetting(t);this.entityContext.executeQuery(n,i)},getTraceString:function(n){return this.entityContext.getTraceString(n)},setContext:function(n){this.entitySetState=$data.entitySetState.active,this.entityContext=n,this.entityContext[this.schema.name]=this[this.schema.name]},_trackEntity:function(n){for(var i=this.entityContext.stateManager.trackedEntities,t=0;t<i.length;t++)if(i[t].data===n)return;i.push({entitySet:this,data:n})},add:function(n){var t=n;return n instanceof $data.EntityWrapper?t=n.getEntity():n instanceof this.createNew||(t=new this.createNew(n)),t.entityState=$data.EntityState.Added,t.changedProperties=undefined,t.context=this.entityContext,this._trackEntity(t),t},addMany:function(n){var t=[],i=this;return n.forEach(function(n){t.push(i.add(n))}),t},remove:function(n){var t=n;n instanceof $data.EntityWrapper?t=n.getEntity():n instanceof this.createNew||(t=new this.createNew(n)),t.entityState=$data.EntityState.Deleted,t.changedProperties=undefined,this._trackEntity(t)},attach:function(n,t){var i=n,r,u;for(n instanceof $data.EntityWrapper?i=n.getEntity():n instanceof this.createNew||(i=new this.createNew(n)),r=0;r<this.entityContext.stateManager.trackedEntities.length;r++){if(u=this.entityContext.stateManager.trackedEntities[r],u.data===i)break;u.data.equals(i)&&Guard.raise(new Exception("Context already contains this entity!!!"))}t||(i.entityState=$data.EntityState.Unchanged,i.changedProperties=undefined),i.context=this.entityContext,this._trackEntity(i)},detach:function(n){var r=n,u,i,t,f;for(n instanceof $data.EntityWrapper?r=n.getEntity():n instanceof this.createNew||(r=new this.createNew(n)),i=this.entityContext.stateManager.trackedEntities,t=0;t<i.length;t++)i[t].data.equals(r)&&(u=i[t]);if(u){f=this.entityContext.stateManager.trackedEntities.indexOf(u),n.entityState=$data.EntityState.Detached,this.entityContext.stateManager.trackedEntities.splice(f,1);return}},attachOrGet:function(n){var t=n,u,r,i;for(n instanceof $data.EntityWrapper?t=n.getEntity():n instanceof this.createNew||(t=new this.createNew(n)),r=this.entityContext.stateManager.trackedEntities,i=0;i<r.length;i++)r[i].data.equals(t)&&(u=r[i]);return u?u.data:(t.entityState=$data.EntityState.Unchanged,t.changedProperties=undefined,t.context=this.entityContext,this._trackEntity(t),t)},loadItemProperty:function(n,t,i){return this.entityContext.loadItemProperty(n,t,i)},saveChanges:function(){this.entityContext.saveChanges.apply(this.entityContext,arguments)},addProperty:function(){this.elementType.addProperty.apply(this.elementType,arguments)},expression:{get:function(){if(!this._expression){var n=Container.createEntityContextExpression(this.entityContext),t=this.entityContext.getType().getMemberDefinition(this.collectionName),i=Container.createEntitySetExpression(n,Container.createMemberInfoExpression(t),null,this);this._expression=i}return this._expression},set:function(n){this._expression=n}}},null),$data.EntityState={Detached:0,Unchanged:10,Added:20,Modified:30,Deleted:40},$data.Class.define("$data.EntityStateManager",null,null,{constructor:function(n){this.entityContext=null,this.trackedEntities=[],this.init(n)},init:function(n){this.entityContext=n},reset:function(){this.trackedEntities=[]}},null),$data.Class.define("$data.ItemStoreClass",null,null,{constructor:function(){var n=this;n.itemStoreConfig={aliases:{},contextTypes:{}},n.resetStoreToDefault("local",!0),$data.addStore=function(){return n.addItemStoreAlias.apply(n,arguments)},$data.implementation=n.implementation},itemStoreConfig:{},addItemStoreAlias:function(n,t,i){var u=this,r=new $data.PromiseHandler,o,f,e;if("string"==typeof n){if("object"==typeof t&&"factory"in t)return o=Container.resolveType(t.typeName),u.itemStoreConfig.aliases[n]=t,u.itemStoreConfig.contextTypes[n]=o,i&&(u.itemStoreConfig["default"]=n),r.deferred.resolve(),r.getPromise();if("function"==typeof t)return(f=t())&&f instanceof $data.EntityContext?(r.deferred.resolve(f),e=r.getPromise()):e=f,e.then(function(f){return typeof f=="function"?u.addItemStoreAlias(n,f,i):f instanceof $data.EntityContext?f.onReady().then(function(r){return u.itemStoreConfig.aliases[n]=t,u.itemStoreConfig.contextTypes[n]=r.getType(),i&&(u.itemStoreConfig["default"]=n),r}):(r=new $data.PromiseHandler,r.deferred.reject(new Exception("factory dont have context instance","Invalid arguments")),r.getPromise())})}return r.deferred.reject(new Exception("Name or factory missing","Invalid arguments")),r.getPromise()},resetStoreToDefault:function(n,t){this.itemStoreConfig.aliases[n]=this._getDefaultItemStoreFactory,delete this.itemStoreConfig.contextTypes[n],t&&(this.itemStoreConfig["default"]=n)},_setStoreAlias:function(n,t){return"object"==typeof t&&(n.storeToken=t),n},_getStoreAlias:function(n,t){return n instanceof $data.Entity?t||n.storeToken||n.getType().storeToken:t||n.storeToken},_getStoreContext:function(n,t,i){var r,u;return r=n&&"object"==typeof n&&"function"==typeof n.factory?n.factory(t):n&&"string"==typeof n&&this.itemStoreConfig.aliases[n]?this.itemStoreConfig.aliases[n](t):this.itemStoreConfig.aliases[this.itemStoreConfig["default"]](t),(!r||r instanceof $data.EntityContext)&&(u=new $data.PromiseHandler,u.deferred.resolve(r),r=u.getPromise()),r.then(function(n){if(n instanceof $data.EntityContext)return n.onReady();if(i)return null;var t=new $data.PromiseHandler;return t.deferred.reject(new Exception("factory return type error","Error")),t.getPromise()})},_getStoreEntitySet:function(n,t){n=this._getStoreAlias(t,n);var i="function"==typeof t?t:t.getType();return this._getStoreContext(n,i).then(function(n){var r=n.getEntitySetFromElementType(i),t;return r?r:(t=new $data.PromiseHandler,t.deferred.reject("EntitySet not exist for "+i.fullName),t.getPromise())})},_getDefaultItemStoreFactory:function(n){if(n){var i="function"==typeof n?n:n.getType(),t=$data.Container.resolveName(i)+"_items",t=t.replace(".","_"),r=$data.EntityContext.extend(t,{Items:{type:$data.EntitySet,elementType:i}});return new r({name:"local",databaseName:t})}return undefined},implementation:function(n,t){var i=$data.ItemStore,r;return typeof t=="string"?t=i.itemStoreConfig.contextTypes[t]:t instanceof $data.EntityContext?t=t.getType():typeof t=="function"&&t.isAssignableTo||(t=i.itemStoreConfig.contextTypes[i.itemStoreConfig["default"]]),t&&(r=i._resolveFromContext(t,n)),r||(r=Container.resolveType(n)),r},_resolveFromContext:function(n,t){for(var e=n.memberDefinitions.getPublicMappedProperties(),r,u,f,i=0;i<e.length;i++)if(r=e[i],u=Container.resolveType(r.type),u.isAssignableTo&&u.isAssignableTo($data.EntitySet)&&(f=Container.resolveType(r.elementType),f.name===t))return f;return null},EntityInstanceSave:function(n,t){var r=$data.ItemStore,i=this;return r._getStoreEntitySet(n,i).then(function(u){return r._getSaveMode(i,u,t,n).then(function(n){n=n||"add";switch(n){case"add":u.add(i);break;case"attach":u.attach(i,!0),i.entityState=$data.EntityState.Modified;break;default:var t=new $data.PromiseHandler;return t.deferred.reject("save mode not supported: "+n),t.getPromise()}return u.entityContext.saveChanges().then(function(){return i})})})},EntityInstanceRemove:function(n){var i=$data.ItemStore,t=this;return i._getStoreEntitySet(n,t).then(function(n){return n.remove(t),n.entityContext.saveChanges().then(function(){return t})})},EntityInstanceRefresh:function(n,t){var u=$data.ItemStore,i=this,r=i.getType(),f=u._getKeyObjectFromEntity(i,r);return r.read(f,n).then(function(n){return r.memberDefinitions.getPublicMappedProperties().forEach(function(t){i[t.name]=n[t.name]}),i.storeToken=(t?i.storeToken:undefined)||n.storeToken,i.changedProperties=undefined,i})},EntityInheritedTypeProcessor:function(n){var t=$data.ItemStore;n.readAll=t.EntityTypeReadAll(n),n.read=t.EntityTypeRead(n),n.removeAll=t.EntityTypeRemoveAll(n),n.remove=t.EntityTypeRemove(n),n.get=t.EntityTypeGet(n),n.save=t.EntityTypeSave(n),n.addMany=t.EntityTypeAddMany(n),n.itemCount=t.EntityTypeItemCount(n),n.query=t.EntityTypeQuery(n),n.takeFirst=t.EntityTypeTakeFirst(n)},EntityTypeReadAll:function(n){return function(t){var i=$data.ItemStore;return i._getStoreEntitySet(t,n).then(function(n){return n.forEach(function(t){i._setStoreAlias(t,n.entityContext.storeToken)})})}},EntityTypeRemoveAll:function(n){return function(t){var i=$data.ItemStore;return i._getStoreEntitySet(t,n).then(function(n){return n.toArray().then(function(t){return t.forEach(function(t){n.remove(t)}),n.entityContext.saveChanges().then(function(){return t})})})}},EntityTypeRead:function(n){return function(t,i){var r=$data.ItemStore;return r._getStoreEntitySet(i,n).then(function(n){var i,u;try{return i=r._findByIdQueryable(n,t),n.single(i.predicate,i.thisArgs).then(function(t){return r._setStoreAlias(t,n.entityContext.storeToken)})}catch(f){return u=new $data.PromiseHandler,u.deferred.reject(f),u.getPromise()}})}},EntityTypeGet:function(n){return function(t,i){var u=$data.ItemStore,r=new n(u._getKeyObjectFromEntity(t));return r.refresh(i),r}},EntityTypeSave:function(n){return function(t,i,r){var f=$data.ItemStore,u=new n(t);return u.save(i,r)}},EntityTypeAddMany:function(n){return function(t,i){var r=$data.ItemStore;return r._getStoreEntitySet(i,n).then(function(n){var i=n.addMany(t);return n.entityContext.saveChanges().then(function(){return i})})}},EntityTypeRemove:function(n){return function(t,i){var e=$data.ItemStore,f=n.memberDefinitions.getKeyProperties(),r,u;return f.length===1?(u={},u[f[0].name]=t,r=new n(u)):r=new n(t),r.remove(i)}},EntityTypeItemCount:function(n){return function(t){var i=$data.ItemStore;return i._getStoreEntitySet(t,n).then(function(n){return n.length()})}},EntityTypeQuery:function(n){return function(t,i,r){var u=$data.ItemStore;return u._getStoreEntitySet(r,n).then(function(n){return n.filter(t,i).forEach(function(t){u._setStoreAlias(t,n.entityContext.storeToken)})})}},EntityTypeTakeFirst:function(n){return function(t,i,r){var u=$data.ItemStore;return u._getStoreEntitySet(r,n).then(function(n){return n.first(t,i).then(function(t){return u._setStoreAlias(t,n.entityContext.storeToken)})})}},_findByIdQueryable:function(n,t){var i=n.defaultType.memberDefinitions.getKeyProperties(),f,e,r,u;if(i.length>1&&t&&"object"==typeof t){for(f="",e={},r=0;r<i.length;r++)r>0&&(f+=" && "),u=i[r],f+="it."+u.name+" == this."+u.name,e[u.name]=t[u.name];return{predicate:f,thisArgs:e}}if(i.length===1)return{predicate:"it."+i[0].name+" == this.value",thisArgs:{value:t}};throw"invalid keys";},_getKeyObjectFromEntity:function(n,t){var r,i=t.memberDefinitions.getKeyProperties(),u;if(i.length===1)r=n&&typeof n=="object"?n[i[0].name]:n;else for(r={},u=0;u<i.length;u++)r[i[0].name]=n?n[i[0].name]:n;return r},_getSaveMode:function(n,t,i,r){var o=this,e=new $data.PromiseHandler,u=e.deferred,f=n.getType();switch(!0){case i==="update":u.resolve("attach");break;case i==="new":u.resolve("add");break;case!1===f.memberDefinitions.getKeyProperties().every(function(t){return n[t.name]}):u.resolve("add");break;default:r=this._getStoreAlias(n,r),f.read(o._getKeyObjectFromEntity(n,f),r).then(function(){u.resolve("attach")}).fail(function(){u.resolve("add")})}return e.getPromise()},QueryResultModifier:function(n){var r=$data.ItemStore,u=n.context,t=n.modelBinderConfig.$type,i;if("string"==typeof t&&(t=Container.resolveType(t)),t===$data.Array&&n.modelBinderConfig.$item&&n.modelBinderConfig.$item.$type&&(t=n.modelBinderConfig.$item.$type),t&&t.isAssignableTo&&t.isAssignableTo($data.Entity)||typeof t=="undefined"&&n.result&&n.result[0]instanceof $data.Entity)for(i=0;i<n.result.length;i++)r._setStoreAlias(n.result[i],u.storeToken)}}),$data.ItemStore=new $data.ItemStoreClass,Exception=function(n,t,i){Error.call(this),Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor),this.name=t||"Exception",this.message=n,this.data=i},Exception.prototype.__proto__=Error.prototype,Exception.prototype._getStackTrace=function(){},$data.Class.define("$data.StorageProviderLoaderBase",null,null,{isSupported:function(n){switch(n){case"indexedDb":return window.indexedDB||window.webkitIndexedDB||window.mozIndexedDB||window.msIndexedDB&&!/^file:/.test(window.location.href);case"storm":return"XMLHttpRequest"in window;case"webSql":case"sqLite":return"openDatabase"in window;case"LocalStore":return"localStorage"in window&&window.localStorage?!0:!1;case"sqLite":return"openDatabase"in window;case"mongoDB":return $data.mongoDBDriver;default:return!0}},scriptLoadTimeout:{type:"int",value:1e3},scriptLoadInterval:{type:"int",value:50},npmModules:{value:{indexedDb:"jaydata-indexeddb",InMemory:"jaydata-inmemory",LocalStore:"jaydata-inmemory",mongoDB:"jaydata-mongodb",oData:"jaydata-odata",sqLite:"jaydata-sqlite",webSql:"jaydata-sqlite",storm:"jaydata-storm"}},ProviderNames:{value:{indexedDb:"IndexedDb",InMemory:"InMemory",LocalStore:"InMemory",oData:"oData",sqLite:"SqLite",webSql:"SqLite",storm:"Storm"}},load:function(n,t){var i,r;for(t=$data.typeSystem.createCallbackSetting(t),i=n.shift();i&&!this.isSupported(i);)i=n.shift();if(i||t.error(),$data.RegisteredStorageProviders&&(r=$data.RegisteredStorageProviders[i],r)){t.success(r);return}typeof module!="undefined"&&typeof module.exports!="undefined"?this.loadNpmModule(i,n,t):this.loadProvider(i,n,t)},loadProvider:function(n,t,i){var e=this,u=$data.StorageProviderLoader.ProviderNames[n]||n,f,r;u&&(f=this.getUrl(u),r=this.loadScript,document&&document.createElement&&(r=this.loadScriptElement),r.call(this,f,n,function(r){var u=$data.RegisteredStorageProviders[n];r&&u?i.success(u):t.length>0?e.load(t,i):i.error()}))},getUrl:function(n){var t=document.querySelector('script[src$="jaydata.min.js"]'),i=document.querySelector('script[src$="jaydata.js"]');return t?t.src.substring(0,t.src.lastIndexOf("/")+1)+"jaydataproviders/"+n+"Provider.min.js":i?i.src.substring(0,i.src.lastIndexOf("/")+1)+"jaydataproviders/"+n+"Provider.js":"jaydataproviders/"+n+"Provider.js"},loadScript:function(n,t,i){function u(){return window.XMLHttpRequest?new XMLHttpRequest:window.ActiveXObject?new ActiveXObject("MsXml2.XmlHttp"):void 0}n||i(!1);var r=u();r.onreadystatechange=function(){r.readyState==4&&(r.status==200||r.status==304?(eval.call(window,r.responseText),typeof i=="function"&&i(!0)):typeof i=="function"&&i(!1))},r.open("GET",n,!0),r.send(null)},loadScriptElement:function(n,t,i){function e(){var n=$data.RegisteredStorageProviders[t];n?i(!0):(f--,f>0?setTimeout(e,r):i(!1))}var o=document.getElementsByTagName("head")[0]||document.documentElement,u=document.createElement("script"),r,f;u.type="text/javascript",u.src=n,o.appendChild(u),r=this.scriptLoadInterval||50,f=this.scriptLoadTimeout/r,setTimeout(e,r)},loadNpmModule:function(n,t,i){var r=null;try{require(this.npmModules[n]),r=$data.RegisteredStorageProviders[n]}catch(u){}r?i.success(r):t.length>0?this.load(t,i):i.error()}}),$data.StorageProviderLoader=new $data.StorageProviderLoaderBase,$data.storageProviders={DbCreationType:{Merge:10,DropTableIfChanged:20,DropAllExistingTables:30}},$data.ConcurrencyMode={Fixed:"fixed",None:"none"},$data.Class.define("$data.StorageProviderBase",null,null,{constructor:function(n){this.providerConfiguration=n||{}},providers:{},supportedDataTypes:{value:[],writable:!1},initializeStore:function(){Guard.raise("Pure class")},executeQuery:function(){Guard.raise("Pure class")},buildIndependentBlocks:function(n){function g(n){for(var t in n)if(n.hasOwnProperty(t))return!0;return!1}for(var s=[],v=[],r,u,h,w,f,c,b,e,l,t,o,k,a,y,p,d,i=0;i<n.length;i++)if(r=n[i],r.dependentOn&&r.dependentOn.length!=0){for(u=null,h=0;h<r.dependentOn.length;h++)if(w=r.dependentOn[h],w.entityState!=$data.EntityState.Unchanged){for(u=u||{},f=-1,c=0;c<n.length;c++)if(n[c].data==w){f=c;break}f==-1&&Guard.raise(new Exception("Dependent object not found","ObjectNotFound",r.dependentOn[h])),u[f]=!0,from=v[f]||{},from[i]=!0,v[f]=from}u!==null&&(s[i]=u)}for(b=[],e=[],l=0;l<n.length;l++)s.hasOwnProperty(l)||e.push(l);while(e.length>0){for(t=[].concat(e),e=[],o=0;o<t.length;o++){if(k=v[t[o]],typeof k!="undefined")for(a in k)delete s[a][t[o]],g(s[a])||(delete s[a],e.push(a));delete v[t[o]]}for(y=[],p=0;p<t.length;p++)d=n[t[p]],d.data.entityState!=$data.EntityState.Unchanged&&y.push(d);y.length>0&&b.push(y)}return b},getTraceString:function(){Guard.raise("Pure class")},setContext:function(n){this.context=n},supportedFieldOperations:{value:{length:{dataType:"number",allowedIn:"filter, map"},substr:{dataType:"string",allowedIn:"filter",parameters:[{name:"startFrom",dataType:"number"},{name:"length",dataType:"number"}]},toLowerCase:{dataType:"string"}},enumerable:!0,writable:!0},resolveFieldOperation:function(n,t,i){var r=this.supportedFieldOperations[n];return r||Guard.raise(new Exception("Field operation '"+n+"' is not supported by the provider")),i&&r.allowedIn&&((!(r.allowedIn instanceof Array)||r.allowedIn.some(function(n){return i===Container.resolveType(n)}))&&(r.allowedIn instanceof Array||i===Container.resolveType(r.allowedIn))||Guard.raise(new Exception(n+" not supported in: "+i.name))),r.name=n,r},supportedBinaryOperators:{value:{equal:{mapTo:"eq",dataType:"boolean"}},enumerable:!0,writable:!0},resolveBinaryOperator:function(n,t,i){var r=this.supportedBinaryOperators[n];return r||Guard.raise(new Exception("Binary operator '"+n+"' is not supported by the provider")),i&&r.allowedIn&&((!(r.allowedIn instanceof Array)||r.allowedIn.some(function(n){return i===Container.resolveType(n)}))&&(r.allowedIn instanceof Array||i===Container.resolveType(r.allowedIn))||Guard.raise(new Exception(n+" not supported in: "+i.name))),r.name=n,r},supportedUnaryOperators:{value:{not:{mapTo:"not"}},enumerable:!0,writable:!0},resolveUnaryOperator:function(n,t,i){var r=this.supportedUnaryOperators[n];return r||Guard.raise(new Exception("Unary operator '"+n+"' is not supported by the provider")),i&&r.allowedIn&&((!(r.allowedIn instanceof Array)||r.allowedIn.some(function(n){return i===Container.resolveType(n)}))&&(r.allowedIn instanceof Array||i===Container.resolveType(r.allowedIn))||Guard.raise(new Exception(n+" not supported in: "+i.name))),r.name=n,r},supportedSetOperations:{value:{toArray:{invokable:!0,allowedIn:[]}},enumerable:!0,writable:!0},resolveSetOperations:function(n,t,i){var u=this.supportedSetOperations[n],r;return u||Guard.raise(new Exception("Operation '"+n+"' is not supported by the provider")),r=u.allowedIn||[],i&&r&&((!(r instanceof Array)||r.some(function(n){return i===Container.resolveType(n)}))&&(r instanceof Array||i===Container.resolveType(r))||Guard.raise(new Exception(n+" not supported in: "+i.name))),u},makePhysicalTypeDefinition:function(){}},{onRegisterProvider:{value:new $data.Event},registerProvider:function(n,t){this.onRegisterProvider.fire({name:n,provider:t},this),$data.RegisteredStorageProviders=$data.RegisteredStorageProviders||[],$data.RegisteredStorageProviders[n]=t},getProvider:function(n){var t=$data.RegisteredStorageProviders[n];return t||console.warn("Provider not found: '"+n+"'"),t},isSupported:{get:function(){return!0},set:function(){}}}),function(){for(var r=["webSql","indexedDb","LocalStore"],n,u,f,i,t=0;t<r.length;t++)if(n=r[t],$data.StorageProviderLoader.isSupported(n)){u=$data.StorageProviderLoader.npmModules[n],$data.StorageProviderLoader.npmModules.local=u,f=$data.StorageProviderLoader.ProviderNames[n],$data.StorageProviderLoader.ProviderNames.local=f,$data.RegisteredStorageProviders=$data.RegisteredStorageProviders||[],i=$data.RegisteredStorageProviders[n],i?$data.StorageProviderBase.registerProvider("local",i):$data.StorageProviderBase.onRegisterProvider.attach(function(t,i){i.name===n&&$data.StorageProviderBase.registerProvider("local",i.provider)});break}}(),$data.Base.extend("$data.EntityWrapper",{getEntity:function(){Guard.raise("pure object")}}),typeof jQuery!="undefined"&&jQuery.ajax&&($data.ajax=$data.ajax||jQuery.ajax),typeof WinJS!="undefined"&&WinJS.xhr&&($data.ajax=$data.ajax||function(n){var i,t;$data.typeSystem.extend(n,{dataType:"json",headers:{}}),i={json:{accept:"application/json, text/javascript",convert:JSON.parse},text:{accept:"text/plain",convert:function(n){return n}},html:{accept:"text/html",convert:function(n){return n}},xml:{accept:"application/xml, text/xml",convert:function(n){return n}}},t=i[n.dataType.toLowerCase()],n.headers.Accept=t.accept;var r=n.success||$data.defaultSuccessCallback,u=n.error||$data.defaultErrorCallback,f=n.progress,e=function(n){var i=t.convert(n.responseText);r(i)},o=function(n){var i=t.convert(n.responseText);u(i)},s=f;WinJS.xhr(n).done(e,o,s)}),typeof Ext!="undefined"&&typeof Ext.Ajax&&($data.ajax=$data.ajax||function(n){Ext.Ajax.request(n)}),$data.ajax=$data.ajax||function(){var n=arguments[arguments.length-1],t=$data.typeSystem.createCallbackSetting(n);t.error("Not implemented")},$C("$data.modelBinder.FindProjectionVisitor",$data.Expressions.EntityExpressionVisitor,null,{VisitProjectionExpression:function(n){this.projectionExpression=n}}),$C("$data.modelBinder.ModelBinderConfigCompiler",$data.Expressions.EntityExpressionVisitor,null,{constructor:function(n,t,i){this._query=n,this._includes=t,this._isoDataProvider=i||!1},VisitSingleExpression:function(n){this._defaultModelBinder(n)},VisitSomeExpression:function(n){this._defaultModelBinder(n)},VisitEveryExpression:function(n){this._defaultModelBinder(n)},VisitToArrayExpression:function(n){this._defaultModelBinder(n)},VisitFirstExpression:function(n){this._defaultModelBinder(n)},VisitForEachExpression:function(n){this._defaultModelBinder(n)},VisitServiceOperationExpression:function(n){var i=Container.resolveType(n.cfg.returnType),t;typeof i.isAssignableTo=="function"&&i.isAssignableTo($data.Queryable)||i===$data.Array?this._defaultModelBinder(n):(t=Container.createqueryBuilder(),t.modelBinderConfig.$type=i,typeof i.isAssignableTo=="function"&&i.isAssignableTo($data.Entity)?t.modelBinderConfig.$selector=["json:"+n.cfg.serviceName]:t.modelBinderConfig.$source=n.cfg.serviceName,this.VisitExpression(n,t),t.resetModelBinderProperty(),this._query.modelBinderConfig=t.modelBinderConfig)},VisitCountExpression:function(){var n=Container.createqueryBuilder();n.modelBinderConfig.$type=$data.Array,n.selectModelBinderProperty("$item"),n.modelBinderConfig.$type=$data.Integer,n.modelBinderConfig.$source="cnt",n.resetModelBinderProperty(),this._query.modelBinderConfig=n.modelBinderConfig},VisitBatchDeleteExpression:function(){var n=Container.createqueryBuilder();n.modelBinderConfig.$type=$data.Array,n.selectModelBinderProperty("$item"),n.modelBinderConfig.$type=$data.Integer,n.modelBinderConfig.$source="cnt",n.resetModelBinderProperty(),this._query.modelBinderConfig=n.modelBinderConfig},VisitConstantExpression:function(n,t){t.modelBinderConfig.$type=n.type,t.modelBinderConfig.$value=n.value},VisitExpression:function(n,t){var i=Container.createFindProjectionVisitor();i.Visit(n),i.projectionExpression?this.Visit(i.projectionExpression,t):this.DefaultSelection(t,this._query.defaultType,this._includes)},_defaultModelBinder:function(n){var t=Container.createqueryBuilder();t.modelBinderConfig.$type=$data.Array,this._isoDataProvider&&(t.modelBinderConfig.$selector=["json:d.results","json:d","json:results"]),t.modelBinderConfig.$item={},t.selectModelBinderProperty("$item"),this.VisitExpression(n,t),t.resetModelBinderProperty(),this._query.modelBinderConfig=t.modelBinderConfig},_addPropertyToModelBinderConfig:function(n,t){var i=this._query.context._storageModel.getStorageModel(n);n.memberDefinitions?n.memberDefinitions.getPublicMappedProperties().forEach(function(n){var r,u;i&&(!i||i.Associations[n.name]||i.ComplexTypes[n.name])||(!i&&this._query.context.storageProvider.supportedDataTypes.indexOf(Container.resolveType(n.dataType))<0?(t.selectModelBinderProperty(n.name),r=Container.resolveType(n.dataType),t.modelBinderConfig.$type=r,t.modelBinderConfig.$selector=this._isoDataProvider?["json:"+n.name+".results","json:"+n.name]:"json:"+n.name,r===$data.Array&&n.elementType?(t.selectModelBinderProperty("$item"),u=Container.resolveType(n.elementType),t.modelBinderConfig.$type=u,this._addPropertyToModelBinderConfig(u,t),t.popModelBinderProperty()):this._addPropertyToModelBinderConfig(r,t),t.popModelBinderProperty()):(n.key&&t.addKeyField(n.name),t.modelBinderConfig[n.name]=n.concurrencyMode===$data.ConcurrencyMode.Fixed?{$selector:"json:__metadata",$source:"etag"}:n.name))},this):(t._binderConfig.$item=t._binderConfig.$item||{},t.modelBinderConfig=t._binderConfig.$item),i&&this._addComplexTypeProperties(i.ComplexTypes,t)},_addComplexTypeProperties:function(n,t){n.forEach(function(n){var f,i,u,r;if(n.ToType!==$data.Array)t.selectModelBinderProperty(n.FromPropertyName),t.modelBinderConfig.$type=n.ToType,t.modelBinderConfig.$selector=this._isoDataProvider?["json:"+n.FromPropertyName+".results","json:"+n.FromPropertyName]:"json:"+n.FromPropertyName,this._addPropertyToModelBinderConfig(n.ToType,t),t.popModelBinderProperty();else if(f=n.ToType,i=Container.resolveType(n.FromType.memberDefinitions.getMember(n.FromPropertyName).elementType),f===$data.Array&&i&&i.isAssignableTo&&i.isAssignableTo($data.Entity)){for(config={$type:$data.Array,$selector:"json:"+n.FromPropertyName,$item:{$type:i}},u=i.memberDefinitions.getPublicMappedProperties(),r=0;r<u.length;r++)config.$item[u[r].name]={$type:u[r].type,$source:u[r].name};t.modelBinderConfig[n.FromPropertyName]=config}else t.modelBinderConfig[n.FromPropertyName]={$type:n.ToType,$source:n.FromPropertyName}},this)},DefaultSelection:function(n,t,i){n.modelBinderConfig.$type=t;var r=this._query.context._storageModel.getStorageModel(t);this._addPropertyToModelBinderConfig(t,n),i&&i.forEach(function(t){for(var i=t.name.split("."),f=null,e=r,u=0;u<i.length;u++)n.modelBinderConfig.$item&&n.selectModelBinderProperty("$item"),n.selectModelBinderProperty(i[u]),f=e.Associations[i[u]],e=this._query.context._storageModel.getStorageModel(f.ToType);for(n.modelBinderConfig.$selector=this._isoDataProvider?["json:"+i[i.length-1]+".results","json:"+i[i.length-1]]:"json:"+i[i.length-1],f.ToMultiplicity==="*"?(n.modelBinderConfig.$type=$data.Array,n.selectModelBinderProperty("$item"),n.modelBinderConfig.$type=t.type,this._addPropertyToModelBinderConfig(t.type,n),n.popModelBinderProperty()):(n.modelBinderConfig.$type=t.type,this._addPropertyToModelBinderConfig(t.type,n)),u=0;u<i.length;u++)n.popModelBinderProperty()},this)},VisitProjectionExpression:function(n,t){this.hasProjection=!0,this.Visit(n.selector,t),n.selector&&n.selector.expression instanceof $data.Expressions.ObjectLiteralExpression&&(t.modelBinderConfig.$type=n.projectionAs||t.modelBinderConfig.$type||$data.Object)},VisitParametricQueryExpression:function(n,t){n.expression instanceof $data.Expressions.EntityExpression||n.expression instanceof $data.Expressions.EntitySetExpression?this.VisitEntityAsProjection(n,t):this.Visit(n.expression,t)},VisitEntityAsProjection:function(n,t){this.mapping="",this.Visit(n.expression,t);var i;this.mapping&&this._includes instanceof Array&&(i=this._includes.filter(function(n){return n.name.indexOf(this.mapping+".")===0},this),i=i.map(function(n){return{name:n.name.replace(this.mapping+".",""),type:n.type}},this),i.length>0&&console.warn("WARN: include for mapped properties is not supported!")),n.expression instanceof $data.Expressions.EntityExpression?this.DefaultSelection(t,n.expression.entityType):n.expression instanceof $data.Expressions.EntitySetExpression&&(t.modelBinderConfig.$type=$data.Array,t.modelBinderConfig.$item={},t.selectModelBinderProperty("$item"),this.DefaultSelection(t,n.expression.elementType),t.popModelBinderProperty())},VisitEntityFieldExpression:function(n,t){this.Visit(n.source,t),this.Visit(n.selector,t)},VisitMemberInfoExpression:function(n,t){t.modelBinderConfig.$type=n.memberDefinition.type,n.memberDefinition.storageModel&&n.memberName in n.memberDefinition.storageModel.ComplexTypes?this._addPropertyToModelBinderConfig(Container.resolveType(n.memberDefinition.type),t):t.modelBinderConfig.$type&&Container.resolveType(t.modelBinderConfig.$type).isAssignableTo&&Container.resolveType(t.modelBinderConfig.$type).isAssignableTo($data.Entity)||(t.modelBinderConfig.$source=n.memberName)},VisitEntitySetExpression:function(n,t){n.source instanceof $data.Expressions.EntityExpression&&(this.Visit(n.source,t),this.Visit(n.selector,t))},VisitComplexTypeExpression:function(n,t){if(this.Visit(n.source,t),this.Visit(n.selector,t),"$selector"in t.modelBinderConfig&&t.modelBinderConfig.$selector.length>0)if(t.modelBinderConfig.$selector instanceof $data.Array){var i=t.modelBinderConfig.$selector[1];t.modelBinderConfig.$selector[0]=i+"."+n.selector.memberName+".results",t.modelBinderConfig.$selector[1]=i+"."+n.selector.memberName}else t.modelBinderConfig.$selector+="."+n.selector.memberName;else t.modelBinderConfig.$selector=this._isoDataProvider?["json:"+n.selector.memberName+".results","json:"+n.selector.memberName]:"json:"+n.selector.memberName},VisitEntityExpression:function(n,t){this.Visit(n.source,t)},VisitAssociationInfoExpression:function(n,t){if("$selector"in t.modelBinderConfig&&t.modelBinderConfig.$selector.length>0)if(t.modelBinderConfig.$selector instanceof $data.Array){var i=t.modelBinderConfig.$selector[1];t.modelBinderConfig.$selector[0]=i+"."+n.associationInfo.FromPropertyName+".results",t.modelBinderConfig.$selector[1]=i+"."+n.associationInfo.FromPropertyName}else t.modelBinderConfig.$selector+="."+n.associationInfo.FromPropertyName;else t.modelBinderConfig.$selector=this._isoDataProvider?["json:"+n.associationInfo.FromPropertyName+".results","json:"+n.associationInfo.FromPropertyName]:"json:"+n.associationInfo.FromPropertyName;this.mapping&&this.mapping.length>0&&(this.mapping+="."),this.mapping+=n.associationInfo.FromPropertyName},VisitObjectLiteralExpression:function(n,t){t.modelBinderConfig.$type=$data.Object,n.members.forEach(function(n){this.Visit(n,t)},this)},VisitObjectFieldExpression:function(n,t){t.selectModelBinderProperty(n.fieldName),n.expression instanceof $data.Expressions.EntityExpression||n.expression instanceof $data.Expressions.EntitySetExpression?this.VisitEntityAsProjection(n,t):this.Visit(n.expression,t),t.popModelBinderProperty()}}),$data.Class.define("$data.Authentication.AuthenticationBase",null,null,{constructor:function(n){this.configuration=n||{},this.Authenticated=!1},Login:function(){Guard.raise("Pure class")},Logout:function(){Guard.raise("Pure class")},CreateRequest:function(){Guard.raise("Pure class")}},null),$data.Class.define("$data.Authentication.Anonymous",$data.Authentication.AuthenticationBase,null,{constructor:function(n){this.configuration=n||{},this.Authenticated=!1},Login:function(){},Logout:function(){},CreateRequest:function(n){$data.ajax(n)}},null),$data.Class.define("$data.Authentication.FacebookAuth",$data.Authentication.AuthenticationBase,null,{constructor:function(n){this.configuration=$data.typeSystem.extend({Url_code:"",type_code:"",scope:"",Url_token:"",type_token:"",access_token:"",app_id:""},n)},Login:function(n){if(!this.Authenticated){var t=this;t.configuration.stateCallbacks=n||{},$data.ajax({url:this.configuration.Url_code,data:"type="+t.configuration.type_code+"&client_id="+t.configuration.app_id+"&scope="+t.configuration.scope,type:"POST",dataType:"json",success:function(n){typeof t.configuration.stateCallbacks.pending=="function"&&t.configuration.stateCallbacks.pending(n),t._processRequestToken(n),t.Authenticated=!0},error:function(){typeof t.configuration.stateCallbacks.error=="function"&&t.configuration.stateCallbacks.error(arguments)}})}},Logout:function(){this.Authenticated=!1},CreateRequest:function(n){var i,t;n&&(i=this,n.url.indexOf("access_token=")===-1&&n.url&&this.Authenticated&&(t="?",n.url.indexOf(t)>0&&(t="&"),this.configuration.access_token&&(n.url=n.url+t+"access_token="+this.configuration.access_token)),$data.ajax(n))},_processRequestToken:function(n){var t=this;$data.ajax({url:t.configuration.Url_token,data:"type="+t.configuration.type_token+"&client_id="+t.configuration.app_id+"&code="+n.code,type:"POST",dataType:"json",success:function(n){t.configuration.access_token=n.access_token,typeof t.configuration.stateCallbacks.success=="function"&&t.configuration.stateCallbacks.success(n)},error:function(obj){var data=eval("("+obj.responseText+")");data.error&&(data.error.message=="authorization_pending"?setTimeout(function(){t._processRequestToken(n)},2e3):"authorization_declined"&&typeof t.configuration.stateCallbacks.abort=="function"&&t.configuration.stateCallbacks.abort(arguments))}})}},null),$data.Class.define("$data.Authentication.BasicAuth.BasicAuth",$data.Authentication.AuthenticationBase,null,{constructor:function(n){this.configuration=$data.typeSystem.extend({Username:"",Password:""},n)},Login:function(n){n&&typeof n.pending=="function"&&n.pending()},Logout:function(){},CreateRequest:function(n){if(n){var t=this,i=n.beforeSend;n.beforeSend=function(n){n.setRequestHeader("Authorization","Basic  "+t.__encodeBase64(t.configuration.Username+":"+t.configuration.Password)),typeof i=="function"&&i(n)},$data.ajax(n)}},__encodeBase64:function(n){var u="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";input=n;var s="",f,t,i="",h,c,e,r="",o=0;do f=input.charCodeAt(o++),t=input.charCodeAt(o++),i=input.charCodeAt(o++),h=f>>2,c=(f&3)<<4|t>>4,e=(t&15)<<2|i>>6,r=i&63,isNaN(t)?e=r=64:isNaN(i)&&(r=64),s=s+u.charAt(h)+u.charAt(c)+u.charAt(e)+u.charAt(r),f=t=i="",h=c=e=r="";while(o<input.length);return s}},null),$data.Class.define("$data.MetadataLoaderClass",null,null,{load:function(n,t,i){var r={EntityBaseClass:"$data.Entity",ContextBaseClass:"$data.EntityContext",AutoCreateContext:!1,DefaultNamespace:("ns"+Math.random()).replace(".","")+n.replace(/[^\w]/g,"_"),ContextInstanceName:"context",EntitySetBaseClass:"$data.EntitySet",CollectionBaseClass:"Array",url:n,user:undefined,password:undefined,withCredentials:undefined,httpHeaders:undefined},n,u;if($data.typeSystem.extend(r,i||{}),r.DefaultNamespace&&r.DefaultNamespace.lastIndexOf(".")!==r.DefaultNamespace.length-1&&(r.DefaultNamespace+="."),this.factoryCache=this.factoryCache||{},t=$data.typeSystem.createCallbackSetting(t),n in this.factoryCache){t.success.apply({},this.factoryCache[n]);return}r.url?(r.SerivceUri=r.url.replace("/$metadata",""),r.metadataUri=r.url.indexOf("/$metadata")===-1?r.url.replace(/\/+$/,"")+"/$metadata":r.url):t.error("metadata url is missing"),u=this,u._loadXMLDoc(r,function(n,i){if(i.statusCode<200||i.statusCode>299){t.error(i);return}var f=u._findVersion(n);u.xsltRepoUrl?(console.log("XSLT: "+u.xsltRepoUrl+u._supportedODataVersionXSLT[f.version]),u._loadXMLDoc({metadataUri:u.xsltRepoUrl+u._supportedODataVersionXSLT[f.version],user:r.user,password:r.password,httpHeaders:r.httpHeaders},function(i,e){if(e.statusCode<200||e.statusCode>299){t.error(e);return}u._transform(t,f,n,i,r)})):u._transform(t,f,n,undefined,r)})},debugMode:{type:"bool",value:!1},xsltRepoUrl:{type:"string",value:""},createFactoryFunc:function(n,t){var i=this;return function(i){if(n){var r=$data.typeSystem.extend({name:"oData",oDataServiceHost:t.SerivceUri,user:t.user,password:t.password,withCredentials:t.withCredentials},i);return new n(r)}return null}},_transform:function(callBack,versionInfo,xml,xsl,cnf){var self=this,codeText=self._processResults(cnf.url,versionInfo,xml,xsl,cnf),ctxType,factoryFn;eval(codeText),ctxType=$data.generatedContexts.pop(),factoryFn=self.createFactoryFunc(ctxType,cnf),this.factoryCache[cnf.url]=[factoryFn,ctxType],factoryFn.type=ctxType,factoryFn.codeText=codeText,self.debugMode?callBack.success(factoryFn,ctxType,codeText):callBack.success(factoryFn,ctxType)},_loadXMLDoc:function(n,t){var i=new XMLHttpRequest;i.open("GET",n.metadataUri,!0),n.httpHeaders&&Object.keys(n.httpHeaders).forEach(function(t){i.setRequestHeader(t,n.httpHeaders[t])}),i.onreadystatechange=function(){if(i.readyState===4){var r={requestUri:n.metadataUri,statusCode:i.status,statusText:i.statusText};t(i.responseXML||i.responseText,r)}},n.user&&n.password&&(!n.httpHeaders||n.httpHeaders&&!n.httpHeaders.Authorization)&&i.setRequestHeader("Authorization","Basic "+this.__encodeBase64(n.user+":"+n.password)),i.send("")},_processResults:function(n,t,i,r,u){var c=this.getCurrentXSLTVersion(t,i),s,f,h,l,a,v,e,o;if(window.ActiveXObject){if(o=new ActiveXObject("Msxml2.XSLTemplate.6.0"),s=new ActiveXObject("Msxml2.FreeThreadedDOMDocument.6.0"),s.async=!1,r?s.load(r):s.loadXML(c),s.parseError.errorCode!=0)l=s.parseError;else if(o.stylesheet=s,h=new ActiveXObject("Msxml2.DOMDocument.6.0"),h.async=!1,h.load(i),h.parseError.errorCode!=0)l=h.parseError;else return f=o.createProcessor(),f.input=h,f.addParameter("SerivceUri",u.SerivceUri),f.addParameter("EntityBaseClass",u.EntityBaseClass),f.addParameter("ContextBaseClass",u.ContextBaseClass),f.addParameter("AutoCreateContext",u.AutoCreateContext),f.addParameter("ContextInstanceName",u.ContextInstanceName),f.addParameter("EntitySetBaseClass",u.EntitySetBaseClass),f.addParameter("CollectionBaseClass",u.CollectionBaseClass),f.addParameter("DefaultNamespace",u.DefaultNamespace),f.transform(),f.output;return""}return typeof document!="undefined"&&document.implementation&&document.implementation.createDocument?(r?a=r:(v=new DOMParser,a=v.parseFromString(c,"text/xml")),e=new XSLTProcessor,e.importStylesheet(a),e.setParameter(null,"SerivceUri",u.SerivceUri),e.setParameter(null,"EntityBaseClass",u.EntityBaseClass),e.setParameter(null,"ContextBaseClass",u.ContextBaseClass),e.setParameter(null,"AutoCreateContext",u.AutoCreateContext),e.setParameter(null,"ContextInstanceName",u.ContextInstanceName),e.setParameter(null,"EntitySetBaseClass",u.EntitySetBaseClass),e.setParameter(null,"CollectionBaseClass",u.CollectionBaseClass),e.setParameter(null,"DefaultNamespace",u.DefaultNamespace),resultDocument=e.transformToFragment(i,document),resultDocument.textContent):typeof module!="undefined"&&typeof require!="undefined"?(o=require("node_xslt"),o.transform(o.readXsltString(c),o.readXmlString(i),["SerivceUri","'"+u.SerivceUri+"'","EntityBaseClass","'"+u.EntityBaseClass+"'","ContextBaseClass","'"+u.ContextBaseClass+"'","AutoCreateContext","'"+u.AutoCreateContext+"'","ContextInstanceName","'"+u.ContextInstanceName+"'","EntitySetBaseClass","'"+u.EntitySetBaseClass+"'","CollectionBaseClass","'"+u.CollectionBaseClass+"'","DefaultNamespace","'"+u.DefaultNamespace+"'"])):void 0},_findVersion:function(n){var i,t,u,r;if(typeof n=="object"&&"getElementsByTagName"in n)return i="http://schemas.microsoft.com/ado/2008/09/edm",t=n.getElementsByTagName("Schema"),t&&(t=t[0]),t&&(t=t.attributes),t&&(t=t.getNamedItem("xmlns")),t&&(i=t.value),u=this._supportedODataVersions[i],{ns:i,version:u||"unknown"};if(typeof module!="undefined"&&typeof require!="undefined"){var e=n,f="http://schemas.microsoft.com/ado/2008/09/edm",i="nodejs";for(r in this._supportedODataVersions)if(e.search(new RegExp('<Schema.+xmlns="'+r+'"',"gi"))>=0){f=r,i=this._supportedODataVersions[r];break}return{ns:f,version:i}}},_supportedODataVersions:{value:{"http://schemas.microsoft.com/ado/2006/04/edm":"V1","http://schemas.microsoft.com/ado/2008/09/edm":"V2","http://schemas.microsoft.com/ado/2009/11/edm":"V3","http://schemas.microsoft.com/ado/2007/05/edm":"V11"}},_supportedODataVersionXSLT:{value:{V1:"JayDataContextGen$my.contexterator_OData_V1.xslt",V2:"JayDataContextGenerator_OData_V2.xslt",V3:"JayDataContextGenerator_OData_V3.xslt",V11:"JayDataContextGenerator_OData_V11.xslt"}},getCurrentXSLTVersion:function(n){return this._metadataConverterXSLT.replace("@@VERSIONNS@@",n.ns).replace("@@VERSION@@",n.version)},__encodeBase64:function(n){var u="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",f=n,h="",e,t,i="",c,l,o,r="",s=0;do e=f.charCodeAt(s++),t=f.charCodeAt(s++),i=f.charCodeAt(s++),c=e>>2,l=(e&3)<<4|t>>4,o=(t&15)<<2|i>>6,r=i&63,isNaN(t)?o=r=64:isNaN(i)&&(r=64),h=h+u.charAt(c)+u.charAt(l)+u.charAt(o)+u.charAt(r),e=t=i="",c=l=o=r="";while(s<f.length);return h},_metadataConverterXSLT:{type:"string",value:'<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform" \r\n                xmlns:edm="@@VERSIONNS@@" \r\n                xmlns:m="http://schemas.microsoft.com/ado/2007/08/dataservices/metadata" \r\n                xmlns:annot="http://schemas.microsoft.com/ado/2009/02/edm/annotation" \r\n                xmlns:exsl="http://exslt.org/common" \r\n                xmlns:msxsl="urn:schemas-microsoft-com:xslt" exclude-result-prefixes="msxsl">\r\n\r\n  <xsl:key name="entityType" match="edm:EntityType" use="concat(string(../@Namespace),\'.\', string(@Name))"/>\r\n  <xsl:key name="associations" match="edm:Association" use="concat(string(../@Namespace),\'.\', string(@Name))"/>\r\n\r\n  <xsl:strip-space elements="property item unprocessed"/>\r\n  <xsl:output method="text" indent="no"  />\r\n  <xsl:param name="contextNamespace" />\r\n\r\n  <xsl:param name="SerivceUri" />\r\n  <xsl:param name="EntityBaseClass"/>\r\n  <xsl:param name="ContextBaseClass"/>\r\n  <xsl:param name="AutoCreateContext"/>\r\n  <xsl:param name="ContextInstanceName"/>\r\n  <xsl:param name="EntitySetBaseClass"/>\r\n  <xsl:param name="CollectionBaseClass"/>\r\n  <xsl:param name="DefaultNamespace"/>\r\n\r\n  <xsl:template match="/">\r\n\r\n/*//////////////////////////////////////////////////////////////////////////////////////\r\n////// Autogenerated by JaySvcUtil.exe http://JayData.org for more info        /////////\r\n//////                             oData @@VERSION@@                                    /////////\r\n//////////////////////////////////////////////////////////////////////////////////////*/\r\n(function(global, $data, undefined) {\r\n\r\n<xsl:for-each select="//edm:EntityType | //edm:ComplexType" xml:space="default">\r\n  <xsl:message terminate="no">Info: generating type <xsl:value-of select="concat(../@Namespace, \'.\', @Name)"/>\r\n<\/xsl:message>\r\n  <xsl:variable name="props">\r\n    <xsl:apply-templates select="*" />\r\n  <\/xsl:variable>\r\n  <xsl:text xml:space="preserve">  <\/xsl:text><xsl:value-of select="$EntityBaseClass"  />.extend(\'<xsl:value-of select="concat($DefaultNamespace,../@Namespace)"/>.<xsl:value-of select="@Name"/>\', {\r\n    <xsl:choose><xsl:when test="function-available(\'msxsl:node-set\')">\r\n    <xsl:for-each select="msxsl:node-set($props)/*">\r\n      <xsl:value-of select="."/><xsl:if test="position() != last()">,\r\n    <\/xsl:if><\/xsl:for-each>\r\n  <\/xsl:when>\r\n  <xsl:otherwise>\r\n    <xsl:for-each select="exsl:node-set($props)/*">\r\n      <xsl:value-of select="."/><xsl:if test="position() != last()">,\r\n    <\/xsl:if><\/xsl:for-each>\r\n    <\/xsl:otherwise>\r\n    <\/xsl:choose>\r\n  });\r\n  \r\n<\/xsl:for-each>\r\n\r\n<xsl:for-each select="//edm:EntityContainer">\r\n  <xsl:text xml:space="preserve">  <\/xsl:text><xsl:value-of select="$ContextBaseClass"  />.extend(\'<xsl:value-of select="concat(concat($DefaultNamespace,../@Namespace), \'.\', @Name)"/>\', {\r\n    <xsl:for-each select="edm:EntitySet | edm:FunctionImport">\r\n      <xsl:apply-templates select="."><\/xsl:apply-templates><xsl:if test="position() != last()">,\r\n    <\/xsl:if>\r\n    <\/xsl:for-each>\r\n  });\r\n\r\n  $data.generatedContexts = $data.generatedContexts || [];\r\n  $data.generatedContexts.push(<xsl:value-of select="concat(concat($DefaultNamespace,../@Namespace), \'.\', @Name)" />);\r\n  <xsl:if test="$AutoCreateContext = \'true\'">\r\n  /*Context Instance*/\r\n  <xsl:value-of select="$DefaultNamespace"/><xsl:value-of select="$ContextInstanceName" /> = new <xsl:value-of select="concat(concat($DefaultNamespace,../@Namespace), \'.\', @Name)" />( { name:\'oData\', oDataServiceHost: \'<xsl:value-of select="$SerivceUri" />\' });\r\n<\/xsl:if>\r\n\r\n<\/xsl:for-each>\r\n      \r\n})(window, $data);\r\n      \r\n    <\/xsl:template>\r\n\r\n  <xsl:template match="edm:Key"><\/xsl:template>\r\n\r\n  <xsl:template match="edm:FunctionImport">\'<xsl:value-of select="@Name"/>\': $data.EntityContext.generateServiceOperation({ serviceName:\'<xsl:value-of select="@Name"/>\', returnType: <xsl:apply-templates select="." mode="render-return-config" />, <xsl:apply-templates select="." mode="render-elementType-config" />params: [<xsl:for-each select="edm:Parameter">{ <xsl:value-of select="@Name"/>: \'<xsl:apply-templates select="@Type" mode="render-functionImport-type" />\' }<xsl:if test="position() != last()">,<\/xsl:if>\r\n    <\/xsl:for-each>], method: \'<xsl:value-of select="@m:HttpMethod"/>\' })<\/xsl:template>\r\n\r\n  <xsl:template match="@Type | @ReturnType" mode="render-functionImport-type">\r\n    <xsl:variable name="curr" select="."/>\r\n    <xsl:choose>\r\n      <xsl:when test="//edm:Schema[starts-with($curr, @Namespace)]"> \r\n        <xsl:value-of select="concat($DefaultNamespace,$curr)" />\r\n      <\/xsl:when>\r\n      <xsl:otherwise> \r\n        <xsl:value-of select="$curr"/>\r\n      <\/xsl:otherwise>\r\n    <\/xsl:choose>\r\n\r\n  <\/xsl:template>\r\n  \r\n  <xsl:template match="edm:FunctionImport" mode="render-return-config">\r\n    <xsl:choose>\r\n      <xsl:when test="not(@ReturnType)">null<\/xsl:when>\r\n      <xsl:when test="starts-with(@ReturnType, \'Collection\')">$data.Queryable<\/xsl:when>\r\n      <xsl:otherwise> \'<xsl:apply-templates select="@ReturnType" mode="render-functionImport-type" />\' <\/xsl:otherwise>\r\n    <\/xsl:choose>\r\n  <\/xsl:template>\r\n  \r\n  <xsl:template match="edm:FunctionImport" mode="render-elementType-config">\r\n    <xsl:if test="starts-with(@ReturnType, \'Collection\')">\r\n      <xsl:variable name="len" select="string-length(@ReturnType)-12"/>\r\n      <xsl:variable name="curr" select="substring(@ReturnType,12,$len)"/>\r\n      <xsl:variable name="ElementType" >\r\n        <xsl:choose>\r\n          <xsl:when test="//edm:Schema[starts-with($curr, @Namespace)]">\r\n            <xsl:value-of select="concat($DefaultNamespace,$curr)" />\r\n          <\/xsl:when>\r\n          <xsl:otherwise>\r\n            <xsl:value-of select="$curr" />\r\n          <\/xsl:otherwise>\r\n        <\/xsl:choose>\r\n      <\/xsl:variable>elementType: \'<xsl:value-of select="$ElementType"/>\', <\/xsl:if>\r\n  <\/xsl:template>\r\n\r\n  <xsl:template match="edm:EntitySet">\'<xsl:value-of select="@Name"/>\': { type: <xsl:value-of select="$EntitySetBaseClass"  />, elementType: <xsl:value-of select="concat($DefaultNamespace,@EntityType)"/> }<\/xsl:template>\r\n  \r\n  <xsl:template match="edm:Property | edm:NavigationProperty">\r\n    <property>\r\n    <xsl:variable name="memberDefinition">\r\n      <xsl:if test="parent::edm:EntityType/edm:Key/edm:PropertyRef[@Name = current()/@Name]"><attribute name="key">true<\/attribute><\/xsl:if>\r\n      <xsl:apply-templates select="@*[local-name() != \'Name\']" mode="render-field" />\r\n    <\/xsl:variable>\'<xsl:value-of select="@Name"/>\': { <xsl:choose><xsl:when test="function-available(\'msxsl:node-set\')"><xsl:for-each select="msxsl:node-set($memberDefinition)/*">\'<xsl:if test="@extended = \'true\'">$<\/xsl:if><xsl:value-of select="@name"/>\':<xsl:value-of select="."/>\r\n      <xsl:if test="position() != last()">,<xsl:text> <\/xsl:text>\r\n    <\/xsl:if> <\/xsl:for-each><\/xsl:when>\r\n  <xsl:otherwise><xsl:for-each select="exsl:node-set($memberDefinition)/*">\'<xsl:if test="@extended = \'true\'">$<\/xsl:if><xsl:value-of select="@name"/>\':<xsl:value-of select="."/>\r\n      <xsl:if test="position() != last()">,<xsl:text> <\/xsl:text>\r\n    <\/xsl:if> <\/xsl:for-each><\/xsl:otherwise>\r\n    <\/xsl:choose> }<\/property>\r\n<\/xsl:template>\r\n  \r\n  <xsl:template match="@Name" mode="render-field">\r\n  <\/xsl:template>\r\n\r\n  <xsl:template match="@Type" mode="render-field">\r\n    <xsl:choose>\r\n      <xsl:when test="starts-with(., \'Collection\')">\r\n        <attribute name="type">\'Array\'<\/attribute>\r\n        <xsl:variable name="len" select="string-length(.)-12"/>\r\n        <xsl:choose>\r\n          <xsl:when test="starts-with(., ../../../@Namespace)">\r\n            <attribute name="elementType">\'<xsl:value-of select="$DefaultNamespace"/><xsl:value-of select="substring(.,12,$len)" />\'<\/attribute>\r\n          <\/xsl:when>\r\n          <xsl:otherwise>\r\n            <attribute name="elementType">\'<xsl:value-of select="substring(.,12,$len)" />\'<\/attribute>\r\n          <\/xsl:otherwise>\r\n        <\/xsl:choose>\r\n      <\/xsl:when>\r\n      <xsl:when test="starts-with(., ../../../@Namespace)">\r\n        <attribute name="type">\'<xsl:value-of select="$DefaultNamespace"/><xsl:value-of select="."/>\'<\/attribute>\r\n      <\/xsl:when>\r\n      <xsl:otherwise>\r\n        <attribute name="type">\'<xsl:value-of select="."/>\'<\/attribute>\r\n      <\/xsl:otherwise>\r\n    <\/xsl:choose>\r\n  <\/xsl:template>\r\n\r\n  <xsl:template match="@ConcurrencyMode" mode="render-field">\r\n    <attribute name="concurrencyMode">$data.ConcurrencyMode.<xsl:value-of select="."/><\/attribute>\r\n  <\/xsl:template>\r\n\r\n  <xsl:template match="@Nullable" mode="render-field">\r\n    <attribute name="nullable"><xsl:value-of select="."/><\/attribute>\r\n    \r\n    <xsl:if test=". = \'false\'">\r\n      <xsl:choose>\r\n        <xsl:when test="parent::edm:Property/@annot:StoreGeneratedPattern = \'Identity\' or parent::edm:Property/@annot:StoreGeneratedPattern = \'Computed\'"><\/xsl:when>\r\n        <xsl:otherwise><attribute name="required">true<\/attribute><\/xsl:otherwise>\r\n      <\/xsl:choose>\r\n    <\/xsl:if>\r\n  <\/xsl:template>\r\n\r\n  <xsl:template match="@annot:StoreGeneratedPattern" mode="render-field">\r\n    <xsl:if test=". != \'None\'"><attribute name="computed">true<\/attribute><\/xsl:if>    \r\n  <\/xsl:template>\r\n\r\n  <xsl:template match="@MaxLength" mode="render-field">\r\n    <attribute name="maxLength">\r\n      <xsl:choose>\r\n        <xsl:when test="string(.) = \'Max\'">Number.POSITIVE_INFINITY<\/xsl:when>\r\n        <xsl:otherwise>\r\n          <xsl:value-of select="."/>\r\n        <\/xsl:otherwise>\r\n      <\/xsl:choose>\r\n    <\/attribute>\r\n  <\/xsl:template>\r\n\r\n  <xsl:template match="@FixedLength | @Unicode | @Precision | @Scale" mode="render-field">\r\n  <\/xsl:template>\r\n  <xsl:template match="@*" mode="render-field">\r\n    <xsl:variable name="nameProp">\r\n      <xsl:choose>\r\n        <xsl:when test="substring-after(name(), \':\') != \'\'">\r\n          <xsl:value-of select="substring-after(name(), \':\')"/>\r\n        <\/xsl:when>\r\n        <xsl:otherwise>\r\n          <xsl:value-of select="name()"/>\r\n        <\/xsl:otherwise>\r\n      <\/xsl:choose>\r\n    <\/xsl:variable>\r\n    <xsl:element name="attribute"><xsl:attribute name="extended">true<\/xsl:attribute><xsl:attribute name="name"><xsl:value-of select="$nameProp"/><\/xsl:attribute>\'<xsl:value-of select="."/>\'<\/xsl:element>\r\n  <\/xsl:template>\r\n\r\n  <xsl:template match="@Relationship" mode="render-field">\r\n    <xsl:variable name="relationName" select="string(../@ToRole)"/>\r\n    <xsl:variable name="relationshipName" select="string(.)" />\r\n    <xsl:variable name="relation" select="key(\'associations\',string(.))/edm:End[@Role = $relationName]" />\r\n    <xsl:variable name="otherName" select="../@FromRole" />\r\n    <xsl:variable name="otherProp" select="//edm:NavigationProperty[@ToRole = $otherName and @Relationship = $relationshipName]" />\r\n    <xsl:variable name="m" select="$relation/@Multiplicity" />\r\n    <xsl:choose>\r\n      <xsl:when test="$m = \'*\'">\r\n        <attribute name="type">\'<xsl:value-of select="$CollectionBaseClass"/>\'<\/attribute>\r\n        <attribute name="elementType">\'<xsl:value-of select="$DefaultNamespace"/><xsl:value-of select="$relation/@Type"/>\'<\/attribute>\r\n        <xsl:if test="not($otherProp/@Name)">\r\n          <attribute name="inverseProperty">\'$$unbound\'<\/attribute><\/xsl:if>\r\n        <xsl:if test="$otherProp/@Name">\r\n          <attribute name="inverseProperty">\'<xsl:value-of select="$otherProp/@Name"/>\'<\/attribute><\/xsl:if>\r\n      <\/xsl:when>\r\n      <xsl:when test="$m = \'0..1\'">\r\n        <attribute name="type">\'<xsl:value-of select="$DefaultNamespace"/><xsl:value-of select="$relation/@Type"/>\'<\/attribute>\r\n        <xsl:choose>\r\n          <xsl:when test="$otherProp">\r\n            <attribute name="inverseProperty">\'<xsl:value-of select="$otherProp/@Name"/>\'<\/attribute>\r\n          <\/xsl:when >\r\n          <xsl:otherwise>\r\n            <attribute name="inverseProperty">\'$$unbound\'<\/attribute>\r\n            <xsl:message terminate="no">  Warning: inverseProperty other side missing: <xsl:value-of select="."/>\r\n          <\/xsl:message>\r\n          <\/xsl:otherwise>\r\n        <\/xsl:choose>\r\n      <\/xsl:when>\r\n      <xsl:when test="$m = \'1\'">\r\n        <attribute name="type">\'<xsl:value-of select="$DefaultNamespace"/><xsl:value-of select="$relation/@Type"/>\'<\/attribute>\r\n        <attribute name="required">true<\/attribute>\r\n        <xsl:choose>\r\n          <xsl:when test="$otherProp">\r\n            <attribute name="inverseProperty">\'<xsl:value-of select="$otherProp/@Name"/>\'<\/attribute>\r\n          <\/xsl:when >\r\n          <xsl:otherwise>\r\n            <attribute name="inverseProperty">\'$$unbound\'<\/attribute>\r\n            <xsl:message terminate="no">\r\n              Warning: inverseProperty other side missing: <xsl:value-of select="."/>\r\n            <\/xsl:message>\r\n          <\/xsl:otherwise>\r\n        <\/xsl:choose>\r\n      <\/xsl:when>\r\n    <\/xsl:choose>\r\n  <\/xsl:template>\r\n\r\n\r\n  <xsl:template match="@FromRole | @ToRole" mode="render-field"><\/xsl:template>\r\n\r\n  <xsl:template match="*" mode="render-field">\r\n    <!--<unprocessed>!!<xsl:value-of select="name()"/>!!<\/unprocessed>-->\r\n    <xsl:message terminate="no">  Warning: <xsl:value-of select="../../@Name"/>.<xsl:value-of select="../@Name"/>:<xsl:value-of select="name()"/> is an unknown/unprocessed attribued<\/xsl:message>\r\n  <\/xsl:template>\r\n  <!--<xsl:template match="*">\r\n    !<xsl:value-of select="name()"/>!\r\n  <\/xsl:template>-->\r\n<\/xsl:stylesheet>\r\n'}}),$data.MetadataLoader=new $data.MetadataLoaderClass,$data.service=function(n,t,i){function e(n){switch(typeof n){case"object":typeof n.success=="function"||typeof n.error=="function"?u=n:r=n;break;case"function":u=n}}var r,u,f;return e(t),e(i),typeof n=="object"&&(r=$data.typeSystem.extend(n,r),n=n.url,delete r.url),f=new $data.PromiseHandler,u=f.createCallback(u),$data.MetadataLoader.load(n,{success:function(n){var i=n.type,t;r&&(t=r.serviceName||r.storeAlias,t&&"addStore"in $data&&$data.addStore(t,n,r.isDefault===undefined||r.isDefault)),u.success(n,i)},error:u.error},r),f.getPromise()},function(n){typeof jQuery!="undefined"&&(n.Class.define("$data.Deferred",n.PromiseHandlerBase,null,{constructor:function(){this.deferred=new $.Deferred},deferred:{},createCallback:function(t){t=n.typeSystem.createCallbackSetting(t);var i=this;return cbWrapper={success:function(){t.success.apply(i.deferred,arguments),i.deferred.resolve.apply(i.deferred,arguments)},error:function(){Array.prototype.push.call(arguments,i.deferred),t.error.apply(i.deferred,arguments)},notify:function(){t.notify.apply(i.deferred,arguments),i.deferred.notify.apply(i.deferred,arguments)}}},getPromise:function(){return this.deferred.promise()}},null),n.PromiseHandler=n.Deferred)}($data),function(n){n.initService=function(t,i){var u=new n.PromiseHandler,r,f,e;return typeof t=="object"?(r=t,f=r.isSSL||r.isSSL===undefined?"https":"http",e=r.port?":"+r.port:"",t=typeof r.license=="string"&&r.license.toLowerCase()==="business"?r.appId&&r.serviceName?f+"://"+r.appId+".jaystack.net"+e+"/"+r.serviceName:r.url:r.ownerId&&r.appId&&r.serviceName?f+"://open.jaystack.net/"+r.ownerId+"/"+r.appId+"/api/"+r.serviceName:r.url,delete r.url,r=n.typeSystem.extend(r,i)):r=i,n.service(t,r).then(function(n){var t=n();return t.onReady().then(function(t){t.serviceFactory=n,u.deferred.resolve(t,n,n.type)}).fail(function(){u.deferred.reject.apply(u.deferred,arguments)})}),u.getPromise()}}($data);
//@ sourceMappingURL=jaydata.min.js.map